Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-b1882cff-2121-452b-a57a-0d35e31bdb13.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 64,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 593,601
Epoch 0
Loss = 2.3003e+00, PNorm = 38.3888, GNorm = 8.2781, lr_0 = 1.0000e-03
Loss = 1.0470e+00, PNorm = 38.4229, GNorm = 2.3338, lr_0 = 1.0000e-03
Validation rmse = 0.743651
Epoch 1
Loss = 1.0803e+00, PNorm = 38.4587, GNorm = 3.0978, lr_0 = 1.0000e-03
Loss = 1.0782e+00, PNorm = 38.4830, GNorm = 1.2521, lr_0 = 1.0000e-03
Loss = 8.5855e-01, PNorm = 38.5050, GNorm = 1.0867, lr_0 = 9.9369e-04
Validation rmse = 0.687905
Epoch 2
Loss = 7.6806e-01, PNorm = 38.5290, GNorm = 3.2498, lr_0 = 9.5669e-04
Loss = 9.8778e-01, PNorm = 38.5475, GNorm = 2.5794, lr_0 = 9.2690e-04
Validation rmse = 0.666733
Epoch 3
Loss = 6.6226e-01, PNorm = 38.5732, GNorm = 1.8393, lr_0 = 8.9238e-04
Loss = 8.1305e-01, PNorm = 38.5908, GNorm = 5.1295, lr_0 = 8.6460e-04
Loss = 7.9741e-01, PNorm = 38.6045, GNorm = 1.1212, lr_0 = 8.3768e-04
Validation rmse = 0.628844
Epoch 4
Loss = 8.1921e-01, PNorm = 38.6194, GNorm = 1.4050, lr_0 = 8.0648e-04
Loss = 7.7623e-01, PNorm = 38.6318, GNorm = 1.4607, lr_0 = 7.8137e-04
Loss = 7.0318e-01, PNorm = 38.6439, GNorm = 2.7258, lr_0 = 7.5704e-04
Loss = 5.0281e-01, PNorm = 38.6461, GNorm = 3.1981, lr_0 = 7.5227e-04
Validation rmse = 0.600625
Epoch 5
Loss = 6.9625e-01, PNorm = 38.6571, GNorm = 1.0334, lr_0 = 7.2885e-04
Loss = 6.8015e-01, PNorm = 38.6683, GNorm = 1.4070, lr_0 = 7.0616e-04
Validation rmse = 0.593591
Epoch 6
Loss = 6.4269e-01, PNorm = 38.6789, GNorm = 0.9389, lr_0 = 6.7986e-04
Loss = 6.9490e-01, PNorm = 38.6872, GNorm = 1.9795, lr_0 = 6.5869e-04
Loss = 6.0971e-01, PNorm = 38.6964, GNorm = 1.2231, lr_0 = 6.3818e-04
Validation rmse = 0.578860
Epoch 7
Loss = 6.2329e-01, PNorm = 38.7073, GNorm = 2.5513, lr_0 = 6.1441e-04
Loss = 6.3569e-01, PNorm = 38.7166, GNorm = 2.3631, lr_0 = 5.9529e-04
Validation rmse = 0.582890
Epoch 8
Loss = 7.8547e-01, PNorm = 38.7277, GNorm = 1.5108, lr_0 = 5.7311e-04
Loss = 5.7001e-01, PNorm = 38.7348, GNorm = 1.6972, lr_0 = 5.5527e-04
Loss = 6.1246e-01, PNorm = 38.7433, GNorm = 5.3647, lr_0 = 5.3798e-04
Validation rmse = 0.580491
Epoch 9
Loss = 6.4267e-01, PNorm = 38.7530, GNorm = 4.2840, lr_0 = 5.1795e-04
Loss = 6.9064e-01, PNorm = 38.7607, GNorm = 4.9360, lr_0 = 5.0182e-04
Loss = 5.9087e-01, PNorm = 38.7674, GNorm = 1.0856, lr_0 = 4.8620e-04
Loss = 7.5017e-01, PNorm = 38.7688, GNorm = 5.0541, lr_0 = 4.8313e-04
Validation rmse = 0.584325
Epoch 10
Loss = 5.5805e-01, PNorm = 38.7773, GNorm = 2.9880, lr_0 = 4.6809e-04
Loss = 5.9407e-01, PNorm = 38.7859, GNorm = 3.2819, lr_0 = 4.5352e-04
Validation rmse = 0.582477
Epoch 11
Loss = 6.5485e-01, PNorm = 38.7934, GNorm = 7.0561, lr_0 = 4.3663e-04
Loss = 6.4588e-01, PNorm = 38.8005, GNorm = 4.1530, lr_0 = 4.2303e-04
Loss = 5.5973e-01, PNorm = 38.8064, GNorm = 1.3332, lr_0 = 4.0986e-04
Validation rmse = 0.564833
Epoch 12
Loss = 6.5680e-01, PNorm = 38.8156, GNorm = 5.8044, lr_0 = 3.9460e-04
Loss = 5.3224e-01, PNorm = 38.8213, GNorm = 1.8201, lr_0 = 3.8231e-04
Loss = 5.9798e-01, PNorm = 38.8277, GNorm = 4.7681, lr_0 = 3.7041e-04
Validation rmse = 0.568641
Epoch 13
Loss = 6.2023e-01, PNorm = 38.8337, GNorm = 1.8138, lr_0 = 3.5888e-04
Loss = 5.2249e-01, PNorm = 38.8399, GNorm = 1.2300, lr_0 = 3.4770e-04
Validation rmse = 0.559137
Epoch 14
Loss = 6.0614e-01, PNorm = 38.8470, GNorm = 0.9421, lr_0 = 3.3475e-04
Loss = 5.9862e-01, PNorm = 38.8534, GNorm = 4.2222, lr_0 = 3.2433e-04
Loss = 5.8116e-01, PNorm = 38.8589, GNorm = 2.6202, lr_0 = 3.1423e-04
Validation rmse = 0.569928
Epoch 15
Loss = 5.4859e-01, PNorm = 38.8674, GNorm = 2.0776, lr_0 = 3.0253e-04
Loss = 5.6763e-01, PNorm = 38.8723, GNorm = 1.2780, lr_0 = 2.9311e-04
Validation rmse = 0.567889
Epoch 16
Loss = 4.9218e-01, PNorm = 38.8796, GNorm = 1.7514, lr_0 = 2.8220e-04
Loss = 5.9870e-01, PNorm = 38.8855, GNorm = 1.9097, lr_0 = 2.7341e-04
Loss = 5.2567e-01, PNorm = 38.8910, GNorm = 1.9331, lr_0 = 2.6490e-04
Validation rmse = 0.567469
Epoch 17
Loss = 4.7614e-01, PNorm = 38.8965, GNorm = 0.8573, lr_0 = 2.5503e-04
Loss = 5.3003e-01, PNorm = 38.9006, GNorm = 2.0743, lr_0 = 2.4709e-04
Loss = 5.7189e-01, PNorm = 38.9050, GNorm = 1.9380, lr_0 = 2.3940e-04
Loss = 1.1778e+00, PNorm = 38.9062, GNorm = 5.4919, lr_0 = 2.3789e-04
Validation rmse = 0.558987
Epoch 18
Loss = 4.5610e-01, PNorm = 38.9108, GNorm = 1.0595, lr_0 = 2.3048e-04
Loss = 5.7183e-01, PNorm = 38.9154, GNorm = 1.1101, lr_0 = 2.2331e-04
Validation rmse = 0.565376
Epoch 19
Loss = 5.4089e-01, PNorm = 38.9211, GNorm = 1.3418, lr_0 = 2.1499e-04
Loss = 4.9073e-01, PNorm = 38.9255, GNorm = 4.9616, lr_0 = 2.0830e-04
Loss = 6.0144e-01, PNorm = 38.9293, GNorm = 3.5248, lr_0 = 2.0181e-04
Validation rmse = 0.564996
Epoch 20
Loss = 5.2867e-01, PNorm = 38.9326, GNorm = 8.4739, lr_0 = 1.9429e-04
Loss = 4.9769e-01, PNorm = 38.9364, GNorm = 2.0142, lr_0 = 1.8825e-04
Validation rmse = 0.548371
Epoch 21
Loss = 4.3550e-01, PNorm = 38.9399, GNorm = 1.2962, lr_0 = 1.8123e-04
Loss = 5.4752e-01, PNorm = 38.9427, GNorm = 5.7345, lr_0 = 1.7559e-04
Loss = 5.4536e-01, PNorm = 38.9464, GNorm = 2.5439, lr_0 = 1.7013e-04
Validation rmse = 0.558233
Epoch 22
Loss = 5.9171e-01, PNorm = 38.9494, GNorm = 4.7522, lr_0 = 1.6379e-04
Loss = 5.1900e-01, PNorm = 38.9524, GNorm = 0.9347, lr_0 = 1.5869e-04
Loss = 4.8954e-01, PNorm = 38.9555, GNorm = 0.9139, lr_0 = 1.5375e-04
Loss = 4.8709e-01, PNorm = 38.9561, GNorm = 3.9775, lr_0 = 1.5278e-04
Validation rmse = 0.544540
Epoch 23
Loss = 5.3880e-01, PNorm = 38.9590, GNorm = 2.8893, lr_0 = 1.4802e-04
Loss = 5.0138e-01, PNorm = 38.9611, GNorm = 1.7928, lr_0 = 1.4341e-04
Validation rmse = 0.557456
Epoch 24
Loss = 5.6004e-01, PNorm = 38.9643, GNorm = 3.6093, lr_0 = 1.3807e-04
Loss = 5.3056e-01, PNorm = 38.9668, GNorm = 6.1746, lr_0 = 1.3377e-04
Loss = 4.1109e-01, PNorm = 38.9688, GNorm = 0.9341, lr_0 = 1.2961e-04
Validation rmse = 0.548306
Epoch 25
Loss = 5.2475e-01, PNorm = 38.9718, GNorm = 3.6607, lr_0 = 1.2478e-04
Loss = 4.7572e-01, PNorm = 38.9745, GNorm = 1.5460, lr_0 = 1.2090e-04
Loss = 4.7094e-01, PNorm = 38.9767, GNorm = 2.9699, lr_0 = 1.1713e-04
Validation rmse = 0.545338
Epoch 26
Loss = 5.0695e-01, PNorm = 38.9788, GNorm = 4.5353, lr_0 = 1.1349e-04
Loss = 4.7265e-01, PNorm = 38.9809, GNorm = 0.9196, lr_0 = 1.0995e-04
Validation rmse = 0.547145
Epoch 27
Loss = 4.7730e-01, PNorm = 38.9833, GNorm = 3.7147, lr_0 = 1.0586e-04
Loss = 5.2430e-01, PNorm = 38.9853, GNorm = 4.2942, lr_0 = 1.0256e-04
Loss = 4.8274e-01, PNorm = 38.9871, GNorm = 2.2403, lr_0 = 1.0000e-04
Validation rmse = 0.552994
Epoch 28
Loss = 4.4888e-01, PNorm = 38.9891, GNorm = 2.8782, lr_0 = 1.0000e-04
Loss = 5.1902e-01, PNorm = 38.9911, GNorm = 1.1210, lr_0 = 1.0000e-04
Validation rmse = 0.551422
Epoch 29
Loss = 4.5036e-01, PNorm = 38.9933, GNorm = 2.6812, lr_0 = 1.0000e-04
Loss = 5.0039e-01, PNorm = 38.9949, GNorm = 3.2030, lr_0 = 1.0000e-04
Loss = 4.5533e-01, PNorm = 38.9965, GNorm = 1.8245, lr_0 = 1.0000e-04
Validation rmse = 0.551314
Model 0 best validation rmse = 0.544540 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.532987
Ensemble test rmse = 0.532987
1-fold cross validation
	Seed 0 ==> test rmse = 0.532987
Overall test rmse = 0.532987 +/- 0.000000
Elapsed time = 0:03:23
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-b1882cff-2121-452b-a57a-0d35e31bdb13.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 64,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 593,601
Epoch 0
Loss = 2.3003e+00, PNorm = 38.3888, GNorm = 8.2781, lr_0 = 1.0000e-03
Loss = 1.0470e+00, PNorm = 38.4229, GNorm = 2.3338, lr_0 = 1.0000e-03
Validation rmse = 0.743651
Epoch 1
Loss = 1.0803e+00, PNorm = 38.4587, GNorm = 3.0978, lr_0 = 1.0000e-03
Loss = 1.0782e+00, PNorm = 38.4830, GNorm = 1.2521, lr_0 = 1.0000e-03
Loss = 8.5855e-01, PNorm = 38.5050, GNorm = 1.0867, lr_0 = 9.9369e-04
Validation rmse = 0.687905
Epoch 2
Loss = 7.6806e-01, PNorm = 38.5290, GNorm = 3.2498, lr_0 = 9.5669e-04
Loss = 9.8778e-01, PNorm = 38.5475, GNorm = 2.5794, lr_0 = 9.2690e-04
Validation rmse = 0.666733
Epoch 3
Loss = 6.6226e-01, PNorm = 38.5732, GNorm = 1.8393, lr_0 = 8.9238e-04
Loss = 8.1305e-01, PNorm = 38.5908, GNorm = 5.1295, lr_0 = 8.6460e-04
Loss = 7.9741e-01, PNorm = 38.6045, GNorm = 1.1212, lr_0 = 8.3768e-04
Validation rmse = 0.628844
Epoch 4
Loss = 8.1921e-01, PNorm = 38.6194, GNorm = 1.4050, lr_0 = 8.0648e-04
Loss = 7.7623e-01, PNorm = 38.6318, GNorm = 1.4607, lr_0 = 7.8137e-04
Loss = 7.0318e-01, PNorm = 38.6439, GNorm = 2.7258, lr_0 = 7.5704e-04
Loss = 5.0281e-01, PNorm = 38.6461, GNorm = 3.1981, lr_0 = 7.5227e-04
Validation rmse = 0.600625
Epoch 5
Loss = 6.9625e-01, PNorm = 38.6571, GNorm = 1.0334, lr_0 = 7.2885e-04
Loss = 6.8015e-01, PNorm = 38.6683, GNorm = 1.4070, lr_0 = 7.0616e-04
Validation rmse = 0.593591
Epoch 6
Loss = 6.4269e-01, PNorm = 38.6789, GNorm = 0.9389, lr_0 = 6.7986e-04
Loss = 6.9490e-01, PNorm = 38.6872, GNorm = 1.9795, lr_0 = 6.5869e-04
Loss = 6.0971e-01, PNorm = 38.6964, GNorm = 1.2231, lr_0 = 6.3818e-04
Validation rmse = 0.578860
Epoch 7
Loss = 6.2329e-01, PNorm = 38.7073, GNorm = 2.5513, lr_0 = 6.1441e-04
Loss = 6.3569e-01, PNorm = 38.7166, GNorm = 2.3631, lr_0 = 5.9529e-04
Validation rmse = 0.582890
Epoch 8
Loss = 7.8547e-01, PNorm = 38.7277, GNorm = 1.5108, lr_0 = 5.7311e-04
Loss = 5.7001e-01, PNorm = 38.7348, GNorm = 1.6972, lr_0 = 5.5527e-04
Loss = 6.1246e-01, PNorm = 38.7433, GNorm = 5.3647, lr_0 = 5.3798e-04
Validation rmse = 0.580491
Epoch 9
Loss = 6.4267e-01, PNorm = 38.7530, GNorm = 4.2840, lr_0 = 5.1795e-04
Loss = 6.9064e-01, PNorm = 38.7607, GNorm = 4.9360, lr_0 = 5.0182e-04
Loss = 5.9087e-01, PNorm = 38.7674, GNorm = 1.0856, lr_0 = 4.8620e-04
Loss = 7.5017e-01, PNorm = 38.7688, GNorm = 5.0541, lr_0 = 4.8313e-04
Validation rmse = 0.584325
Epoch 10
Loss = 5.5805e-01, PNorm = 38.7773, GNorm = 2.9880, lr_0 = 4.6809e-04
Loss = 5.9407e-01, PNorm = 38.7859, GNorm = 3.2819, lr_0 = 4.5352e-04
Validation rmse = 0.582477
Epoch 11
Loss = 6.5485e-01, PNorm = 38.7934, GNorm = 7.0561, lr_0 = 4.3663e-04
Loss = 6.4588e-01, PNorm = 38.8005, GNorm = 4.1530, lr_0 = 4.2303e-04
Loss = 5.5973e-01, PNorm = 38.8064, GNorm = 1.3332, lr_0 = 4.0986e-04
Validation rmse = 0.564833
Epoch 12
Loss = 6.5680e-01, PNorm = 38.8156, GNorm = 5.8044, lr_0 = 3.9460e-04
Loss = 5.3224e-01, PNorm = 38.8213, GNorm = 1.8201, lr_0 = 3.8231e-04
Loss = 5.9798e-01, PNorm = 38.8277, GNorm = 4.7681, lr_0 = 3.7041e-04
Validation rmse = 0.568641
Epoch 13
Loss = 6.2023e-01, PNorm = 38.8337, GNorm = 1.8138, lr_0 = 3.5888e-04
Loss = 5.2249e-01, PNorm = 38.8399, GNorm = 1.2300, lr_0 = 3.4770e-04
Validation rmse = 0.559137
Epoch 14
Loss = 6.0614e-01, PNorm = 38.8470, GNorm = 0.9421, lr_0 = 3.3475e-04
Loss = 5.9862e-01, PNorm = 38.8534, GNorm = 4.2222, lr_0 = 3.2433e-04
Loss = 5.8116e-01, PNorm = 38.8589, GNorm = 2.6202, lr_0 = 3.1423e-04
Validation rmse = 0.569928
Epoch 15
Loss = 5.4859e-01, PNorm = 38.8674, GNorm = 2.0776, lr_0 = 3.0253e-04
Loss = 5.6763e-01, PNorm = 38.8723, GNorm = 1.2780, lr_0 = 2.9311e-04
Validation rmse = 0.567889
Epoch 16
Loss = 4.9218e-01, PNorm = 38.8796, GNorm = 1.7514, lr_0 = 2.8220e-04
Loss = 5.9870e-01, PNorm = 38.8855, GNorm = 1.9097, lr_0 = 2.7341e-04
Loss = 5.2567e-01, PNorm = 38.8910, GNorm = 1.9331, lr_0 = 2.6490e-04
Validation rmse = 0.567469
Epoch 17
Loss = 4.7614e-01, PNorm = 38.8965, GNorm = 0.8573, lr_0 = 2.5503e-04
Loss = 5.3003e-01, PNorm = 38.9006, GNorm = 2.0743, lr_0 = 2.4709e-04
Loss = 5.7189e-01, PNorm = 38.9050, GNorm = 1.9380, lr_0 = 2.3940e-04
Loss = 1.1778e+00, PNorm = 38.9062, GNorm = 5.4919, lr_0 = 2.3789e-04
Validation rmse = 0.558987
Epoch 18
Loss = 4.5610e-01, PNorm = 38.9108, GNorm = 1.0595, lr_0 = 2.3048e-04
Loss = 5.7183e-01, PNorm = 38.9154, GNorm = 1.1101, lr_0 = 2.2331e-04
Validation rmse = 0.565376
Epoch 19
Loss = 5.4089e-01, PNorm = 38.9211, GNorm = 1.3418, lr_0 = 2.1499e-04
Loss = 4.9073e-01, PNorm = 38.9255, GNorm = 4.9616, lr_0 = 2.0830e-04
Loss = 6.0144e-01, PNorm = 38.9293, GNorm = 3.5248, lr_0 = 2.0181e-04
Validation rmse = 0.564996
Epoch 20
Loss = 5.2867e-01, PNorm = 38.9326, GNorm = 8.4739, lr_0 = 1.9429e-04
Loss = 4.9769e-01, PNorm = 38.9364, GNorm = 2.0142, lr_0 = 1.8825e-04
Validation rmse = 0.548371
Epoch 21
Loss = 4.3550e-01, PNorm = 38.9399, GNorm = 1.2962, lr_0 = 1.8123e-04
Loss = 5.4752e-01, PNorm = 38.9427, GNorm = 5.7345, lr_0 = 1.7559e-04
Loss = 5.4536e-01, PNorm = 38.9464, GNorm = 2.5439, lr_0 = 1.7013e-04
Validation rmse = 0.558233
Epoch 22
Loss = 5.9171e-01, PNorm = 38.9494, GNorm = 4.7522, lr_0 = 1.6379e-04
Loss = 5.1900e-01, PNorm = 38.9524, GNorm = 0.9347, lr_0 = 1.5869e-04
Loss = 4.8954e-01, PNorm = 38.9555, GNorm = 0.9139, lr_0 = 1.5375e-04
Loss = 4.8709e-01, PNorm = 38.9561, GNorm = 3.9775, lr_0 = 1.5278e-04
Validation rmse = 0.544540
Epoch 23
Loss = 5.3880e-01, PNorm = 38.9590, GNorm = 2.8893, lr_0 = 1.4802e-04
Loss = 5.0138e-01, PNorm = 38.9611, GNorm = 1.7928, lr_0 = 1.4341e-04
Validation rmse = 0.557456
Epoch 24
Loss = 5.6004e-01, PNorm = 38.9643, GNorm = 3.6093, lr_0 = 1.3807e-04
Loss = 5.3056e-01, PNorm = 38.9668, GNorm = 6.1746, lr_0 = 1.3377e-04
Loss = 4.1109e-01, PNorm = 38.9688, GNorm = 0.9341, lr_0 = 1.2961e-04
Validation rmse = 0.548306
Epoch 25
Loss = 5.2475e-01, PNorm = 38.9718, GNorm = 3.6607, lr_0 = 1.2478e-04
Loss = 4.7572e-01, PNorm = 38.9745, GNorm = 1.5460, lr_0 = 1.2090e-04
Loss = 4.7094e-01, PNorm = 38.9767, GNorm = 2.9699, lr_0 = 1.1713e-04
Validation rmse = 0.545338
Epoch 26
Loss = 5.0695e-01, PNorm = 38.9788, GNorm = 4.5353, lr_0 = 1.1349e-04
Loss = 4.7265e-01, PNorm = 38.9809, GNorm = 0.9196, lr_0 = 1.0995e-04
Validation rmse = 0.547145
Epoch 27
Loss = 4.7730e-01, PNorm = 38.9833, GNorm = 3.7147, lr_0 = 1.0586e-04
Loss = 5.2430e-01, PNorm = 38.9853, GNorm = 4.2942, lr_0 = 1.0256e-04
Loss = 4.8274e-01, PNorm = 38.9871, GNorm = 2.2403, lr_0 = 1.0000e-04
Validation rmse = 0.552994
Epoch 28
Loss = 4.4888e-01, PNorm = 38.9891, GNorm = 2.8782, lr_0 = 1.0000e-04
Loss = 5.1902e-01, PNorm = 38.9911, GNorm = 1.1210, lr_0 = 1.0000e-04
Validation rmse = 0.551422
Epoch 29
Loss = 4.5036e-01, PNorm = 38.9933, GNorm = 2.6812, lr_0 = 1.0000e-04
Loss = 5.0039e-01, PNorm = 38.9949, GNorm = 3.2030, lr_0 = 1.0000e-04
Loss = 4.5533e-01, PNorm = 38.9965, GNorm = 1.8245, lr_0 = 1.0000e-04
Validation rmse = 0.551314
Model 0 best validation rmse = 0.544540 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.532987
Ensemble test rmse = 0.532987
1-fold cross validation
	Seed 0 ==> test rmse = 0.532987
Overall test rmse = 0.532987 +/- 0.000000
Elapsed time = 0:03:23
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-b1882cff-2121-452b-a57a-0d35e31bdb13.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715428
Epoch 2
Loss = 8.0470e-01, PNorm = 42.7511, GNorm = 0.7403, lr_0 = 9.6081e-04
Validation rmse = 0.707724
Epoch 3
Loss = 8.5218e-01, PNorm = 42.7845, GNorm = 0.8345, lr_0 = 9.1581e-04
Loss = 9.8716e-01, PNorm = 42.8072, GNorm = 1.0967, lr_0 = 8.7992e-04
Validation rmse = 0.682377
Epoch 4
Loss = 9.3868e-01, PNorm = 42.8287, GNorm = 0.7124, lr_0 = 8.4544e-04
Validation rmse = 0.643952
Epoch 5
Loss = 7.8700e-01, PNorm = 42.8538, GNorm = 0.8321, lr_0 = 8.0584e-04
Validation rmse = 0.621464
Epoch 6
Loss = 7.2425e-01, PNorm = 42.8740, GNorm = 1.2316, lr_0 = 7.7426e-04
Loss = 7.6944e-01, PNorm = 42.8914, GNorm = 3.6430, lr_0 = 7.4392e-04
Loss = 8.3177e-01, PNorm = 42.8940, GNorm = 1.9631, lr_0 = 7.3800e-04
Validation rmse = 0.611985
Epoch 7
Loss = 7.2520e-01, PNorm = 42.9051, GNorm = 3.8268, lr_0 = 7.0908e-04
Validation rmse = 0.593673
Epoch 8
Loss = 6.9420e-01, PNorm = 42.9169, GNorm = 2.0557, lr_0 = 6.8129e-04
Validation rmse = 0.603795
Epoch 9
Loss = 6.5729e-01, PNorm = 42.9319, GNorm = 1.8476, lr_0 = 6.4938e-04
Loss = 6.6250e-01, PNorm = 42.9428, GNorm = 5.9652, lr_0 = 6.2393e-04
Validation rmse = 0.627030
Epoch 10
Loss = 6.3767e-01, PNorm = 42.9509, GNorm = 7.4064, lr_0 = 5.9948e-04
Validation rmse = 0.609701
Epoch 11
Loss = 6.8265e-01, PNorm = 42.9579, GNorm = 0.8366, lr_0 = 5.7141e-04
Validation rmse = 0.578364
Epoch 12
Loss = 6.7506e-01, PNorm = 42.9654, GNorm = 0.8450, lr_0 = 5.4901e-04
Loss = 6.5360e-01, PNorm = 42.9758, GNorm = 1.5181, lr_0 = 5.2750e-04
Validation rmse = 0.595749
Epoch 13
Loss = 6.5460e-01, PNorm = 42.9845, GNorm = 2.6990, lr_0 = 5.0683e-04
Validation rmse = 0.583494
Epoch 14
Loss = 6.7414e-01, PNorm = 42.9944, GNorm = 4.0631, lr_0 = 4.8309e-04
Validation rmse = 0.588445
Epoch 15
Loss = 5.6812e-01, PNorm = 43.0004, GNorm = 4.7747, lr_0 = 4.6416e-04
Validation rmse = 0.566447
Epoch 16
Loss = 6.4410e-01, PNorm = 43.0071, GNorm = 2.2309, lr_0 = 4.4242e-04
Loss = 6.1837e-01, PNorm = 43.0143, GNorm = 1.5162, lr_0 = 4.2508e-04
Validation rmse = 0.577991
Epoch 17
Loss = 5.7222e-01, PNorm = 43.0208, GNorm = 0.8120, lr_0 = 4.0842e-04
Validation rmse = 0.572175
Epoch 18
Loss = 4.9129e-01, PNorm = 43.0294, GNorm = 0.6802, lr_0 = 3.8929e-04
Validation rmse = 0.561993
Epoch 19
Loss = 6.1194e-01, PNorm = 43.0357, GNorm = 1.4579, lr_0 = 3.7404e-04
Loss = 5.8762e-01, PNorm = 43.0430, GNorm = 1.8799, lr_0 = 3.5938e-04
Loss = 7.9552e-01, PNorm = 43.0441, GNorm = 5.6805, lr_0 = 3.5652e-04
Validation rmse = 0.589406
Epoch 20
Loss = 5.8092e-01, PNorm = 43.0479, GNorm = 3.1521, lr_0 = 3.4255e-04
Validation rmse = 0.567041
Epoch 21
Loss = 5.3800e-01, PNorm = 43.0543, GNorm = 0.8935, lr_0 = 3.2913e-04
Validation rmse = 0.556743
Epoch 22
Loss = 6.0893e-01, PNorm = 43.0607, GNorm = 4.6159, lr_0 = 3.1371e-04
Loss = 5.2362e-01, PNorm = 43.0671, GNorm = 1.3602, lr_0 = 3.0142e-04
Validation rmse = 0.561430
Epoch 23
Loss = 5.8316e-01, PNorm = 43.0722, GNorm = 1.1697, lr_0 = 2.8960e-04
Validation rmse = 0.577356
Epoch 24
Loss = 5.4694e-01, PNorm = 43.0789, GNorm = 1.8599, lr_0 = 2.7604e-04
Validation rmse = 0.564905
Epoch 25
Loss = 5.7970e-01, PNorm = 43.0844, GNorm = 0.8631, lr_0 = 2.6522e-04
Loss = 5.3776e-01, PNorm = 43.0889, GNorm = 1.1021, lr_0 = 2.5483e-04
Validation rmse = 0.574223
Epoch 26
Loss = 5.4713e-01, PNorm = 43.0939, GNorm = 1.3857, lr_0 = 2.4484e-04
Validation rmse = 0.558112
Epoch 27
Loss = 5.8598e-01, PNorm = 43.0990, GNorm = 2.0705, lr_0 = 2.3338e-04
Validation rmse = 0.566323
Epoch 28
Loss = 4.9446e-01, PNorm = 43.1027, GNorm = 5.1450, lr_0 = 2.2423e-04
Validation rmse = 0.559486
Epoch 29
Loss = 4.8991e-01, PNorm = 43.1074, GNorm = 3.1827, lr_0 = 2.1373e-04
Loss = 5.5363e-01, PNorm = 43.1110, GNorm = 0.8950, lr_0 = 2.0535e-04
Validation rmse = 0.560240
Epoch 30
Loss = 5.1193e-01, PNorm = 43.1150, GNorm = 1.7071, lr_0 = 1.9731e-04
Validation rmse = 0.558462
Epoch 31
Loss = 5.1452e-01, PNorm = 43.1200, GNorm = 3.8862, lr_0 = 1.8806e-04
Validation rmse = 0.569437
Epoch 32
Loss = 5.6899e-01, PNorm = 43.1238, GNorm = 3.5975, lr_0 = 1.8069e-04
Loss = 5.0646e-01, PNorm = 43.1276, GNorm = 0.9401, lr_0 = 1.7361e-04
Loss = 5.5674e-01, PNorm = 43.1282, GNorm = 5.2906, lr_0 = 1.7223e-04
Validation rmse = 0.564932
Epoch 33
Loss = 5.3275e-01, PNorm = 43.1315, GNorm = 2.0579, lr_0 = 1.6548e-04
Validation rmse = 0.557440
Epoch 34
Loss = 4.7139e-01, PNorm = 43.1346, GNorm = 3.4663, lr_0 = 1.5900e-04
Validation rmse = 0.558906
Epoch 35
Loss = 5.2989e-01, PNorm = 43.1386, GNorm = 4.1664, lr_0 = 1.5155e-04
Loss = 4.7476e-01, PNorm = 43.1414, GNorm = 2.9065, lr_0 = 1.4561e-04
Validation rmse = 0.563319
Epoch 36
Loss = 4.9772e-01, PNorm = 43.1447, GNorm = 3.7442, lr_0 = 1.3991e-04
Validation rmse = 0.563336
Epoch 37
Loss = 5.5534e-01, PNorm = 43.1482, GNorm = 2.7444, lr_0 = 1.3335e-04
Validation rmse = 0.583908
Epoch 38
Loss = 5.2870e-01, PNorm = 43.1507, GNorm = 3.9643, lr_0 = 1.2813e-04
Loss = 5.3348e-01, PNorm = 43.1534, GNorm = 2.8061, lr_0 = 1.2311e-04
Validation rmse = 0.560037
Epoch 39
Loss = 5.0813e-01, PNorm = 43.1550, GNorm = 1.8508, lr_0 = 1.1828e-04
Validation rmse = 0.563303
Epoch 40
Loss = 5.1284e-01, PNorm = 43.1582, GNorm = 1.1284, lr_0 = 1.1274e-04
Validation rmse = 0.552070
Epoch 41
Loss = 5.4818e-01, PNorm = 43.1605, GNorm = 0.7870, lr_0 = 1.0832e-04
Validation rmse = 0.565203
Epoch 42
Loss = 5.1586e-01, PNorm = 43.1633, GNorm = 3.4882, lr_0 = 1.0325e-04
Loss = 4.7938e-01, PNorm = 43.1659, GNorm = 2.4709, lr_0 = 1.0000e-04
Validation rmse = 0.562598
Epoch 43
Loss = 4.7321e-01, PNorm = 43.1674, GNorm = 3.5288, lr_0 = 1.0000e-04
Validation rmse = 0.568006
Epoch 44
Loss = 4.6907e-01, PNorm = 43.1699, GNorm = 1.0523, lr_0 = 1.0000e-04
Validation rmse = 0.554128
Epoch 45
Loss = 4.8075e-01, PNorm = 43.1722, GNorm = 1.8755, lr_0 = 1.0000e-04
Loss = 5.2424e-01, PNorm = 43.1739, GNorm = 5.6489, lr_0 = 1.0000e-04
Loss = 3.6971e-01, PNorm = 43.1743, GNorm = 4.4004, lr_0 = 1.0000e-04
Validation rmse = 0.561272
Epoch 46
Loss = 5.0686e-01, PNorm = 43.1767, GNorm = 6.1700, lr_0 = 1.0000e-04
Validation rmse = 0.551847
Epoch 47
Loss = 4.5478e-01, PNorm = 43.1786, GNorm = 2.4554, lr_0 = 1.0000e-04
Validation rmse = 0.559788
Epoch 48
Loss = 4.5685e-01, PNorm = 43.1816, GNorm = 1.6674, lr_0 = 1.0000e-04
Loss = 4.9320e-01, PNorm = 43.1837, GNorm = 1.9811, lr_0 = 1.0000e-04
Validation rmse = 0.562831
Epoch 49
Loss = 5.2424e-01, PNorm = 43.1857, GNorm = 1.6787, lr_0 = 1.0000e-04
Validation rmse = 0.554206
Model 0 best validation rmse = 0.551847 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.512859
Ensemble test rmse = 0.512859
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.696990
Epoch 2
Loss = 1.0447e+00, PNorm = 42.7500, GNorm = 1.2388, lr_0 = 9.6081e-04
Validation rmse = 0.692277
Epoch 3
Loss = 8.9254e-01, PNorm = 42.7829, GNorm = 1.5975, lr_0 = 9.1581e-04
Loss = 9.9338e-01, PNorm = 42.8038, GNorm = 0.8217, lr_0 = 8.7992e-04
Validation rmse = 0.674967
Epoch 4
Loss = 9.7613e-01, PNorm = 42.8216, GNorm = 0.7748, lr_0 = 8.4544e-04
Validation rmse = 0.662272
Epoch 5
Loss = 7.8577e-01, PNorm = 42.8409, GNorm = 1.4517, lr_0 = 8.0584e-04
Validation rmse = 0.621103
Epoch 6
Loss = 8.7162e-01, PNorm = 42.8582, GNorm = 1.7258, lr_0 = 7.7426e-04
Loss = 7.9467e-01, PNorm = 42.8765, GNorm = 1.0621, lr_0 = 7.4392e-04
Loss = 7.7843e-01, PNorm = 42.8803, GNorm = 3.1518, lr_0 = 7.3800e-04
Validation rmse = 0.587920
Epoch 7
Loss = 7.5921e-01, PNorm = 42.8951, GNorm = 0.8871, lr_0 = 7.0908e-04
Validation rmse = 0.585541
Epoch 8
Loss = 7.7772e-01, PNorm = 42.9053, GNorm = 2.9853, lr_0 = 6.8129e-04
Validation rmse = 0.582299
Epoch 9
Loss = 7.0291e-01, PNorm = 42.9159, GNorm = 2.9786, lr_0 = 6.4938e-04
Loss = 7.4704e-01, PNorm = 42.9253, GNorm = 3.2116, lr_0 = 6.2393e-04
Validation rmse = 0.575011
Epoch 10
Loss = 6.5459e-01, PNorm = 42.9372, GNorm = 1.2224, lr_0 = 5.9948e-04
Validation rmse = 0.557648
Epoch 11
Loss = 6.7359e-01, PNorm = 42.9503, GNorm = 1.6368, lr_0 = 5.7141e-04
Validation rmse = 0.560364
Epoch 12
Loss = 6.3304e-01, PNorm = 42.9595, GNorm = 1.8930, lr_0 = 5.4901e-04
Loss = 7.2487e-01, PNorm = 42.9648, GNorm = 4.2086, lr_0 = 5.2750e-04
Validation rmse = 0.576731
Epoch 13
Loss = 6.6775e-01, PNorm = 42.9738, GNorm = 3.2056, lr_0 = 5.0683e-04
Validation rmse = 0.572470
Epoch 14
Loss = 6.7671e-01, PNorm = 42.9822, GNorm = 5.4024, lr_0 = 4.8309e-04
Validation rmse = 0.582456
Epoch 15
Loss = 6.9123e-01, PNorm = 42.9907, GNorm = 4.3484, lr_0 = 4.6416e-04
Validation rmse = 0.572216
Epoch 16
Loss = 6.9538e-01, PNorm = 42.9991, GNorm = 1.8054, lr_0 = 4.4242e-04
Loss = 6.3154e-01, PNorm = 43.0087, GNorm = 1.5925, lr_0 = 4.2508e-04
Validation rmse = 0.541308
Epoch 17
Loss = 6.3984e-01, PNorm = 43.0156, GNorm = 1.6484, lr_0 = 4.0842e-04
Validation rmse = 0.546549
Epoch 18
Loss = 5.6626e-01, PNorm = 43.0243, GNorm = 1.7038, lr_0 = 3.8929e-04
Validation rmse = 0.530527
Epoch 19
Loss = 6.6410e-01, PNorm = 43.0309, GNorm = 0.8371, lr_0 = 3.7404e-04
Loss = 5.9479e-01, PNorm = 43.0364, GNorm = 0.9600, lr_0 = 3.5938e-04
Loss = 5.6317e-01, PNorm = 43.0375, GNorm = 0.8070, lr_0 = 3.5652e-04
Validation rmse = 0.540658
Epoch 20
Loss = 6.1110e-01, PNorm = 43.0438, GNorm = 0.7230, lr_0 = 3.4255e-04
Validation rmse = 0.527473
Epoch 21
Loss = 5.3560e-01, PNorm = 43.0494, GNorm = 1.7630, lr_0 = 3.2913e-04
Validation rmse = 0.523255
Epoch 22
Loss = 6.0813e-01, PNorm = 43.0576, GNorm = 3.2511, lr_0 = 3.1371e-04
Loss = 5.6227e-01, PNorm = 43.0629, GNorm = 2.3973, lr_0 = 3.0142e-04
Validation rmse = 0.549969
Epoch 23
Loss = 5.9956e-01, PNorm = 43.0689, GNorm = 2.4572, lr_0 = 2.8960e-04
Validation rmse = 0.529292
Epoch 24
Loss = 6.0218e-01, PNorm = 43.0747, GNorm = 2.8582, lr_0 = 2.7604e-04
Validation rmse = 0.524658
Epoch 25
Loss = 5.2732e-01, PNorm = 43.0803, GNorm = 5.2927, lr_0 = 2.6522e-04
Loss = 5.7755e-01, PNorm = 43.0850, GNorm = 1.7692, lr_0 = 2.5483e-04
Validation rmse = 0.546885
Epoch 26
Loss = 5.9812e-01, PNorm = 43.0904, GNorm = 2.4465, lr_0 = 2.4484e-04
Validation rmse = 0.523644
Epoch 27
Loss = 5.7309e-01, PNorm = 43.0955, GNorm = 1.5962, lr_0 = 2.3338e-04
Validation rmse = 0.526208
Epoch 28
Loss = 5.9665e-01, PNorm = 43.1006, GNorm = 1.9923, lr_0 = 2.2423e-04
Validation rmse = 0.539433
Epoch 29
Loss = 6.3180e-01, PNorm = 43.1058, GNorm = 2.2887, lr_0 = 2.1373e-04
Loss = 5.3454e-01, PNorm = 43.1104, GNorm = 1.4275, lr_0 = 2.0535e-04
Validation rmse = 0.527102
Epoch 30
Loss = 5.5445e-01, PNorm = 43.1144, GNorm = 0.8838, lr_0 = 1.9731e-04
Validation rmse = 0.529186
Epoch 31
Loss = 5.6988e-01, PNorm = 43.1197, GNorm = 2.6175, lr_0 = 1.8806e-04
Validation rmse = 0.545395
Epoch 32
Loss = 4.9118e-01, PNorm = 43.1230, GNorm = 1.7402, lr_0 = 1.8069e-04
Loss = 5.5315e-01, PNorm = 43.1271, GNorm = 0.7330, lr_0 = 1.7361e-04
Loss = 5.5098e-01, PNorm = 43.1279, GNorm = 2.6310, lr_0 = 1.7223e-04
Validation rmse = 0.519772
Epoch 33
Loss = 5.3335e-01, PNorm = 43.1310, GNorm = 1.1168, lr_0 = 1.6548e-04
Validation rmse = 0.535221
Epoch 34
Loss = 4.7155e-01, PNorm = 43.1346, GNorm = 0.7808, lr_0 = 1.5900e-04
Validation rmse = 0.520897
Epoch 35
Loss = 5.0443e-01, PNorm = 43.1387, GNorm = 2.1982, lr_0 = 1.5155e-04
Loss = 5.4549e-01, PNorm = 43.1416, GNorm = 1.6303, lr_0 = 1.4561e-04
Validation rmse = 0.531003
Epoch 36
Loss = 5.1545e-01, PNorm = 43.1448, GNorm = 1.3373, lr_0 = 1.3991e-04
Validation rmse = 0.525894
Epoch 37
Loss = 5.4889e-01, PNorm = 43.1485, GNorm = 2.5997, lr_0 = 1.3335e-04
Validation rmse = 0.528008
Epoch 38
Loss = 5.8404e-01, PNorm = 43.1517, GNorm = 1.4672, lr_0 = 1.2813e-04
Loss = 4.6764e-01, PNorm = 43.1542, GNorm = 1.7870, lr_0 = 1.2311e-04
Validation rmse = 0.535250
Epoch 39
Loss = 5.1803e-01, PNorm = 43.1568, GNorm = 2.5695, lr_0 = 1.1828e-04
Validation rmse = 0.520174
Epoch 40
Loss = 5.5957e-01, PNorm = 43.1597, GNorm = 2.4125, lr_0 = 1.1274e-04
Validation rmse = 0.537906
Epoch 41
Loss = 5.1380e-01, PNorm = 43.1618, GNorm = 3.5538, lr_0 = 1.0832e-04
Validation rmse = 0.522305
Epoch 42
Loss = 4.6612e-01, PNorm = 43.1649, GNorm = 0.6162, lr_0 = 1.0325e-04
Loss = 5.3045e-01, PNorm = 43.1671, GNorm = 2.7144, lr_0 = 1.0000e-04
Validation rmse = 0.530968
Epoch 43
Loss = 4.8267e-01, PNorm = 43.1695, GNorm = 0.9048, lr_0 = 1.0000e-04
Validation rmse = 0.527451
Epoch 44
Loss = 5.2771e-01, PNorm = 43.1721, GNorm = 1.1108, lr_0 = 1.0000e-04
Validation rmse = 0.531686
Epoch 45
Loss = 5.6795e-01, PNorm = 43.1744, GNorm = 0.7244, lr_0 = 1.0000e-04
Loss = 5.0998e-01, PNorm = 43.1766, GNorm = 1.4807, lr_0 = 1.0000e-04
Loss = 4.9791e-01, PNorm = 43.1770, GNorm = 1.9456, lr_0 = 1.0000e-04
Validation rmse = 0.534025
Epoch 46
Loss = 5.0025e-01, PNorm = 43.1791, GNorm = 1.2396, lr_0 = 1.0000e-04
Validation rmse = 0.529248
Epoch 47
Loss = 4.7258e-01, PNorm = 43.1815, GNorm = 2.2470, lr_0 = 1.0000e-04
Validation rmse = 0.534954
Epoch 48
Loss = 5.9952e-01, PNorm = 43.1842, GNorm = 2.1324, lr_0 = 1.0000e-04
Loss = 4.4780e-01, PNorm = 43.1861, GNorm = 2.9743, lr_0 = 1.0000e-04
Validation rmse = 0.530928
Epoch 49
Loss = 5.1201e-01, PNorm = 43.1884, GNorm = 0.8031, lr_0 = 1.0000e-04
Validation rmse = 0.522019
Model 0 best validation rmse = 0.519772 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.573976
Ensemble test rmse = 0.573976
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.744915
Epoch 2
Loss = 8.6485e-01, PNorm = 42.7545, GNorm = 0.6917, lr_0 = 9.6081e-04
Validation rmse = 0.732367
Epoch 3
Loss = 9.2638e-01, PNorm = 42.7904, GNorm = 0.6258, lr_0 = 9.1581e-04
Loss = 9.7448e-01, PNorm = 42.8142, GNorm = 0.7180, lr_0 = 8.7992e-04
Validation rmse = 0.725324
Epoch 4
Loss = 9.2228e-01, PNorm = 42.8367, GNorm = 1.6641, lr_0 = 8.4544e-04
Validation rmse = 0.762112
Epoch 5
Loss = 8.0916e-01, PNorm = 42.8623, GNorm = 0.9734, lr_0 = 8.0584e-04
Validation rmse = 0.721074
Epoch 6
Loss = 9.2603e-01, PNorm = 42.8767, GNorm = 2.0749, lr_0 = 7.7426e-04
Loss = 7.4940e-01, PNorm = 42.8903, GNorm = 0.9793, lr_0 = 7.4392e-04
Loss = 6.2840e-01, PNorm = 42.8929, GNorm = 1.9568, lr_0 = 7.3800e-04
Validation rmse = 0.687455
Epoch 7
Loss = 7.0840e-01, PNorm = 42.9061, GNorm = 0.9054, lr_0 = 7.0908e-04
Validation rmse = 0.658955
Epoch 8
Loss = 6.9844e-01, PNorm = 42.9191, GNorm = 1.9106, lr_0 = 6.8129e-04
Validation rmse = 0.631478
Epoch 9
Loss = 6.5425e-01, PNorm = 42.9324, GNorm = 3.6529, lr_0 = 6.4938e-04
Loss = 7.1557e-01, PNorm = 42.9419, GNorm = 3.2294, lr_0 = 6.2393e-04
Validation rmse = 0.631343
Epoch 10
Loss = 6.1029e-01, PNorm = 42.9529, GNorm = 2.0958, lr_0 = 5.9948e-04
Validation rmse = 0.610010
Epoch 11
Loss = 6.5629e-01, PNorm = 42.9652, GNorm = 3.3576, lr_0 = 5.7141e-04
Validation rmse = 0.600151
Epoch 12
Loss = 5.6302e-01, PNorm = 42.9744, GNorm = 2.8485, lr_0 = 5.4901e-04
Loss = 6.6416e-01, PNorm = 42.9830, GNorm = 1.3063, lr_0 = 5.2750e-04
Validation rmse = 0.624658
Epoch 13
Loss = 6.0087e-01, PNorm = 42.9910, GNorm = 1.6155, lr_0 = 5.0683e-04
Validation rmse = 0.607558
Epoch 14
Loss = 5.9920e-01, PNorm = 43.0023, GNorm = 0.7370, lr_0 = 4.8309e-04
Validation rmse = 0.607923
Epoch 15
Loss = 6.7088e-01, PNorm = 43.0098, GNorm = 1.6087, lr_0 = 4.6416e-04
Validation rmse = 0.636262
Epoch 16
Loss = 6.5013e-01, PNorm = 43.0170, GNorm = 1.9773, lr_0 = 4.4242e-04
Loss = 5.8322e-01, PNorm = 43.0236, GNorm = 1.6343, lr_0 = 4.2508e-04
Validation rmse = 0.623467
Epoch 17
Loss = 5.8470e-01, PNorm = 43.0322, GNorm = 1.6330, lr_0 = 4.0842e-04
Validation rmse = 0.657007
Epoch 18
Loss = 6.1292e-01, PNorm = 43.0394, GNorm = 9.3172, lr_0 = 3.8929e-04
Validation rmse = 0.669399
Epoch 19
Loss = 6.7034e-01, PNorm = 43.0440, GNorm = 4.4544, lr_0 = 3.7404e-04
Loss = 5.6277e-01, PNorm = 43.0511, GNorm = 2.9011, lr_0 = 3.5938e-04
Loss = 6.9208e-01, PNorm = 43.0522, GNorm = 1.3345, lr_0 = 3.5652e-04
Validation rmse = 0.604930
Epoch 20
Loss = 5.7462e-01, PNorm = 43.0588, GNorm = 1.2109, lr_0 = 3.4255e-04
Validation rmse = 0.593561
Epoch 21
Loss = 5.4640e-01, PNorm = 43.0649, GNorm = 1.1005, lr_0 = 3.2913e-04
Validation rmse = 0.626237
Epoch 22
Loss = 5.4987e-01, PNorm = 43.0717, GNorm = 1.9241, lr_0 = 3.1371e-04
Loss = 5.7394e-01, PNorm = 43.0770, GNorm = 3.8550, lr_0 = 3.0142e-04
Validation rmse = 0.575768
Epoch 23
Loss = 5.5935e-01, PNorm = 43.0810, GNorm = 2.3430, lr_0 = 2.8960e-04
Validation rmse = 0.629664
Epoch 24
Loss = 5.5560e-01, PNorm = 43.0879, GNorm = 5.2356, lr_0 = 2.7604e-04
Validation rmse = 0.624438
Epoch 25
Loss = 5.9518e-01, PNorm = 43.0929, GNorm = 1.4844, lr_0 = 2.6522e-04
Loss = 5.6730e-01, PNorm = 43.0961, GNorm = 2.4505, lr_0 = 2.5483e-04
Validation rmse = 0.704078
Epoch 26
Loss = 5.4380e-01, PNorm = 43.1012, GNorm = 2.6582, lr_0 = 2.4484e-04
Validation rmse = 0.569677
Epoch 27
Loss = 5.5253e-01, PNorm = 43.1055, GNorm = 0.6798, lr_0 = 2.3338e-04
Validation rmse = 0.634141
Epoch 28
Loss = 4.4589e-01, PNorm = 43.1104, GNorm = 0.9508, lr_0 = 2.2423e-04
Validation rmse = 0.590835
Epoch 29
Loss = 5.2982e-01, PNorm = 43.1157, GNorm = 3.9613, lr_0 = 2.1373e-04
Loss = 5.1816e-01, PNorm = 43.1198, GNorm = 4.2249, lr_0 = 2.0535e-04
Validation rmse = 0.599278
Epoch 30
Loss = 5.3731e-01, PNorm = 43.1241, GNorm = 2.8107, lr_0 = 1.9731e-04
Validation rmse = 0.628205
Epoch 31
Loss = 5.5646e-01, PNorm = 43.1282, GNorm = 1.6970, lr_0 = 1.8806e-04
Validation rmse = 0.593188
Epoch 32
Loss = 5.1063e-01, PNorm = 43.1316, GNorm = 1.3246, lr_0 = 1.8069e-04
Loss = 5.2553e-01, PNorm = 43.1350, GNorm = 1.3521, lr_0 = 1.7361e-04
Loss = 4.5026e-01, PNorm = 43.1357, GNorm = 3.1461, lr_0 = 1.7223e-04
Validation rmse = 0.598117
Epoch 33
Loss = 5.0467e-01, PNorm = 43.1391, GNorm = 1.6715, lr_0 = 1.6548e-04
Validation rmse = 0.617019
Epoch 34
Loss = 5.2009e-01, PNorm = 43.1429, GNorm = 1.2471, lr_0 = 1.5900e-04
Validation rmse = 0.621699
Epoch 35
Loss = 5.1403e-01, PNorm = 43.1465, GNorm = 1.9909, lr_0 = 1.5155e-04
Loss = 4.9599e-01, PNorm = 43.1498, GNorm = 3.6385, lr_0 = 1.4561e-04
Validation rmse = 0.588037
Epoch 36
Loss = 4.8274e-01, PNorm = 43.1523, GNorm = 3.0823, lr_0 = 1.3991e-04
Validation rmse = 0.633785
Epoch 37
Loss = 5.2309e-01, PNorm = 43.1556, GNorm = 0.8905, lr_0 = 1.3335e-04
Validation rmse = 0.587100
Epoch 38
Loss = 5.1740e-01, PNorm = 43.1584, GNorm = 0.9766, lr_0 = 1.2813e-04
Loss = 4.8160e-01, PNorm = 43.1611, GNorm = 1.4618, lr_0 = 1.2311e-04
Validation rmse = 0.617883
Epoch 39
Loss = 4.8034e-01, PNorm = 43.1639, GNorm = 3.7272, lr_0 = 1.1828e-04
Validation rmse = 0.609135
Epoch 40
Loss = 5.2349e-01, PNorm = 43.1667, GNorm = 5.1198, lr_0 = 1.1274e-04
Validation rmse = 0.598291
Epoch 41
Loss = 4.8324e-01, PNorm = 43.1689, GNorm = 3.4337, lr_0 = 1.0832e-04
Validation rmse = 0.605704
Epoch 42
Loss = 4.9115e-01, PNorm = 43.1716, GNorm = 2.0709, lr_0 = 1.0325e-04
Loss = 5.1568e-01, PNorm = 43.1738, GNorm = 3.0564, lr_0 = 1.0000e-04
Validation rmse = 0.612977
Epoch 43
Loss = 4.9672e-01, PNorm = 43.1759, GNorm = 1.2460, lr_0 = 1.0000e-04
Validation rmse = 0.611327
Epoch 44
Loss = 4.4809e-01, PNorm = 43.1784, GNorm = 2.5257, lr_0 = 1.0000e-04
Validation rmse = 0.594959
Epoch 45
Loss = 4.4266e-01, PNorm = 43.1807, GNorm = 2.0488, lr_0 = 1.0000e-04
Loss = 4.9858e-01, PNorm = 43.1828, GNorm = 2.5104, lr_0 = 1.0000e-04
Loss = 4.9950e-01, PNorm = 43.1832, GNorm = 1.6182, lr_0 = 1.0000e-04
Validation rmse = 0.608081
Epoch 46
Loss = 4.7206e-01, PNorm = 43.1854, GNorm = 0.9393, lr_0 = 1.0000e-04
Validation rmse = 0.606950
Epoch 47
Loss = 4.8574e-01, PNorm = 43.1875, GNorm = 1.1287, lr_0 = 1.0000e-04
Validation rmse = 0.597271
Epoch 48
Loss = 5.0658e-01, PNorm = 43.1902, GNorm = 3.3686, lr_0 = 1.0000e-04
Loss = 4.6359e-01, PNorm = 43.1922, GNorm = 2.2969, lr_0 = 1.0000e-04
Validation rmse = 0.615465
Epoch 49
Loss = 4.6613e-01, PNorm = 43.1944, GNorm = 6.8586, lr_0 = 1.0000e-04
Validation rmse = 0.595283
Model 0 best validation rmse = 0.569677 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.531520
Ensemble test rmse = 0.531520
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732175
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7520, GNorm = 0.8329, lr_0 = 9.6081e-04
Validation rmse = 0.725436
Epoch 3
Loss = 9.6696e-01, PNorm = 42.7875, GNorm = 0.8183, lr_0 = 9.1581e-04
Loss = 9.3853e-01, PNorm = 42.8129, GNorm = 0.9191, lr_0 = 8.7992e-04
Validation rmse = 0.690701
Epoch 4
Loss = 8.9802e-01, PNorm = 42.8346, GNorm = 1.1266, lr_0 = 8.4544e-04
Validation rmse = 0.676597
Epoch 5
Loss = 8.6211e-01, PNorm = 42.8598, GNorm = 1.1236, lr_0 = 8.0584e-04
Validation rmse = 0.655937
Epoch 6
Loss = 7.3475e-01, PNorm = 42.8790, GNorm = 1.2896, lr_0 = 7.7426e-04
Loss = 7.3972e-01, PNorm = 42.8942, GNorm = 2.6156, lr_0 = 7.4392e-04
Loss = 7.7591e-01, PNorm = 42.8966, GNorm = 2.6759, lr_0 = 7.3800e-04
Validation rmse = 0.636719
Epoch 7
Loss = 7.4942e-01, PNorm = 42.9097, GNorm = 4.4558, lr_0 = 7.0908e-04
Validation rmse = 0.659499
Epoch 8
Loss = 6.5145e-01, PNorm = 42.9224, GNorm = 2.2730, lr_0 = 6.8129e-04
Validation rmse = 0.592910
Epoch 9
Loss = 6.4793e-01, PNorm = 42.9377, GNorm = 3.6997, lr_0 = 6.4938e-04
Loss = 6.8406e-01, PNorm = 42.9484, GNorm = 2.4550, lr_0 = 6.2393e-04
Validation rmse = 0.568382
Epoch 10
Loss = 6.6599e-01, PNorm = 42.9584, GNorm = 4.5140, lr_0 = 5.9948e-04
Validation rmse = 0.590685
Epoch 11
Loss = 6.5184e-01, PNorm = 42.9687, GNorm = 3.0642, lr_0 = 5.7141e-04
Validation rmse = 0.572547
Epoch 12
Loss = 6.5654e-01, PNorm = 42.9771, GNorm = 0.9257, lr_0 = 5.4901e-04
Loss = 6.5488e-01, PNorm = 42.9871, GNorm = 1.4509, lr_0 = 5.2750e-04
Validation rmse = 0.565147
Epoch 13
Loss = 6.5751e-01, PNorm = 42.9952, GNorm = 1.6383, lr_0 = 5.0683e-04
Validation rmse = 0.643280
Epoch 14
Loss = 6.2841e-01, PNorm = 43.0068, GNorm = 1.5261, lr_0 = 4.8309e-04
Validation rmse = 0.561856
Epoch 15
Loss = 6.5803e-01, PNorm = 43.0157, GNorm = 1.0248, lr_0 = 4.6416e-04
Validation rmse = 0.565974
Epoch 16
Loss = 6.1076e-01, PNorm = 43.0273, GNorm = 1.2640, lr_0 = 4.4242e-04
Loss = 6.1596e-01, PNorm = 43.0337, GNorm = 0.7078, lr_0 = 4.2508e-04
Validation rmse = 0.630033
Epoch 17
Loss = 5.9758e-01, PNorm = 43.0420, GNorm = 2.0359, lr_0 = 4.0842e-04
Validation rmse = 0.568126
Epoch 18
Loss = 5.5112e-01, PNorm = 43.0501, GNorm = 0.7489, lr_0 = 3.8929e-04
Validation rmse = 0.570189
Epoch 19
Loss = 6.1209e-01, PNorm = 43.0585, GNorm = 1.1376, lr_0 = 3.7404e-04
Loss = 5.7680e-01, PNorm = 43.0659, GNorm = 0.9443, lr_0 = 3.5938e-04
Loss = 4.8164e-01, PNorm = 43.0672, GNorm = 1.9283, lr_0 = 3.5652e-04
Validation rmse = 0.552606
Epoch 20
Loss = 5.8503e-01, PNorm = 43.0728, GNorm = 0.8926, lr_0 = 3.4255e-04
Validation rmse = 0.569776
Epoch 21
Loss = 5.9390e-01, PNorm = 43.0797, GNorm = 3.3916, lr_0 = 3.2913e-04
Validation rmse = 0.580423
Epoch 22
Loss = 5.1376e-01, PNorm = 43.0875, GNorm = 1.0813, lr_0 = 3.1371e-04
Loss = 5.5968e-01, PNorm = 43.0941, GNorm = 2.8590, lr_0 = 3.0142e-04
Validation rmse = 0.560026
Epoch 23
Loss = 5.1388e-01, PNorm = 43.1003, GNorm = 2.4130, lr_0 = 2.8960e-04
Validation rmse = 0.525615
Epoch 24
Loss = 5.3432e-01, PNorm = 43.1078, GNorm = 2.9767, lr_0 = 2.7604e-04
Validation rmse = 0.560131
Epoch 25
Loss = 5.2424e-01, PNorm = 43.1147, GNorm = 0.8224, lr_0 = 2.6522e-04
Loss = 5.3469e-01, PNorm = 43.1207, GNorm = 1.7745, lr_0 = 2.5483e-04
Validation rmse = 0.577160
Epoch 26
Loss = 5.3834e-01, PNorm = 43.1269, GNorm = 1.1777, lr_0 = 2.4484e-04
Validation rmse = 0.538220
Epoch 27
Loss = 5.5429e-01, PNorm = 43.1336, GNorm = 2.4374, lr_0 = 2.3338e-04
Validation rmse = 0.558620
Epoch 28
Loss = 5.4999e-01, PNorm = 43.1391, GNorm = 2.1939, lr_0 = 2.2423e-04
Validation rmse = 0.608195
Epoch 29
Loss = 4.9182e-01, PNorm = 43.1442, GNorm = 2.3960, lr_0 = 2.1373e-04
Loss = 5.0673e-01, PNorm = 43.1495, GNorm = 1.1828, lr_0 = 2.0535e-04
Validation rmse = 0.531119
Epoch 30
Loss = 5.0208e-01, PNorm = 43.1532, GNorm = 2.1018, lr_0 = 1.9731e-04
Validation rmse = 0.529228
Epoch 31
Loss = 5.6733e-01, PNorm = 43.1591, GNorm = 6.6215, lr_0 = 1.8806e-04
Validation rmse = 0.597578
Epoch 32
Loss = 5.0459e-01, PNorm = 43.1628, GNorm = 2.7386, lr_0 = 1.8069e-04
Loss = 5.0013e-01, PNorm = 43.1674, GNorm = 2.7041, lr_0 = 1.7361e-04
Loss = 5.7654e-01, PNorm = 43.1683, GNorm = 1.6364, lr_0 = 1.7223e-04
Validation rmse = 0.519444
Epoch 33
Loss = 5.3161e-01, PNorm = 43.1719, GNorm = 6.3019, lr_0 = 1.6548e-04
Validation rmse = 0.558917
Epoch 34
Loss = 5.5324e-01, PNorm = 43.1760, GNorm = 0.9523, lr_0 = 1.5900e-04
Validation rmse = 0.551702
Epoch 35
Loss = 5.0424e-01, PNorm = 43.1802, GNorm = 1.9967, lr_0 = 1.5155e-04
Loss = 4.9707e-01, PNorm = 43.1836, GNorm = 2.6951, lr_0 = 1.4561e-04
Validation rmse = 0.539288
Epoch 36
Loss = 4.8725e-01, PNorm = 43.1863, GNorm = 1.2030, lr_0 = 1.3991e-04
Validation rmse = 0.541334
Epoch 37
Loss = 4.6935e-01, PNorm = 43.1900, GNorm = 1.6318, lr_0 = 1.3335e-04
Validation rmse = 0.575766
Epoch 38
Loss = 4.8709e-01, PNorm = 43.1929, GNorm = 1.5381, lr_0 = 1.2813e-04
Loss = 4.9534e-01, PNorm = 43.1960, GNorm = 1.7026, lr_0 = 1.2311e-04
Validation rmse = 0.555365
Epoch 39
Loss = 4.7482e-01, PNorm = 43.1986, GNorm = 3.6698, lr_0 = 1.1828e-04
Validation rmse = 0.531889
Epoch 40
Loss = 4.4314e-01, PNorm = 43.2018, GNorm = 1.6739, lr_0 = 1.1274e-04
Validation rmse = 0.567735
Epoch 41
Loss = 5.1341e-01, PNorm = 43.2044, GNorm = 0.9104, lr_0 = 1.0832e-04
Validation rmse = 0.554929
Epoch 42
Loss = 4.7737e-01, PNorm = 43.2070, GNorm = 4.2479, lr_0 = 1.0325e-04
Loss = 4.8630e-01, PNorm = 43.2092, GNorm = 1.6810, lr_0 = 1.0000e-04
Validation rmse = 0.525583
Epoch 43
Loss = 4.8539e-01, PNorm = 43.2116, GNorm = 3.3688, lr_0 = 1.0000e-04
Validation rmse = 0.579186
Epoch 44
Loss = 5.1356e-01, PNorm = 43.2138, GNorm = 3.5476, lr_0 = 1.0000e-04
Validation rmse = 0.532182
Epoch 45
Loss = 5.1604e-01, PNorm = 43.2165, GNorm = 4.5321, lr_0 = 1.0000e-04
Loss = 4.7332e-01, PNorm = 43.2186, GNorm = 1.7756, lr_0 = 1.0000e-04
Loss = 4.3928e-01, PNorm = 43.2191, GNorm = 3.1335, lr_0 = 1.0000e-04
Validation rmse = 0.551464
Epoch 46
Loss = 4.7051e-01, PNorm = 43.2213, GNorm = 1.2073, lr_0 = 1.0000e-04
Validation rmse = 0.545521
Epoch 47
Loss = 4.2038e-01, PNorm = 43.2235, GNorm = 1.4983, lr_0 = 1.0000e-04
Validation rmse = 0.548369
Epoch 48
Loss = 4.5087e-01, PNorm = 43.2263, GNorm = 1.0292, lr_0 = 1.0000e-04
Loss = 4.7395e-01, PNorm = 43.2288, GNorm = 3.9539, lr_0 = 1.0000e-04
Validation rmse = 0.533480
Epoch 49
Loss = 4.5950e-01, PNorm = 43.2307, GNorm = 2.6961, lr_0 = 1.0000e-04
Validation rmse = 0.539725
Model 0 best validation rmse = 0.519444 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.475291
Ensemble test rmse = 0.475291
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.6854e+00, PNorm = 42.6832, GNorm = 6.5055, lr_0 = 7.5000e-04
Validation rmse = 0.779950
Epoch 1
Loss = 1.0715e+00, PNorm = 42.7188, GNorm = 1.6002, lr_0 = 1.0000e-03
Validation rmse = 0.764412
Epoch 2
Loss = 9.2667e-01, PNorm = 42.7535, GNorm = 0.9784, lr_0 = 9.6081e-04
Validation rmse = 0.742779
Epoch 3
Loss = 9.2276e-01, PNorm = 42.7873, GNorm = 0.7816, lr_0 = 9.1581e-04
Loss = 9.6840e-01, PNorm = 42.8103, GNorm = 0.7806, lr_0 = 8.7992e-04
Validation rmse = 0.738063
Epoch 4
Loss = 9.0325e-01, PNorm = 42.8311, GNorm = 0.7982, lr_0 = 8.4544e-04
Validation rmse = 0.687609
Epoch 5
Loss = 9.3018e-01, PNorm = 42.8556, GNorm = 2.0777, lr_0 = 8.0584e-04
Validation rmse = 0.744201
Epoch 6
Loss = 7.7005e-01, PNorm = 42.8733, GNorm = 3.8007, lr_0 = 7.7426e-04
Loss = 8.2223e-01, PNorm = 42.8874, GNorm = 3.3249, lr_0 = 7.4392e-04
Loss = 1.0001e+00, PNorm = 42.8901, GNorm = 4.4107, lr_0 = 7.3800e-04
Validation rmse = 0.697079
Epoch 7
Loss = 8.1545e-01, PNorm = 42.9039, GNorm = 3.7575, lr_0 = 7.0908e-04
Validation rmse = 0.666133
Epoch 8
Loss = 7.7399e-01, PNorm = 42.9156, GNorm = 2.1042, lr_0 = 6.8129e-04
Validation rmse = 0.601339
Epoch 9
Loss = 6.9724e-01, PNorm = 42.9319, GNorm = 1.9748, lr_0 = 6.4938e-04
Loss = 7.4098e-01, PNorm = 42.9437, GNorm = 1.4287, lr_0 = 6.2393e-04
Validation rmse = 0.632894
Epoch 10
Loss = 7.0405e-01, PNorm = 42.9561, GNorm = 1.5701, lr_0 = 5.9948e-04
Validation rmse = 0.597565
Epoch 11
Loss = 6.5673e-01, PNorm = 42.9691, GNorm = 0.7748, lr_0 = 5.7141e-04
Validation rmse = 0.583754
Epoch 12
Loss = 5.5007e-01, PNorm = 42.9802, GNorm = 1.2046, lr_0 = 5.4901e-04
Loss = 6.8826e-01, PNorm = 42.9898, GNorm = 2.6975, lr_0 = 5.2750e-04
Validation rmse = 0.628635
Epoch 13
Loss = 6.1374e-01, PNorm = 42.9999, GNorm = 0.7025, lr_0 = 5.0683e-04
Validation rmse = 0.573072
Epoch 14
Loss = 6.7469e-01, PNorm = 43.0108, GNorm = 1.0798, lr_0 = 4.8309e-04
Validation rmse = 0.558508
Epoch 15
Loss = 6.6599e-01, PNorm = 43.0205, GNorm = 1.1265, lr_0 = 4.6416e-04
Validation rmse = 0.562863
Epoch 16
Loss = 5.7521e-01, PNorm = 43.0308, GNorm = 0.9522, lr_0 = 4.4242e-04
Loss = 6.2677e-01, PNorm = 43.0375, GNorm = 4.0305, lr_0 = 4.2508e-04
Validation rmse = 0.578486
Epoch 17
Loss = 5.8752e-01, PNorm = 43.0452, GNorm = 5.0322, lr_0 = 4.0842e-04
Validation rmse = 0.591303
Epoch 18
Loss = 5.9017e-01, PNorm = 43.0553, GNorm = 2.6869, lr_0 = 3.8929e-04
Validation rmse = 0.599849
Epoch 19
Loss = 6.5140e-01, PNorm = 43.0626, GNorm = 1.2006, lr_0 = 3.7404e-04
Loss = 5.6357e-01, PNorm = 43.0702, GNorm = 1.6717, lr_0 = 3.5938e-04
Loss = 5.3875e-01, PNorm = 43.0712, GNorm = 1.4281, lr_0 = 3.5652e-04
Validation rmse = 0.584882
Epoch 20
Loss = 6.0273e-01, PNorm = 43.0783, GNorm = 1.3053, lr_0 = 3.4255e-04
Validation rmse = 0.546698
Epoch 21
Loss = 5.7297e-01, PNorm = 43.0854, GNorm = 1.2976, lr_0 = 3.2913e-04
Validation rmse = 0.557707
Epoch 22
Loss = 5.2579e-01, PNorm = 43.0944, GNorm = 1.5474, lr_0 = 3.1371e-04
Loss = 5.7106e-01, PNorm = 43.1005, GNorm = 1.6075, lr_0 = 3.0142e-04
Validation rmse = 0.598279
Epoch 23
Loss = 5.6258e-01, PNorm = 43.1074, GNorm = 0.9945, lr_0 = 2.8960e-04
Validation rmse = 0.555931
Epoch 24
Loss = 5.7231e-01, PNorm = 43.1134, GNorm = 3.3388, lr_0 = 2.7604e-04
Validation rmse = 0.543168
Epoch 25
Loss = 5.4927e-01, PNorm = 43.1197, GNorm = 3.1962, lr_0 = 2.6522e-04
Loss = 5.4379e-01, PNorm = 43.1246, GNorm = 2.2911, lr_0 = 2.5483e-04
Validation rmse = 0.600341
Epoch 26
Loss = 5.5119e-01, PNorm = 43.1305, GNorm = 1.8715, lr_0 = 2.4484e-04
Validation rmse = 0.554880
Epoch 27
Loss = 5.3268e-01, PNorm = 43.1360, GNorm = 4.5075, lr_0 = 2.3338e-04
Validation rmse = 0.538111
Epoch 28
Loss = 5.9010e-01, PNorm = 43.1411, GNorm = 3.8050, lr_0 = 2.2423e-04
Validation rmse = 0.592506
Epoch 29
Loss = 5.4657e-01, PNorm = 43.1461, GNorm = 3.8382, lr_0 = 2.1373e-04
Loss = 5.2947e-01, PNorm = 43.1506, GNorm = 1.1686, lr_0 = 2.0535e-04
Validation rmse = 0.543419
Epoch 30
Loss = 5.5368e-01, PNorm = 43.1542, GNorm = 1.0444, lr_0 = 1.9731e-04
Validation rmse = 0.578961
Epoch 31
Loss = 5.0484e-01, PNorm = 43.1585, GNorm = 1.7343, lr_0 = 1.8806e-04
Validation rmse = 0.541218
Epoch 32
Loss = 4.9651e-01, PNorm = 43.1623, GNorm = 4.0503, lr_0 = 1.8069e-04
Loss = 5.3948e-01, PNorm = 43.1658, GNorm = 1.6292, lr_0 = 1.7361e-04
Loss = 5.6296e-01, PNorm = 43.1669, GNorm = 1.2944, lr_0 = 1.7223e-04
Validation rmse = 0.528782
Epoch 33
Loss = 4.9984e-01, PNorm = 43.1704, GNorm = 1.6379, lr_0 = 1.6548e-04
Validation rmse = 0.614149
Epoch 34
Loss = 5.6957e-01, PNorm = 43.1738, GNorm = 4.8285, lr_0 = 1.5900e-04
Validation rmse = 0.521788
Epoch 35
Loss = 4.4401e-01, PNorm = 43.1780, GNorm = 3.9923, lr_0 = 1.5155e-04
Loss = 5.6902e-01, PNorm = 43.1807, GNorm = 5.3522, lr_0 = 1.4561e-04
Validation rmse = 0.577418
Epoch 36
Loss = 4.8539e-01, PNorm = 43.1842, GNorm = 1.9202, lr_0 = 1.3991e-04
Validation rmse = 0.545207
Epoch 37
Loss = 4.8691e-01, PNorm = 43.1872, GNorm = 2.1152, lr_0 = 1.3335e-04
Validation rmse = 0.548507
Epoch 38
Loss = 4.5917e-01, PNorm = 43.1902, GNorm = 1.3240, lr_0 = 1.2813e-04
Loss = 5.1416e-01, PNorm = 43.1928, GNorm = 3.7745, lr_0 = 1.2311e-04
Validation rmse = 0.562560
Epoch 39
Loss = 4.5512e-01, PNorm = 43.1955, GNorm = 1.3439, lr_0 = 1.1828e-04
Validation rmse = 0.538482
Epoch 40
Loss = 4.8009e-01, PNorm = 43.1981, GNorm = 2.6546, lr_0 = 1.1274e-04
Validation rmse = 0.562587
Epoch 41
Loss = 4.3450e-01, PNorm = 43.2006, GNorm = 1.5779, lr_0 = 1.0832e-04
Validation rmse = 0.547256
Epoch 42
Loss = 4.5320e-01, PNorm = 43.2032, GNorm = 1.7799, lr_0 = 1.0325e-04
Loss = 4.8529e-01, PNorm = 43.2054, GNorm = 4.5397, lr_0 = 1.0000e-04
Validation rmse = 0.553555
Epoch 43
Loss = 5.0543e-01, PNorm = 43.2083, GNorm = 7.2797, lr_0 = 1.0000e-04
Validation rmse = 0.571098
Epoch 44
Loss = 4.7033e-01, PNorm = 43.2100, GNorm = 4.0006, lr_0 = 1.0000e-04
Validation rmse = 0.535141
Epoch 45
Loss = 5.8062e-01, PNorm = 43.2128, GNorm = 2.5373, lr_0 = 1.0000e-04
Loss = 4.9333e-01, PNorm = 43.2144, GNorm = 3.2010, lr_0 = 1.0000e-04
Loss = 5.5284e-01, PNorm = 43.2146, GNorm = 1.9812, lr_0 = 1.0000e-04
Validation rmse = 0.563674
Epoch 46
Loss = 5.1197e-01, PNorm = 43.2164, GNorm = 5.6722, lr_0 = 1.0000e-04
Validation rmse = 0.547070
Epoch 47
Loss = 4.7590e-01, PNorm = 43.2193, GNorm = 3.0388, lr_0 = 1.0000e-04
Validation rmse = 0.537789
Epoch 48
Loss = 5.1578e-01, PNorm = 43.2212, GNorm = 1.3849, lr_0 = 1.0000e-04
Loss = 4.9813e-01, PNorm = 43.2234, GNorm = 1.4909, lr_0 = 1.0000e-04
Validation rmse = 0.573864
Epoch 49
Loss = 4.6626e-01, PNorm = 43.2259, GNorm = 2.0195, lr_0 = 1.0000e-04
Validation rmse = 0.525440
Model 0 best validation rmse = 0.521788 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.567819
Ensemble test rmse = 0.567819
5-fold cross validation
	Seed 0 ==> test rmse = 0.512859
	Seed 1 ==> test rmse = 0.573976
	Seed 2 ==> test rmse = 0.531520
	Seed 3 ==> test rmse = 0.475291
	Seed 4 ==> test rmse = 0.567819
Overall test rmse = 0.532293 +/- 0.036406
Elapsed time = 0:45:26
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-39bd53c6-9194-465e-9118-41fb5da0c754.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715428
Epoch 2
Loss = 8.0470e-01, PNorm = 42.7511, GNorm = 0.7403, lr_0 = 9.6081e-04
Validation rmse = 0.707724
Epoch 3
Loss = 8.5218e-01, PNorm = 42.7845, GNorm = 0.8345, lr_0 = 9.1581e-04
Loss = 9.8716e-01, PNorm = 42.8072, GNorm = 1.0967, lr_0 = 8.7992e-04
Validation rmse = 0.682377
Epoch 4
Loss = 9.3868e-01, PNorm = 42.8287, GNorm = 0.7124, lr_0 = 8.4544e-04
Validation rmse = 0.643952
Epoch 5
Loss = 7.8700e-01, PNorm = 42.8538, GNorm = 0.8321, lr_0 = 8.0584e-04
Validation rmse = 0.621464
Epoch 6
Loss = 7.2425e-01, PNorm = 42.8740, GNorm = 1.2316, lr_0 = 7.7426e-04
Loss = 7.6944e-01, PNorm = 42.8914, GNorm = 3.6430, lr_0 = 7.4392e-04
Loss = 8.3177e-01, PNorm = 42.8940, GNorm = 1.9631, lr_0 = 7.3800e-04
Validation rmse = 0.611985
Epoch 7
Loss = 7.2520e-01, PNorm = 42.9051, GNorm = 3.8268, lr_0 = 7.0908e-04
Validation rmse = 0.593673
Epoch 8
Loss = 6.9420e-01, PNorm = 42.9169, GNorm = 2.0557, lr_0 = 6.8129e-04
Validation rmse = 0.603795
Epoch 9
Loss = 6.5729e-01, PNorm = 42.9319, GNorm = 1.8476, lr_0 = 6.4938e-04
Loss = 6.6250e-01, PNorm = 42.9428, GNorm = 5.9652, lr_0 = 6.2393e-04
Validation rmse = 0.627030
Epoch 10
Loss = 6.3767e-01, PNorm = 42.9509, GNorm = 7.4064, lr_0 = 5.9948e-04
Validation rmse = 0.609701
Epoch 11
Loss = 6.8265e-01, PNorm = 42.9579, GNorm = 0.8366, lr_0 = 5.7141e-04
Validation rmse = 0.578364
Epoch 12
Loss = 6.7506e-01, PNorm = 42.9654, GNorm = 0.8450, lr_0 = 5.4901e-04
Loss = 6.5360e-01, PNorm = 42.9758, GNorm = 1.5181, lr_0 = 5.2750e-04
Validation rmse = 0.595749
Epoch 13
Loss = 6.5460e-01, PNorm = 42.9845, GNorm = 2.6990, lr_0 = 5.0683e-04
Validation rmse = 0.583494
Epoch 14
Loss = 6.7414e-01, PNorm = 42.9944, GNorm = 4.0631, lr_0 = 4.8309e-04
Validation rmse = 0.588445
Epoch 15
Loss = 5.6812e-01, PNorm = 43.0004, GNorm = 4.7747, lr_0 = 4.6416e-04
Validation rmse = 0.566447
Epoch 16
Loss = 6.4410e-01, PNorm = 43.0071, GNorm = 2.2309, lr_0 = 4.4242e-04
Loss = 6.1837e-01, PNorm = 43.0143, GNorm = 1.5162, lr_0 = 4.2508e-04
Validation rmse = 0.577991
Epoch 17
Loss = 5.7222e-01, PNorm = 43.0208, GNorm = 0.8120, lr_0 = 4.0842e-04
Validation rmse = 0.572175
Epoch 18
Loss = 4.9129e-01, PNorm = 43.0294, GNorm = 0.6802, lr_0 = 3.8929e-04
Validation rmse = 0.561993
Epoch 19
Loss = 6.1194e-01, PNorm = 43.0357, GNorm = 1.4579, lr_0 = 3.7404e-04
Loss = 5.8762e-01, PNorm = 43.0430, GNorm = 1.8799, lr_0 = 3.5938e-04
Loss = 7.9552e-01, PNorm = 43.0441, GNorm = 5.6805, lr_0 = 3.5652e-04
Validation rmse = 0.589406
Epoch 20
Loss = 5.8092e-01, PNorm = 43.0479, GNorm = 3.1521, lr_0 = 3.4255e-04
Validation rmse = 0.567041
Epoch 21
Loss = 5.3800e-01, PNorm = 43.0543, GNorm = 0.8935, lr_0 = 3.2913e-04
Validation rmse = 0.556743
Epoch 22
Loss = 6.0893e-01, PNorm = 43.0607, GNorm = 4.6159, lr_0 = 3.1371e-04
Loss = 5.2362e-01, PNorm = 43.0671, GNorm = 1.3602, lr_0 = 3.0142e-04
Validation rmse = 0.561430
Epoch 23
Loss = 5.8316e-01, PNorm = 43.0722, GNorm = 1.1697, lr_0 = 2.8960e-04
Validation rmse = 0.577356
Epoch 24
Loss = 5.4694e-01, PNorm = 43.0789, GNorm = 1.8599, lr_0 = 2.7604e-04
Validation rmse = 0.564905
Epoch 25
Loss = 5.7970e-01, PNorm = 43.0844, GNorm = 0.8631, lr_0 = 2.6522e-04
Loss = 5.3776e-01, PNorm = 43.0889, GNorm = 1.1021, lr_0 = 2.5483e-04
Validation rmse = 0.574223
Epoch 26
Loss = 5.4713e-01, PNorm = 43.0939, GNorm = 1.3857, lr_0 = 2.4484e-04
Validation rmse = 0.558112
Epoch 27
Loss = 5.8598e-01, PNorm = 43.0990, GNorm = 2.0705, lr_0 = 2.3338e-04
Validation rmse = 0.566323
Epoch 28
Loss = 4.9446e-01, PNorm = 43.1027, GNorm = 5.1450, lr_0 = 2.2423e-04
Validation rmse = 0.559486
Epoch 29
Loss = 4.8991e-01, PNorm = 43.1074, GNorm = 3.1827, lr_0 = 2.1373e-04
Loss = 5.5363e-01, PNorm = 43.1110, GNorm = 0.8950, lr_0 = 2.0535e-04
Validation rmse = 0.560240
Epoch 30
Loss = 5.1193e-01, PNorm = 43.1150, GNorm = 1.7071, lr_0 = 1.9731e-04
Validation rmse = 0.558462
Epoch 31
Loss = 5.1452e-01, PNorm = 43.1200, GNorm = 3.8862, lr_0 = 1.8806e-04
Validation rmse = 0.569437
Epoch 32
Loss = 5.6899e-01, PNorm = 43.1238, GNorm = 3.5975, lr_0 = 1.8069e-04
Loss = 5.0646e-01, PNorm = 43.1276, GNorm = 0.9401, lr_0 = 1.7361e-04
Loss = 5.5674e-01, PNorm = 43.1282, GNorm = 5.2906, lr_0 = 1.7223e-04
Validation rmse = 0.564932
Epoch 33
Loss = 5.3275e-01, PNorm = 43.1315, GNorm = 2.0579, lr_0 = 1.6548e-04
Validation rmse = 0.557440
Epoch 34
Loss = 4.7139e-01, PNorm = 43.1346, GNorm = 3.4663, lr_0 = 1.5900e-04
Validation rmse = 0.558906
Epoch 35
Loss = 5.2989e-01, PNorm = 43.1386, GNorm = 4.1664, lr_0 = 1.5155e-04
Loss = 4.7476e-01, PNorm = 43.1414, GNorm = 2.9065, lr_0 = 1.4561e-04
Validation rmse = 0.563319
Epoch 36
Loss = 4.9772e-01, PNorm = 43.1447, GNorm = 3.7442, lr_0 = 1.3991e-04
Validation rmse = 0.563336
Epoch 37
Loss = 5.5534e-01, PNorm = 43.1482, GNorm = 2.7444, lr_0 = 1.3335e-04
Validation rmse = 0.583908
Epoch 38
Loss = 5.2870e-01, PNorm = 43.1507, GNorm = 3.9643, lr_0 = 1.2813e-04
Loss = 5.3348e-01, PNorm = 43.1534, GNorm = 2.8061, lr_0 = 1.2311e-04
Validation rmse = 0.560037
Epoch 39
Loss = 5.0813e-01, PNorm = 43.1550, GNorm = 1.8508, lr_0 = 1.1828e-04
Validation rmse = 0.563303
Epoch 40
Loss = 5.1284e-01, PNorm = 43.1582, GNorm = 1.1284, lr_0 = 1.1274e-04
Validation rmse = 0.552070
Epoch 41
Loss = 5.4818e-01, PNorm = 43.1605, GNorm = 0.7870, lr_0 = 1.0832e-04
Validation rmse = 0.565203
Epoch 42
Loss = 5.1586e-01, PNorm = 43.1633, GNorm = 3.4882, lr_0 = 1.0325e-04
Loss = 4.7938e-01, PNorm = 43.1659, GNorm = 2.4709, lr_0 = 1.0000e-04
Validation rmse = 0.562598
Epoch 43
Loss = 4.7321e-01, PNorm = 43.1674, GNorm = 3.5288, lr_0 = 1.0000e-04
Validation rmse = 0.568006
Epoch 44
Loss = 4.6907e-01, PNorm = 43.1699, GNorm = 1.0523, lr_0 = 1.0000e-04
Validation rmse = 0.554128
Epoch 45
Loss = 4.8075e-01, PNorm = 43.1722, GNorm = 1.8755, lr_0 = 1.0000e-04
Loss = 5.2424e-01, PNorm = 43.1739, GNorm = 5.6489, lr_0 = 1.0000e-04
Loss = 3.6971e-01, PNorm = 43.1743, GNorm = 4.4004, lr_0 = 1.0000e-04
Validation rmse = 0.561272
Epoch 46
Loss = 5.0686e-01, PNorm = 43.1767, GNorm = 6.1700, lr_0 = 1.0000e-04
Validation rmse = 0.551847
Epoch 47
Loss = 4.5478e-01, PNorm = 43.1786, GNorm = 2.4554, lr_0 = 1.0000e-04
Validation rmse = 0.559788
Epoch 48
Loss = 4.5685e-01, PNorm = 43.1816, GNorm = 1.6674, lr_0 = 1.0000e-04
Loss = 4.9320e-01, PNorm = 43.1837, GNorm = 1.9811, lr_0 = 1.0000e-04
Validation rmse = 0.562831
Epoch 49
Loss = 5.2424e-01, PNorm = 43.1857, GNorm = 1.6787, lr_0 = 1.0000e-04
Validation rmse = 0.554206
Model 0 best validation rmse = 0.551847 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.512859
Ensemble test rmse = 0.512859
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.696990
Epoch 2
Loss = 1.0447e+00, PNorm = 42.7500, GNorm = 1.2388, lr_0 = 9.6081e-04
Validation rmse = 0.692277
Epoch 3
Loss = 8.9254e-01, PNorm = 42.7829, GNorm = 1.5975, lr_0 = 9.1581e-04
Loss = 9.9338e-01, PNorm = 42.8038, GNorm = 0.8217, lr_0 = 8.7992e-04
Validation rmse = 0.674967
Epoch 4
Loss = 9.7613e-01, PNorm = 42.8216, GNorm = 0.7748, lr_0 = 8.4544e-04
Validation rmse = 0.662272
Epoch 5
Loss = 7.8577e-01, PNorm = 42.8409, GNorm = 1.4517, lr_0 = 8.0584e-04
Validation rmse = 0.621103
Epoch 6
Loss = 8.7162e-01, PNorm = 42.8582, GNorm = 1.7258, lr_0 = 7.7426e-04
Loss = 7.9467e-01, PNorm = 42.8765, GNorm = 1.0621, lr_0 = 7.4392e-04
Loss = 7.7843e-01, PNorm = 42.8803, GNorm = 3.1518, lr_0 = 7.3800e-04
Validation rmse = 0.587920
Epoch 7
Loss = 7.5921e-01, PNorm = 42.8951, GNorm = 0.8871, lr_0 = 7.0908e-04
Validation rmse = 0.585541
Epoch 8
Loss = 7.7772e-01, PNorm = 42.9053, GNorm = 2.9853, lr_0 = 6.8129e-04
Validation rmse = 0.582299
Epoch 9
Loss = 7.0291e-01, PNorm = 42.9159, GNorm = 2.9786, lr_0 = 6.4938e-04
Loss = 7.4704e-01, PNorm = 42.9253, GNorm = 3.2116, lr_0 = 6.2393e-04
Validation rmse = 0.575011
Epoch 10
Loss = 6.5459e-01, PNorm = 42.9372, GNorm = 1.2224, lr_0 = 5.9948e-04
Validation rmse = 0.557648
Epoch 11
Loss = 6.7359e-01, PNorm = 42.9503, GNorm = 1.6368, lr_0 = 5.7141e-04
Validation rmse = 0.560364
Epoch 12
Loss = 6.3304e-01, PNorm = 42.9595, GNorm = 1.8930, lr_0 = 5.4901e-04
Loss = 7.2487e-01, PNorm = 42.9648, GNorm = 4.2086, lr_0 = 5.2750e-04
Validation rmse = 0.576731
Epoch 13
Loss = 6.6775e-01, PNorm = 42.9738, GNorm = 3.2056, lr_0 = 5.0683e-04
Validation rmse = 0.572470
Epoch 14
Loss = 6.7671e-01, PNorm = 42.9822, GNorm = 5.4024, lr_0 = 4.8309e-04
Validation rmse = 0.582456
Epoch 15
Loss = 6.9123e-01, PNorm = 42.9907, GNorm = 4.3484, lr_0 = 4.6416e-04
Validation rmse = 0.572216
Epoch 16
Loss = 6.9538e-01, PNorm = 42.9991, GNorm = 1.8054, lr_0 = 4.4242e-04
Loss = 6.3154e-01, PNorm = 43.0087, GNorm = 1.5925, lr_0 = 4.2508e-04
Validation rmse = 0.541308
Epoch 17
Loss = 6.3984e-01, PNorm = 43.0156, GNorm = 1.6484, lr_0 = 4.0842e-04
Validation rmse = 0.546549
Epoch 18
Loss = 5.6626e-01, PNorm = 43.0243, GNorm = 1.7038, lr_0 = 3.8929e-04
Validation rmse = 0.530527
Epoch 19
Loss = 6.6410e-01, PNorm = 43.0309, GNorm = 0.8371, lr_0 = 3.7404e-04
Loss = 5.9479e-01, PNorm = 43.0364, GNorm = 0.9600, lr_0 = 3.5938e-04
Loss = 5.6317e-01, PNorm = 43.0375, GNorm = 0.8070, lr_0 = 3.5652e-04
Validation rmse = 0.540658
Epoch 20
Loss = 6.1110e-01, PNorm = 43.0438, GNorm = 0.7230, lr_0 = 3.4255e-04
Validation rmse = 0.527473
Epoch 21
Loss = 5.3560e-01, PNorm = 43.0494, GNorm = 1.7630, lr_0 = 3.2913e-04
Validation rmse = 0.523255
Epoch 22
Loss = 6.0813e-01, PNorm = 43.0576, GNorm = 3.2511, lr_0 = 3.1371e-04
Loss = 5.6227e-01, PNorm = 43.0629, GNorm = 2.3973, lr_0 = 3.0142e-04
Validation rmse = 0.549969
Epoch 23
Loss = 5.9956e-01, PNorm = 43.0689, GNorm = 2.4572, lr_0 = 2.8960e-04
Validation rmse = 0.529292
Epoch 24
Loss = 6.0218e-01, PNorm = 43.0747, GNorm = 2.8582, lr_0 = 2.7604e-04
Validation rmse = 0.524658
Epoch 25
Loss = 5.2732e-01, PNorm = 43.0803, GNorm = 5.2927, lr_0 = 2.6522e-04
Loss = 5.7755e-01, PNorm = 43.0850, GNorm = 1.7692, lr_0 = 2.5483e-04
Validation rmse = 0.546885
Epoch 26
Loss = 5.9812e-01, PNorm = 43.0904, GNorm = 2.4465, lr_0 = 2.4484e-04
Validation rmse = 0.523644
Epoch 27
Loss = 5.7309e-01, PNorm = 43.0955, GNorm = 1.5962, lr_0 = 2.3338e-04
Validation rmse = 0.526208
Epoch 28
Loss = 5.9665e-01, PNorm = 43.1006, GNorm = 1.9923, lr_0 = 2.2423e-04
Validation rmse = 0.539433
Epoch 29
Loss = 6.3180e-01, PNorm = 43.1058, GNorm = 2.2887, lr_0 = 2.1373e-04
Loss = 5.3454e-01, PNorm = 43.1104, GNorm = 1.4275, lr_0 = 2.0535e-04
Validation rmse = 0.527102
Epoch 30
Loss = 5.5445e-01, PNorm = 43.1144, GNorm = 0.8838, lr_0 = 1.9731e-04
Validation rmse = 0.529186
Epoch 31
Loss = 5.6988e-01, PNorm = 43.1197, GNorm = 2.6175, lr_0 = 1.8806e-04
Validation rmse = 0.545395
Epoch 32
Loss = 4.9118e-01, PNorm = 43.1230, GNorm = 1.7402, lr_0 = 1.8069e-04
Loss = 5.5315e-01, PNorm = 43.1271, GNorm = 0.7330, lr_0 = 1.7361e-04
Loss = 5.5098e-01, PNorm = 43.1279, GNorm = 2.6310, lr_0 = 1.7223e-04
Validation rmse = 0.519772
Epoch 33
Loss = 5.3335e-01, PNorm = 43.1310, GNorm = 1.1168, lr_0 = 1.6548e-04
Validation rmse = 0.535221
Epoch 34
Loss = 4.7155e-01, PNorm = 43.1346, GNorm = 0.7808, lr_0 = 1.5900e-04
Validation rmse = 0.520897
Epoch 35
Loss = 5.0443e-01, PNorm = 43.1387, GNorm = 2.1982, lr_0 = 1.5155e-04
Loss = 5.4549e-01, PNorm = 43.1416, GNorm = 1.6303, lr_0 = 1.4561e-04
Validation rmse = 0.531003
Epoch 36
Loss = 5.1545e-01, PNorm = 43.1448, GNorm = 1.3373, lr_0 = 1.3991e-04
Validation rmse = 0.525894
Epoch 37
Loss = 5.4889e-01, PNorm = 43.1485, GNorm = 2.5997, lr_0 = 1.3335e-04
Validation rmse = 0.528008
Epoch 38
Loss = 5.8404e-01, PNorm = 43.1517, GNorm = 1.4672, lr_0 = 1.2813e-04
Loss = 4.6764e-01, PNorm = 43.1542, GNorm = 1.7870, lr_0 = 1.2311e-04
Validation rmse = 0.535250
Epoch 39
Loss = 5.1803e-01, PNorm = 43.1568, GNorm = 2.5695, lr_0 = 1.1828e-04
Validation rmse = 0.520174
Epoch 40
Loss = 5.5957e-01, PNorm = 43.1597, GNorm = 2.4125, lr_0 = 1.1274e-04
Validation rmse = 0.537906
Epoch 41
Loss = 5.1380e-01, PNorm = 43.1618, GNorm = 3.5538, lr_0 = 1.0832e-04
Validation rmse = 0.522305
Epoch 42
Loss = 4.6612e-01, PNorm = 43.1649, GNorm = 0.6162, lr_0 = 1.0325e-04
Loss = 5.3045e-01, PNorm = 43.1671, GNorm = 2.7144, lr_0 = 1.0000e-04
Validation rmse = 0.530968
Epoch 43
Loss = 4.8267e-01, PNorm = 43.1695, GNorm = 0.9048, lr_0 = 1.0000e-04
Validation rmse = 0.527451
Epoch 44
Loss = 5.2771e-01, PNorm = 43.1721, GNorm = 1.1108, lr_0 = 1.0000e-04
Validation rmse = 0.531686
Epoch 45
Loss = 5.6795e-01, PNorm = 43.1744, GNorm = 0.7244, lr_0 = 1.0000e-04
Loss = 5.0998e-01, PNorm = 43.1766, GNorm = 1.4807, lr_0 = 1.0000e-04
Loss = 4.9791e-01, PNorm = 43.1770, GNorm = 1.9456, lr_0 = 1.0000e-04
Validation rmse = 0.534025
Epoch 46
Loss = 5.0025e-01, PNorm = 43.1791, GNorm = 1.2396, lr_0 = 1.0000e-04
Validation rmse = 0.529248
Epoch 47
Loss = 4.7258e-01, PNorm = 43.1815, GNorm = 2.2470, lr_0 = 1.0000e-04
Validation rmse = 0.534954
Epoch 48
Loss = 5.9952e-01, PNorm = 43.1842, GNorm = 2.1324, lr_0 = 1.0000e-04
Loss = 4.4780e-01, PNorm = 43.1861, GNorm = 2.9743, lr_0 = 1.0000e-04
Validation rmse = 0.530928
Epoch 49
Loss = 5.1201e-01, PNorm = 43.1884, GNorm = 0.8031, lr_0 = 1.0000e-04
Validation rmse = 0.522019
Model 0 best validation rmse = 0.519772 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.573976
Ensemble test rmse = 0.573976
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.744915
Epoch 2
Loss = 8.6485e-01, PNorm = 42.7545, GNorm = 0.6917, lr_0 = 9.6081e-04
Validation rmse = 0.732367
Epoch 3
Loss = 9.2638e-01, PNorm = 42.7904, GNorm = 0.6258, lr_0 = 9.1581e-04
Loss = 9.7448e-01, PNorm = 42.8142, GNorm = 0.7180, lr_0 = 8.7992e-04
Validation rmse = 0.725324
Epoch 4
Loss = 9.2228e-01, PNorm = 42.8367, GNorm = 1.6641, lr_0 = 8.4544e-04
Validation rmse = 0.762112
Epoch 5
Loss = 8.0916e-01, PNorm = 42.8623, GNorm = 0.9734, lr_0 = 8.0584e-04
Validation rmse = 0.721074
Epoch 6
Loss = 9.2603e-01, PNorm = 42.8767, GNorm = 2.0749, lr_0 = 7.7426e-04
Loss = 7.4940e-01, PNorm = 42.8903, GNorm = 0.9793, lr_0 = 7.4392e-04
Loss = 6.2840e-01, PNorm = 42.8929, GNorm = 1.9568, lr_0 = 7.3800e-04
Validation rmse = 0.687455
Epoch 7
Loss = 7.0840e-01, PNorm = 42.9061, GNorm = 0.9054, lr_0 = 7.0908e-04
Validation rmse = 0.658955
Epoch 8
Loss = 6.9844e-01, PNorm = 42.9191, GNorm = 1.9106, lr_0 = 6.8129e-04
Validation rmse = 0.631478
Epoch 9
Loss = 6.5425e-01, PNorm = 42.9324, GNorm = 3.6529, lr_0 = 6.4938e-04
Loss = 7.1557e-01, PNorm = 42.9419, GNorm = 3.2294, lr_0 = 6.2393e-04
Validation rmse = 0.631343
Epoch 10
Loss = 6.1029e-01, PNorm = 42.9529, GNorm = 2.0958, lr_0 = 5.9948e-04
Validation rmse = 0.610010
Epoch 11
Loss = 6.5629e-01, PNorm = 42.9652, GNorm = 3.3576, lr_0 = 5.7141e-04
Validation rmse = 0.600151
Epoch 12
Loss = 5.6302e-01, PNorm = 42.9744, GNorm = 2.8485, lr_0 = 5.4901e-04
Loss = 6.6416e-01, PNorm = 42.9830, GNorm = 1.3063, lr_0 = 5.2750e-04
Validation rmse = 0.624658
Epoch 13
Loss = 6.0087e-01, PNorm = 42.9910, GNorm = 1.6155, lr_0 = 5.0683e-04
Validation rmse = 0.607558
Epoch 14
Loss = 5.9920e-01, PNorm = 43.0023, GNorm = 0.7370, lr_0 = 4.8309e-04
Validation rmse = 0.607923
Epoch 15
Loss = 6.7088e-01, PNorm = 43.0098, GNorm = 1.6087, lr_0 = 4.6416e-04
Validation rmse = 0.636262
Epoch 16
Loss = 6.5013e-01, PNorm = 43.0170, GNorm = 1.9773, lr_0 = 4.4242e-04
Loss = 5.8322e-01, PNorm = 43.0236, GNorm = 1.6343, lr_0 = 4.2508e-04
Validation rmse = 0.623467
Epoch 17
Loss = 5.8470e-01, PNorm = 43.0322, GNorm = 1.6330, lr_0 = 4.0842e-04
Validation rmse = 0.657007
Epoch 18
Loss = 6.1292e-01, PNorm = 43.0394, GNorm = 9.3172, lr_0 = 3.8929e-04
Validation rmse = 0.669399
Epoch 19
Loss = 6.7034e-01, PNorm = 43.0440, GNorm = 4.4544, lr_0 = 3.7404e-04
Loss = 5.6277e-01, PNorm = 43.0511, GNorm = 2.9011, lr_0 = 3.5938e-04
Loss = 6.9208e-01, PNorm = 43.0522, GNorm = 1.3345, lr_0 = 3.5652e-04
Validation rmse = 0.604930
Epoch 20
Loss = 5.7462e-01, PNorm = 43.0588, GNorm = 1.2109, lr_0 = 3.4255e-04
Validation rmse = 0.593561
Epoch 21
Loss = 5.4640e-01, PNorm = 43.0649, GNorm = 1.1005, lr_0 = 3.2913e-04
Validation rmse = 0.626237
Epoch 22
Loss = 5.4987e-01, PNorm = 43.0717, GNorm = 1.9241, lr_0 = 3.1371e-04
Loss = 5.7394e-01, PNorm = 43.0770, GNorm = 3.8550, lr_0 = 3.0142e-04
Validation rmse = 0.575768
Epoch 23
Loss = 5.5935e-01, PNorm = 43.0810, GNorm = 2.3430, lr_0 = 2.8960e-04
Validation rmse = 0.629664
Epoch 24
Loss = 5.5560e-01, PNorm = 43.0879, GNorm = 5.2356, lr_0 = 2.7604e-04
Validation rmse = 0.624438
Epoch 25
Loss = 5.9518e-01, PNorm = 43.0929, GNorm = 1.4844, lr_0 = 2.6522e-04
Loss = 5.6730e-01, PNorm = 43.0961, GNorm = 2.4505, lr_0 = 2.5483e-04
Validation rmse = 0.704078
Epoch 26
Loss = 5.4380e-01, PNorm = 43.1012, GNorm = 2.6582, lr_0 = 2.4484e-04
Validation rmse = 0.569677
Epoch 27
Loss = 5.5253e-01, PNorm = 43.1055, GNorm = 0.6798, lr_0 = 2.3338e-04
Validation rmse = 0.634141
Epoch 28
Loss = 4.4589e-01, PNorm = 43.1104, GNorm = 0.9508, lr_0 = 2.2423e-04
Validation rmse = 0.590835
Epoch 29
Loss = 5.2982e-01, PNorm = 43.1157, GNorm = 3.9613, lr_0 = 2.1373e-04
Loss = 5.1816e-01, PNorm = 43.1198, GNorm = 4.2249, lr_0 = 2.0535e-04
Validation rmse = 0.599278
Epoch 30
Loss = 5.3731e-01, PNorm = 43.1241, GNorm = 2.8107, lr_0 = 1.9731e-04
Validation rmse = 0.628205
Epoch 31
Loss = 5.5646e-01, PNorm = 43.1282, GNorm = 1.6970, lr_0 = 1.8806e-04
Validation rmse = 0.593188
Epoch 32
Loss = 5.1063e-01, PNorm = 43.1316, GNorm = 1.3246, lr_0 = 1.8069e-04
Loss = 5.2553e-01, PNorm = 43.1350, GNorm = 1.3521, lr_0 = 1.7361e-04
Loss = 4.5026e-01, PNorm = 43.1357, GNorm = 3.1461, lr_0 = 1.7223e-04
Validation rmse = 0.598117
Epoch 33
Loss = 5.0467e-01, PNorm = 43.1391, GNorm = 1.6715, lr_0 = 1.6548e-04
Validation rmse = 0.617019
Epoch 34
Loss = 5.2009e-01, PNorm = 43.1429, GNorm = 1.2471, lr_0 = 1.5900e-04
Validation rmse = 0.621699
Epoch 35
Loss = 5.1403e-01, PNorm = 43.1465, GNorm = 1.9909, lr_0 = 1.5155e-04
Loss = 4.9599e-01, PNorm = 43.1498, GNorm = 3.6385, lr_0 = 1.4561e-04
Validation rmse = 0.588037
Epoch 36
Loss = 4.8274e-01, PNorm = 43.1523, GNorm = 3.0823, lr_0 = 1.3991e-04
Validation rmse = 0.633785
Epoch 37
Loss = 5.2309e-01, PNorm = 43.1556, GNorm = 0.8905, lr_0 = 1.3335e-04
Validation rmse = 0.587100
Epoch 38
Loss = 5.1740e-01, PNorm = 43.1584, GNorm = 0.9766, lr_0 = 1.2813e-04
Loss = 4.8160e-01, PNorm = 43.1611, GNorm = 1.4618, lr_0 = 1.2311e-04
Validation rmse = 0.617883
Epoch 39
Loss = 4.8034e-01, PNorm = 43.1639, GNorm = 3.7272, lr_0 = 1.1828e-04
Validation rmse = 0.609135
Epoch 40
Loss = 5.2349e-01, PNorm = 43.1667, GNorm = 5.1198, lr_0 = 1.1274e-04
Validation rmse = 0.598291
Epoch 41
Loss = 4.8324e-01, PNorm = 43.1689, GNorm = 3.4337, lr_0 = 1.0832e-04
Validation rmse = 0.605704
Epoch 42
Loss = 4.9115e-01, PNorm = 43.1716, GNorm = 2.0709, lr_0 = 1.0325e-04
Loss = 5.1568e-01, PNorm = 43.1738, GNorm = 3.0564, lr_0 = 1.0000e-04
Validation rmse = 0.612977
Epoch 43
Loss = 4.9672e-01, PNorm = 43.1759, GNorm = 1.2460, lr_0 = 1.0000e-04
Validation rmse = 0.611327
Epoch 44
Loss = 4.4809e-01, PNorm = 43.1784, GNorm = 2.5257, lr_0 = 1.0000e-04
Validation rmse = 0.594959
Epoch 45
Loss = 4.4266e-01, PNorm = 43.1807, GNorm = 2.0488, lr_0 = 1.0000e-04
Loss = 4.9858e-01, PNorm = 43.1828, GNorm = 2.5104, lr_0 = 1.0000e-04
Loss = 4.9950e-01, PNorm = 43.1832, GNorm = 1.6182, lr_0 = 1.0000e-04
Validation rmse = 0.608081
Epoch 46
Loss = 4.7206e-01, PNorm = 43.1854, GNorm = 0.9393, lr_0 = 1.0000e-04
Validation rmse = 0.606950
Epoch 47
Loss = 4.8574e-01, PNorm = 43.1875, GNorm = 1.1287, lr_0 = 1.0000e-04
Validation rmse = 0.597271
Epoch 48
Loss = 5.0658e-01, PNorm = 43.1902, GNorm = 3.3686, lr_0 = 1.0000e-04
Loss = 4.6359e-01, PNorm = 43.1922, GNorm = 2.2969, lr_0 = 1.0000e-04
Validation rmse = 0.615465
Epoch 49
Loss = 4.6613e-01, PNorm = 43.1944, GNorm = 6.8586, lr_0 = 1.0000e-04
Validation rmse = 0.595283
Model 0 best validation rmse = 0.569677 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.531520
Ensemble test rmse = 0.531520
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732175
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7520, GNorm = 0.8329, lr_0 = 9.6081e-04
Validation rmse = 0.725436
Epoch 3
Loss = 9.6696e-01, PNorm = 42.7875, GNorm = 0.8183, lr_0 = 9.1581e-04
Loss = 9.3853e-01, PNorm = 42.8129, GNorm = 0.9191, lr_0 = 8.7992e-04
Validation rmse = 0.690701
Epoch 4
Loss = 8.9802e-01, PNorm = 42.8346, GNorm = 1.1266, lr_0 = 8.4544e-04
Validation rmse = 0.676597
Epoch 5
Loss = 8.6211e-01, PNorm = 42.8598, GNorm = 1.1236, lr_0 = 8.0584e-04
Validation rmse = 0.655937
Epoch 6
Loss = 7.3475e-01, PNorm = 42.8790, GNorm = 1.2896, lr_0 = 7.7426e-04
Loss = 7.3972e-01, PNorm = 42.8942, GNorm = 2.6156, lr_0 = 7.4392e-04
Loss = 7.7591e-01, PNorm = 42.8966, GNorm = 2.6759, lr_0 = 7.3800e-04
Validation rmse = 0.636719
Epoch 7
Loss = 7.4942e-01, PNorm = 42.9097, GNorm = 4.4558, lr_0 = 7.0908e-04
Validation rmse = 0.659499
Epoch 8
Loss = 6.5145e-01, PNorm = 42.9224, GNorm = 2.2730, lr_0 = 6.8129e-04
Validation rmse = 0.592910
Epoch 9
Loss = 6.4793e-01, PNorm = 42.9377, GNorm = 3.6997, lr_0 = 6.4938e-04
Loss = 6.8406e-01, PNorm = 42.9484, GNorm = 2.4550, lr_0 = 6.2393e-04
Validation rmse = 0.568382
Epoch 10
Loss = 6.6599e-01, PNorm = 42.9584, GNorm = 4.5140, lr_0 = 5.9948e-04
Validation rmse = 0.590685
Epoch 11
Loss = 6.5184e-01, PNorm = 42.9687, GNorm = 3.0642, lr_0 = 5.7141e-04
Validation rmse = 0.572547
Epoch 12
Loss = 6.5654e-01, PNorm = 42.9771, GNorm = 0.9257, lr_0 = 5.4901e-04
Loss = 6.5488e-01, PNorm = 42.9871, GNorm = 1.4509, lr_0 = 5.2750e-04
Validation rmse = 0.565147
Epoch 13
Loss = 6.5751e-01, PNorm = 42.9952, GNorm = 1.6383, lr_0 = 5.0683e-04
Validation rmse = 0.643280
Epoch 14
Loss = 6.2841e-01, PNorm = 43.0068, GNorm = 1.5261, lr_0 = 4.8309e-04
Validation rmse = 0.561856
Epoch 15
Loss = 6.5803e-01, PNorm = 43.0157, GNorm = 1.0248, lr_0 = 4.6416e-04
Validation rmse = 0.565974
Epoch 16
Loss = 6.1076e-01, PNorm = 43.0273, GNorm = 1.2640, lr_0 = 4.4242e-04
Loss = 6.1596e-01, PNorm = 43.0337, GNorm = 0.7078, lr_0 = 4.2508e-04
Validation rmse = 0.630033
Epoch 17
Loss = 5.9758e-01, PNorm = 43.0420, GNorm = 2.0359, lr_0 = 4.0842e-04
Validation rmse = 0.568126
Epoch 18
Loss = 5.5112e-01, PNorm = 43.0501, GNorm = 0.7489, lr_0 = 3.8929e-04
Validation rmse = 0.570189
Epoch 19
Loss = 6.1209e-01, PNorm = 43.0585, GNorm = 1.1376, lr_0 = 3.7404e-04
Loss = 5.7680e-01, PNorm = 43.0659, GNorm = 0.9443, lr_0 = 3.5938e-04
Loss = 4.8164e-01, PNorm = 43.0672, GNorm = 1.9283, lr_0 = 3.5652e-04
Validation rmse = 0.552606
Epoch 20
Loss = 5.8503e-01, PNorm = 43.0728, GNorm = 0.8926, lr_0 = 3.4255e-04
Validation rmse = 0.569776
Epoch 21
Loss = 5.9390e-01, PNorm = 43.0797, GNorm = 3.3916, lr_0 = 3.2913e-04
Validation rmse = 0.580423
Epoch 22
Loss = 5.1376e-01, PNorm = 43.0875, GNorm = 1.0813, lr_0 = 3.1371e-04
Loss = 5.5968e-01, PNorm = 43.0941, GNorm = 2.8590, lr_0 = 3.0142e-04
Validation rmse = 0.560026
Epoch 23
Loss = 5.1388e-01, PNorm = 43.1003, GNorm = 2.4130, lr_0 = 2.8960e-04
Validation rmse = 0.525615
Epoch 24
Loss = 5.3432e-01, PNorm = 43.1078, GNorm = 2.9767, lr_0 = 2.7604e-04
Validation rmse = 0.560131
Epoch 25
Loss = 5.2424e-01, PNorm = 43.1147, GNorm = 0.8224, lr_0 = 2.6522e-04
Loss = 5.3469e-01, PNorm = 43.1207, GNorm = 1.7745, lr_0 = 2.5483e-04
Validation rmse = 0.577160
Epoch 26
Loss = 5.3834e-01, PNorm = 43.1269, GNorm = 1.1777, lr_0 = 2.4484e-04
Validation rmse = 0.538220
Epoch 27
Loss = 5.5429e-01, PNorm = 43.1336, GNorm = 2.4374, lr_0 = 2.3338e-04
Validation rmse = 0.558620
Epoch 28
Loss = 5.4999e-01, PNorm = 43.1391, GNorm = 2.1939, lr_0 = 2.2423e-04
Validation rmse = 0.608195
Epoch 29
Loss = 4.9182e-01, PNorm = 43.1442, GNorm = 2.3960, lr_0 = 2.1373e-04
Loss = 5.0673e-01, PNorm = 43.1495, GNorm = 1.1828, lr_0 = 2.0535e-04
Validation rmse = 0.531119
Epoch 30
Loss = 5.0208e-01, PNorm = 43.1532, GNorm = 2.1018, lr_0 = 1.9731e-04
Validation rmse = 0.529228
Epoch 31
Loss = 5.6733e-01, PNorm = 43.1591, GNorm = 6.6215, lr_0 = 1.8806e-04
Validation rmse = 0.597578
Epoch 32
Loss = 5.0459e-01, PNorm = 43.1628, GNorm = 2.7386, lr_0 = 1.8069e-04
Loss = 5.0013e-01, PNorm = 43.1674, GNorm = 2.7041, lr_0 = 1.7361e-04
Loss = 5.7654e-01, PNorm = 43.1683, GNorm = 1.6364, lr_0 = 1.7223e-04
Validation rmse = 0.519444
Epoch 33
Loss = 5.3161e-01, PNorm = 43.1719, GNorm = 6.3019, lr_0 = 1.6548e-04
Validation rmse = 0.558917
Epoch 34
Loss = 5.5324e-01, PNorm = 43.1760, GNorm = 0.9523, lr_0 = 1.5900e-04
Validation rmse = 0.551702
Epoch 35
Loss = 5.0424e-01, PNorm = 43.1802, GNorm = 1.9967, lr_0 = 1.5155e-04
Loss = 4.9707e-01, PNorm = 43.1836, GNorm = 2.6951, lr_0 = 1.4561e-04
Validation rmse = 0.539288
Epoch 36
Loss = 4.8725e-01, PNorm = 43.1863, GNorm = 1.2030, lr_0 = 1.3991e-04
Validation rmse = 0.541334
Epoch 37
Loss = 4.6935e-01, PNorm = 43.1900, GNorm = 1.6318, lr_0 = 1.3335e-04
Validation rmse = 0.575766
Epoch 38
Loss = 4.8709e-01, PNorm = 43.1929, GNorm = 1.5381, lr_0 = 1.2813e-04
Loss = 4.9534e-01, PNorm = 43.1960, GNorm = 1.7026, lr_0 = 1.2311e-04
Validation rmse = 0.555365
Epoch 39
Loss = 4.7482e-01, PNorm = 43.1986, GNorm = 3.6698, lr_0 = 1.1828e-04
Validation rmse = 0.531889
Epoch 40
Loss = 4.4314e-01, PNorm = 43.2018, GNorm = 1.6739, lr_0 = 1.1274e-04
Validation rmse = 0.567735
Epoch 41
Loss = 5.1341e-01, PNorm = 43.2044, GNorm = 0.9104, lr_0 = 1.0832e-04
Validation rmse = 0.554929
Epoch 42
Loss = 4.7737e-01, PNorm = 43.2070, GNorm = 4.2479, lr_0 = 1.0325e-04
Loss = 4.8630e-01, PNorm = 43.2092, GNorm = 1.6810, lr_0 = 1.0000e-04
Validation rmse = 0.525583
Epoch 43
Loss = 4.8539e-01, PNorm = 43.2116, GNorm = 3.3688, lr_0 = 1.0000e-04
Validation rmse = 0.579186
Epoch 44
Loss = 5.1356e-01, PNorm = 43.2138, GNorm = 3.5476, lr_0 = 1.0000e-04
Validation rmse = 0.532182
Epoch 45
Loss = 5.1604e-01, PNorm = 43.2165, GNorm = 4.5321, lr_0 = 1.0000e-04
Loss = 4.7332e-01, PNorm = 43.2186, GNorm = 1.7756, lr_0 = 1.0000e-04
Loss = 4.3928e-01, PNorm = 43.2191, GNorm = 3.1335, lr_0 = 1.0000e-04
Validation rmse = 0.551464
Epoch 46
Loss = 4.7051e-01, PNorm = 43.2213, GNorm = 1.2073, lr_0 = 1.0000e-04
Validation rmse = 0.545521
Epoch 47
Loss = 4.2038e-01, PNorm = 43.2235, GNorm = 1.4983, lr_0 = 1.0000e-04
Validation rmse = 0.548369
Epoch 48
Loss = 4.5087e-01, PNorm = 43.2263, GNorm = 1.0292, lr_0 = 1.0000e-04
Loss = 4.7395e-01, PNorm = 43.2288, GNorm = 3.9539, lr_0 = 1.0000e-04
Validation rmse = 0.533480
Epoch 49
Loss = 4.5950e-01, PNorm = 43.2307, GNorm = 2.6961, lr_0 = 1.0000e-04
Validation rmse = 0.539725
Model 0 best validation rmse = 0.519444 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.475291
Ensemble test rmse = 0.475291
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.6854e+00, PNorm = 42.6832, GNorm = 6.5055, lr_0 = 7.5000e-04
Validation rmse = 0.779950
Epoch 1
Loss = 1.0715e+00, PNorm = 42.7188, GNorm = 1.6002, lr_0 = 1.0000e-03
Validation rmse = 0.764412
Epoch 2
Loss = 9.2667e-01, PNorm = 42.7535, GNorm = 0.9784, lr_0 = 9.6081e-04
Validation rmse = 0.742779
Epoch 3
Loss = 9.2276e-01, PNorm = 42.7873, GNorm = 0.7816, lr_0 = 9.1581e-04
Loss = 9.6840e-01, PNorm = 42.8103, GNorm = 0.7806, lr_0 = 8.7992e-04
Validation rmse = 0.738063
Epoch 4
Loss = 9.0325e-01, PNorm = 42.8311, GNorm = 0.7982, lr_0 = 8.4544e-04
Validation rmse = 0.687609
Epoch 5
Loss = 9.3018e-01, PNorm = 42.8556, GNorm = 2.0777, lr_0 = 8.0584e-04
Validation rmse = 0.744201
Epoch 6
Loss = 7.7005e-01, PNorm = 42.8733, GNorm = 3.8007, lr_0 = 7.7426e-04
Loss = 8.2223e-01, PNorm = 42.8874, GNorm = 3.3249, lr_0 = 7.4392e-04
Loss = 1.0001e+00, PNorm = 42.8901, GNorm = 4.4107, lr_0 = 7.3800e-04
Validation rmse = 0.697079
Epoch 7
Loss = 8.1545e-01, PNorm = 42.9039, GNorm = 3.7575, lr_0 = 7.0908e-04
Validation rmse = 0.666133
Epoch 8
Loss = 7.7399e-01, PNorm = 42.9156, GNorm = 2.1042, lr_0 = 6.8129e-04
Validation rmse = 0.601339
Epoch 9
Loss = 6.9724e-01, PNorm = 42.9319, GNorm = 1.9748, lr_0 = 6.4938e-04
Loss = 7.4098e-01, PNorm = 42.9437, GNorm = 1.4287, lr_0 = 6.2393e-04
Validation rmse = 0.632894
Epoch 10
Loss = 7.0405e-01, PNorm = 42.9561, GNorm = 1.5701, lr_0 = 5.9948e-04
Validation rmse = 0.597565
Epoch 11
Loss = 6.5673e-01, PNorm = 42.9691, GNorm = 0.7748, lr_0 = 5.7141e-04
Validation rmse = 0.583754
Epoch 12
Loss = 5.5007e-01, PNorm = 42.9802, GNorm = 1.2046, lr_0 = 5.4901e-04
Loss = 6.8826e-01, PNorm = 42.9898, GNorm = 2.6975, lr_0 = 5.2750e-04
Validation rmse = 0.628635
Epoch 13
Loss = 6.1374e-01, PNorm = 42.9999, GNorm = 0.7025, lr_0 = 5.0683e-04
Validation rmse = 0.573072
Epoch 14
Loss = 6.7469e-01, PNorm = 43.0108, GNorm = 1.0798, lr_0 = 4.8309e-04
Validation rmse = 0.558508
Epoch 15
Loss = 6.6599e-01, PNorm = 43.0205, GNorm = 1.1265, lr_0 = 4.6416e-04
Validation rmse = 0.562863
Epoch 16
Loss = 5.7521e-01, PNorm = 43.0308, GNorm = 0.9522, lr_0 = 4.4242e-04
Loss = 6.2677e-01, PNorm = 43.0375, GNorm = 4.0305, lr_0 = 4.2508e-04
Validation rmse = 0.578486
Epoch 17
Loss = 5.8752e-01, PNorm = 43.0452, GNorm = 5.0322, lr_0 = 4.0842e-04
Validation rmse = 0.591303
Epoch 18
Loss = 5.9017e-01, PNorm = 43.0553, GNorm = 2.6869, lr_0 = 3.8929e-04
Validation rmse = 0.599849
Epoch 19
Loss = 6.5140e-01, PNorm = 43.0626, GNorm = 1.2006, lr_0 = 3.7404e-04
Loss = 5.6357e-01, PNorm = 43.0702, GNorm = 1.6717, lr_0 = 3.5938e-04
Loss = 5.3875e-01, PNorm = 43.0712, GNorm = 1.4281, lr_0 = 3.5652e-04
Validation rmse = 0.584882
Epoch 20
Loss = 6.0273e-01, PNorm = 43.0783, GNorm = 1.3053, lr_0 = 3.4255e-04
Validation rmse = 0.546698
Epoch 21
Loss = 5.7297e-01, PNorm = 43.0854, GNorm = 1.2976, lr_0 = 3.2913e-04
Validation rmse = 0.557707
Epoch 22
Loss = 5.2579e-01, PNorm = 43.0944, GNorm = 1.5474, lr_0 = 3.1371e-04
Loss = 5.7106e-01, PNorm = 43.1005, GNorm = 1.6075, lr_0 = 3.0142e-04
Validation rmse = 0.598279
Epoch 23
Loss = 5.6258e-01, PNorm = 43.1074, GNorm = 0.9945, lr_0 = 2.8960e-04
Validation rmse = 0.555931
Epoch 24
Loss = 5.7231e-01, PNorm = 43.1134, GNorm = 3.3388, lr_0 = 2.7604e-04
Validation rmse = 0.543168
Epoch 25
Loss = 5.4927e-01, PNorm = 43.1197, GNorm = 3.1962, lr_0 = 2.6522e-04
Loss = 5.4379e-01, PNorm = 43.1246, GNorm = 2.2911, lr_0 = 2.5483e-04
Validation rmse = 0.600341
Epoch 26
Loss = 5.5119e-01, PNorm = 43.1305, GNorm = 1.8715, lr_0 = 2.4484e-04
Validation rmse = 0.554880
Epoch 27
Loss = 5.3268e-01, PNorm = 43.1360, GNorm = 4.5075, lr_0 = 2.3338e-04
Validation rmse = 0.538111
Epoch 28
Loss = 5.9010e-01, PNorm = 43.1411, GNorm = 3.8050, lr_0 = 2.2423e-04
Validation rmse = 0.592506
Epoch 29
Loss = 5.4657e-01, PNorm = 43.1461, GNorm = 3.8382, lr_0 = 2.1373e-04
Loss = 5.2947e-01, PNorm = 43.1506, GNorm = 1.1686, lr_0 = 2.0535e-04
Validation rmse = 0.543419
Epoch 30
Loss = 5.5368e-01, PNorm = 43.1542, GNorm = 1.0444, lr_0 = 1.9731e-04
Validation rmse = 0.578961
Epoch 31
Loss = 5.0484e-01, PNorm = 43.1585, GNorm = 1.7343, lr_0 = 1.8806e-04
Validation rmse = 0.541218
Epoch 32
Loss = 4.9651e-01, PNorm = 43.1623, GNorm = 4.0503, lr_0 = 1.8069e-04
Loss = 5.3948e-01, PNorm = 43.1658, GNorm = 1.6292, lr_0 = 1.7361e-04
Loss = 5.6296e-01, PNorm = 43.1669, GNorm = 1.2944, lr_0 = 1.7223e-04
Validation rmse = 0.528782
Epoch 33
Loss = 4.9984e-01, PNorm = 43.1704, GNorm = 1.6379, lr_0 = 1.6548e-04
Validation rmse = 0.614149
Epoch 34
Loss = 5.6957e-01, PNorm = 43.1738, GNorm = 4.8285, lr_0 = 1.5900e-04
Validation rmse = 0.521788
Epoch 35
Loss = 4.4401e-01, PNorm = 43.1780, GNorm = 3.9923, lr_0 = 1.5155e-04
Loss = 5.6902e-01, PNorm = 43.1807, GNorm = 5.3522, lr_0 = 1.4561e-04
Validation rmse = 0.577418
Epoch 36
Loss = 4.8539e-01, PNorm = 43.1842, GNorm = 1.9202, lr_0 = 1.3991e-04
Validation rmse = 0.545207
Epoch 37
Loss = 4.8691e-01, PNorm = 43.1872, GNorm = 2.1152, lr_0 = 1.3335e-04
Validation rmse = 0.548507
Epoch 38
Loss = 4.5917e-01, PNorm = 43.1902, GNorm = 1.3240, lr_0 = 1.2813e-04
Loss = 5.1416e-01, PNorm = 43.1928, GNorm = 3.7745, lr_0 = 1.2311e-04
Validation rmse = 0.562560
Epoch 39
Loss = 4.5512e-01, PNorm = 43.1955, GNorm = 1.3439, lr_0 = 1.1828e-04
Validation rmse = 0.538482
Epoch 40
Loss = 4.8009e-01, PNorm = 43.1981, GNorm = 2.6546, lr_0 = 1.1274e-04
Validation rmse = 0.562587
Epoch 41
Loss = 4.3450e-01, PNorm = 43.2006, GNorm = 1.5779, lr_0 = 1.0832e-04
Validation rmse = 0.547256
Epoch 42
Loss = 4.5320e-01, PNorm = 43.2032, GNorm = 1.7799, lr_0 = 1.0325e-04
Loss = 4.8529e-01, PNorm = 43.2054, GNorm = 4.5397, lr_0 = 1.0000e-04
Validation rmse = 0.553555
Epoch 43
Loss = 5.0543e-01, PNorm = 43.2083, GNorm = 7.2797, lr_0 = 1.0000e-04
Validation rmse = 0.571098
Epoch 44
Loss = 4.7033e-01, PNorm = 43.2100, GNorm = 4.0006, lr_0 = 1.0000e-04
Validation rmse = 0.535141
Epoch 45
Loss = 5.8062e-01, PNorm = 43.2128, GNorm = 2.5373, lr_0 = 1.0000e-04
Loss = 4.9333e-01, PNorm = 43.2144, GNorm = 3.2010, lr_0 = 1.0000e-04
Loss = 5.5284e-01, PNorm = 43.2146, GNorm = 1.9812, lr_0 = 1.0000e-04
Validation rmse = 0.563674
Epoch 46
Loss = 5.1197e-01, PNorm = 43.2164, GNorm = 5.6722, lr_0 = 1.0000e-04
Validation rmse = 0.547070
Epoch 47
Loss = 4.7590e-01, PNorm = 43.2193, GNorm = 3.0388, lr_0 = 1.0000e-04
Validation rmse = 0.537789
Epoch 48
Loss = 5.1578e-01, PNorm = 43.2212, GNorm = 1.3849, lr_0 = 1.0000e-04
Loss = 4.9813e-01, PNorm = 43.2234, GNorm = 1.4909, lr_0 = 1.0000e-04
Validation rmse = 0.573864
Epoch 49
Loss = 4.6626e-01, PNorm = 43.2259, GNorm = 2.0195, lr_0 = 1.0000e-04
Validation rmse = 0.525440
Model 0 best validation rmse = 0.521788 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.567819
Ensemble test rmse = 0.567819
5-fold cross validation
	Seed 0 ==> test rmse = 0.512859
	Seed 1 ==> test rmse = 0.573976
	Seed 2 ==> test rmse = 0.531520
	Seed 3 ==> test rmse = 0.475291
	Seed 4 ==> test rmse = 0.567819
Overall test rmse = 0.532293 +/- 0.036406
Elapsed time = 0:44:05
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-b43f099e-d291-457c-9693-29f974983f57.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715428
Epoch 2
Loss = 8.0470e-01, PNorm = 42.7511, GNorm = 0.7403, lr_0 = 9.6081e-04
Validation rmse = 0.707724
Epoch 3
Loss = 8.5218e-01, PNorm = 42.7845, GNorm = 0.8345, lr_0 = 9.1581e-04
Loss = 9.8716e-01, PNorm = 42.8072, GNorm = 1.0967, lr_0 = 8.7992e-04
Validation rmse = 0.682377
Epoch 4
Loss = 9.3868e-01, PNorm = 42.8287, GNorm = 0.7124, lr_0 = 8.4544e-04
Validation rmse = 0.643952
Epoch 5
Loss = 7.8700e-01, PNorm = 42.8538, GNorm = 0.8321, lr_0 = 8.0584e-04
Validation rmse = 0.621464
Epoch 6
Loss = 7.2425e-01, PNorm = 42.8740, GNorm = 1.2316, lr_0 = 7.7426e-04
Loss = 7.6944e-01, PNorm = 42.8914, GNorm = 3.6430, lr_0 = 7.4392e-04
Loss = 8.3177e-01, PNorm = 42.8940, GNorm = 1.9631, lr_0 = 7.3800e-04
Validation rmse = 0.611985
Epoch 7
Loss = 7.2520e-01, PNorm = 42.9051, GNorm = 3.8268, lr_0 = 7.0908e-04
Validation rmse = 0.593673
Epoch 8
Loss = 6.9420e-01, PNorm = 42.9169, GNorm = 2.0557, lr_0 = 6.8129e-04
Validation rmse = 0.603795
Epoch 9
Loss = 6.5729e-01, PNorm = 42.9319, GNorm = 1.8476, lr_0 = 6.4938e-04
Loss = 6.6250e-01, PNorm = 42.9428, GNorm = 5.9652, lr_0 = 6.2393e-04
Validation rmse = 0.627030
Epoch 10
Loss = 6.3767e-01, PNorm = 42.9509, GNorm = 7.4064, lr_0 = 5.9948e-04
Validation rmse = 0.609701
Epoch 11
Loss = 6.8265e-01, PNorm = 42.9579, GNorm = 0.8366, lr_0 = 5.7141e-04
Validation rmse = 0.578364
Epoch 12
Loss = 6.7506e-01, PNorm = 42.9654, GNorm = 0.8450, lr_0 = 5.4901e-04
Loss = 6.5360e-01, PNorm = 42.9758, GNorm = 1.5181, lr_0 = 5.2750e-04
Validation rmse = 0.595749
Epoch 13
Loss = 6.5460e-01, PNorm = 42.9845, GNorm = 2.6990, lr_0 = 5.0683e-04
Validation rmse = 0.583494
Epoch 14
Loss = 6.7414e-01, PNorm = 42.9944, GNorm = 4.0631, lr_0 = 4.8309e-04
Validation rmse = 0.588445
Epoch 15
Loss = 5.6812e-01, PNorm = 43.0004, GNorm = 4.7747, lr_0 = 4.6416e-04
Validation rmse = 0.566447
Epoch 16
Loss = 6.4410e-01, PNorm = 43.0071, GNorm = 2.2309, lr_0 = 4.4242e-04
Loss = 6.1837e-01, PNorm = 43.0143, GNorm = 1.5162, lr_0 = 4.2508e-04
Validation rmse = 0.577991
Epoch 17
Loss = 5.7222e-01, PNorm = 43.0208, GNorm = 0.8120, lr_0 = 4.0842e-04
Validation rmse = 0.572175
Epoch 18
Loss = 4.9129e-01, PNorm = 43.0294, GNorm = 0.6802, lr_0 = 3.8929e-04
Validation rmse = 0.561993
Epoch 19
Loss = 6.1194e-01, PNorm = 43.0357, GNorm = 1.4579, lr_0 = 3.7404e-04
Loss = 5.8762e-01, PNorm = 43.0430, GNorm = 1.8799, lr_0 = 3.5938e-04
Loss = 7.9552e-01, PNorm = 43.0441, GNorm = 5.6805, lr_0 = 3.5652e-04
Validation rmse = 0.589406
Epoch 20
Loss = 5.8092e-01, PNorm = 43.0479, GNorm = 3.1521, lr_0 = 3.4255e-04
Validation rmse = 0.567041
Epoch 21
Loss = 5.3800e-01, PNorm = 43.0543, GNorm = 0.8935, lr_0 = 3.2913e-04
Validation rmse = 0.556743
Epoch 22
Loss = 6.0893e-01, PNorm = 43.0607, GNorm = 4.6159, lr_0 = 3.1371e-04
Loss = 5.2362e-01, PNorm = 43.0671, GNorm = 1.3602, lr_0 = 3.0142e-04
Validation rmse = 0.561430
Epoch 23
Loss = 5.8316e-01, PNorm = 43.0722, GNorm = 1.1697, lr_0 = 2.8960e-04
Validation rmse = 0.577356
Epoch 24
Loss = 5.4694e-01, PNorm = 43.0789, GNorm = 1.8599, lr_0 = 2.7604e-04
Validation rmse = 0.564905
Epoch 25
Loss = 5.7970e-01, PNorm = 43.0844, GNorm = 0.8631, lr_0 = 2.6522e-04
Loss = 5.3776e-01, PNorm = 43.0889, GNorm = 1.1021, lr_0 = 2.5483e-04
Validation rmse = 0.574223
Epoch 26
Loss = 5.4713e-01, PNorm = 43.0939, GNorm = 1.3857, lr_0 = 2.4484e-04
Validation rmse = 0.558112
Epoch 27
Loss = 5.8598e-01, PNorm = 43.0990, GNorm = 2.0705, lr_0 = 2.3338e-04
Validation rmse = 0.566323
Epoch 28
Loss = 4.9446e-01, PNorm = 43.1027, GNorm = 5.1450, lr_0 = 2.2423e-04
Validation rmse = 0.559486
Epoch 29
Loss = 4.8991e-01, PNorm = 43.1074, GNorm = 3.1827, lr_0 = 2.1373e-04
Loss = 5.5363e-01, PNorm = 43.1110, GNorm = 0.8950, lr_0 = 2.0535e-04
Validation rmse = 0.560240
Epoch 30
Loss = 5.1193e-01, PNorm = 43.1150, GNorm = 1.7071, lr_0 = 1.9731e-04
Validation rmse = 0.558462
Epoch 31
Loss = 5.1452e-01, PNorm = 43.1200, GNorm = 3.8862, lr_0 = 1.8806e-04
Validation rmse = 0.569437
Epoch 32
Loss = 5.6899e-01, PNorm = 43.1238, GNorm = 3.5975, lr_0 = 1.8069e-04
Loss = 5.0646e-01, PNorm = 43.1276, GNorm = 0.9401, lr_0 = 1.7361e-04
Loss = 5.5674e-01, PNorm = 43.1282, GNorm = 5.2906, lr_0 = 1.7223e-04
Validation rmse = 0.564932
Epoch 33
Loss = 5.3275e-01, PNorm = 43.1315, GNorm = 2.0579, lr_0 = 1.6548e-04
Validation rmse = 0.557440
Epoch 34
Loss = 4.7139e-01, PNorm = 43.1346, GNorm = 3.4663, lr_0 = 1.5900e-04
Validation rmse = 0.558906
Epoch 35
Loss = 5.2989e-01, PNorm = 43.1386, GNorm = 4.1664, lr_0 = 1.5155e-04
Loss = 4.7476e-01, PNorm = 43.1414, GNorm = 2.9065, lr_0 = 1.4561e-04
Validation rmse = 0.563319
Epoch 36
Loss = 4.9772e-01, PNorm = 43.1447, GNorm = 3.7442, lr_0 = 1.3991e-04
Validation rmse = 0.563336
Epoch 37
Loss = 5.5534e-01, PNorm = 43.1482, GNorm = 2.7444, lr_0 = 1.3335e-04
Validation rmse = 0.583908
Epoch 38
Loss = 5.2870e-01, PNorm = 43.1507, GNorm = 3.9643, lr_0 = 1.2813e-04
Loss = 5.3348e-01, PNorm = 43.1534, GNorm = 2.8061, lr_0 = 1.2311e-04
Validation rmse = 0.560037
Epoch 39
Loss = 5.0813e-01, PNorm = 43.1550, GNorm = 1.8508, lr_0 = 1.1828e-04
Validation rmse = 0.563303
Epoch 40
Loss = 5.1284e-01, PNorm = 43.1582, GNorm = 1.1284, lr_0 = 1.1274e-04
Validation rmse = 0.552070
Epoch 41
Loss = 5.4818e-01, PNorm = 43.1605, GNorm = 0.7870, lr_0 = 1.0832e-04
Validation rmse = 0.565203
Epoch 42
Loss = 5.1586e-01, PNorm = 43.1633, GNorm = 3.4882, lr_0 = 1.0325e-04
Loss = 4.7938e-01, PNorm = 43.1659, GNorm = 2.4709, lr_0 = 1.0000e-04
Validation rmse = 0.562598
Epoch 43
Loss = 4.7321e-01, PNorm = 43.1674, GNorm = 3.5288, lr_0 = 1.0000e-04
Validation rmse = 0.568006
Epoch 44
Loss = 4.6907e-01, PNorm = 43.1699, GNorm = 1.0523, lr_0 = 1.0000e-04
Validation rmse = 0.554128
Epoch 45
Loss = 4.8075e-01, PNorm = 43.1722, GNorm = 1.8755, lr_0 = 1.0000e-04
Loss = 5.2424e-01, PNorm = 43.1739, GNorm = 5.6489, lr_0 = 1.0000e-04
Loss = 3.6971e-01, PNorm = 43.1743, GNorm = 4.4004, lr_0 = 1.0000e-04
Validation rmse = 0.561272
Epoch 46
Loss = 5.0686e-01, PNorm = 43.1767, GNorm = 6.1700, lr_0 = 1.0000e-04
Validation rmse = 0.551847
Epoch 47
Loss = 4.5478e-01, PNorm = 43.1786, GNorm = 2.4554, lr_0 = 1.0000e-04
Validation rmse = 0.559788
Epoch 48
Loss = 4.5685e-01, PNorm = 43.1816, GNorm = 1.6674, lr_0 = 1.0000e-04
Loss = 4.9320e-01, PNorm = 43.1837, GNorm = 1.9811, lr_0 = 1.0000e-04
Validation rmse = 0.562831
Epoch 49
Loss = 5.2424e-01, PNorm = 43.1857, GNorm = 1.6787, lr_0 = 1.0000e-04
Validation rmse = 0.554206
Model 0 best validation rmse = 0.551847 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.512859
Ensemble test rmse = 0.512859
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.696990
Epoch 2
Loss = 1.0447e+00, PNorm = 42.7500, GNorm = 1.2388, lr_0 = 9.6081e-04
Validation rmse = 0.692277
Epoch 3
Loss = 8.9254e-01, PNorm = 42.7829, GNorm = 1.5975, lr_0 = 9.1581e-04
Loss = 9.9338e-01, PNorm = 42.8038, GNorm = 0.8217, lr_0 = 8.7992e-04
Validation rmse = 0.674967
Epoch 4
Loss = 9.7613e-01, PNorm = 42.8216, GNorm = 0.7748, lr_0 = 8.4544e-04
Validation rmse = 0.662272
Epoch 5
Loss = 7.8577e-01, PNorm = 42.8409, GNorm = 1.4517, lr_0 = 8.0584e-04
Validation rmse = 0.621103
Epoch 6
Loss = 8.7162e-01, PNorm = 42.8582, GNorm = 1.7258, lr_0 = 7.7426e-04
Loss = 7.9467e-01, PNorm = 42.8765, GNorm = 1.0621, lr_0 = 7.4392e-04
Loss = 7.7843e-01, PNorm = 42.8803, GNorm = 3.1518, lr_0 = 7.3800e-04
Validation rmse = 0.587920
Epoch 7
Loss = 7.5921e-01, PNorm = 42.8951, GNorm = 0.8871, lr_0 = 7.0908e-04
Validation rmse = 0.585541
Epoch 8
Loss = 7.7772e-01, PNorm = 42.9053, GNorm = 2.9853, lr_0 = 6.8129e-04
Validation rmse = 0.582299
Epoch 9
Loss = 7.0291e-01, PNorm = 42.9159, GNorm = 2.9786, lr_0 = 6.4938e-04
Loss = 7.4704e-01, PNorm = 42.9253, GNorm = 3.2116, lr_0 = 6.2393e-04
Validation rmse = 0.575011
Epoch 10
Loss = 6.5459e-01, PNorm = 42.9372, GNorm = 1.2224, lr_0 = 5.9948e-04
Validation rmse = 0.557648
Epoch 11
Loss = 6.7359e-01, PNorm = 42.9503, GNorm = 1.6368, lr_0 = 5.7141e-04
Validation rmse = 0.560364
Epoch 12
Loss = 6.3304e-01, PNorm = 42.9595, GNorm = 1.8930, lr_0 = 5.4901e-04
Loss = 7.2487e-01, PNorm = 42.9648, GNorm = 4.2086, lr_0 = 5.2750e-04
Validation rmse = 0.576731
Epoch 13
Loss = 6.6775e-01, PNorm = 42.9738, GNorm = 3.2056, lr_0 = 5.0683e-04
Validation rmse = 0.572470
Epoch 14
Loss = 6.7671e-01, PNorm = 42.9822, GNorm = 5.4024, lr_0 = 4.8309e-04
Validation rmse = 0.582456
Epoch 15
Loss = 6.9123e-01, PNorm = 42.9907, GNorm = 4.3484, lr_0 = 4.6416e-04
Validation rmse = 0.572216
Epoch 16
Loss = 6.9538e-01, PNorm = 42.9991, GNorm = 1.8054, lr_0 = 4.4242e-04
Loss = 6.3154e-01, PNorm = 43.0087, GNorm = 1.5925, lr_0 = 4.2508e-04
Validation rmse = 0.541308
Epoch 17
Loss = 6.3984e-01, PNorm = 43.0156, GNorm = 1.6484, lr_0 = 4.0842e-04
Validation rmse = 0.546549
Epoch 18
Loss = 5.6626e-01, PNorm = 43.0243, GNorm = 1.7038, lr_0 = 3.8929e-04
Validation rmse = 0.530527
Epoch 19
Loss = 6.6410e-01, PNorm = 43.0309, GNorm = 0.8371, lr_0 = 3.7404e-04
Loss = 5.9479e-01, PNorm = 43.0364, GNorm = 0.9600, lr_0 = 3.5938e-04
Loss = 5.6317e-01, PNorm = 43.0375, GNorm = 0.8070, lr_0 = 3.5652e-04
Validation rmse = 0.540658
Epoch 20
Loss = 6.1110e-01, PNorm = 43.0438, GNorm = 0.7230, lr_0 = 3.4255e-04
Validation rmse = 0.527473
Epoch 21
Loss = 5.3560e-01, PNorm = 43.0494, GNorm = 1.7630, lr_0 = 3.2913e-04
Validation rmse = 0.523255
Epoch 22
Loss = 6.0813e-01, PNorm = 43.0576, GNorm = 3.2511, lr_0 = 3.1371e-04
Loss = 5.6227e-01, PNorm = 43.0629, GNorm = 2.3973, lr_0 = 3.0142e-04
Validation rmse = 0.549969
Epoch 23
Loss = 5.9956e-01, PNorm = 43.0689, GNorm = 2.4572, lr_0 = 2.8960e-04
Validation rmse = 0.529292
Epoch 24
Loss = 6.0218e-01, PNorm = 43.0747, GNorm = 2.8582, lr_0 = 2.7604e-04
Validation rmse = 0.524658
Epoch 25
Loss = 5.2732e-01, PNorm = 43.0803, GNorm = 5.2927, lr_0 = 2.6522e-04
Loss = 5.7755e-01, PNorm = 43.0850, GNorm = 1.7692, lr_0 = 2.5483e-04
Validation rmse = 0.546885
Epoch 26
Loss = 5.9812e-01, PNorm = 43.0904, GNorm = 2.4465, lr_0 = 2.4484e-04
Validation rmse = 0.523644
Epoch 27
Loss = 5.7309e-01, PNorm = 43.0955, GNorm = 1.5962, lr_0 = 2.3338e-04
Validation rmse = 0.526208
Epoch 28
Loss = 5.9665e-01, PNorm = 43.1006, GNorm = 1.9923, lr_0 = 2.2423e-04
Validation rmse = 0.539433
Epoch 29
Loss = 6.3180e-01, PNorm = 43.1058, GNorm = 2.2887, lr_0 = 2.1373e-04
Loss = 5.3454e-01, PNorm = 43.1104, GNorm = 1.4275, lr_0 = 2.0535e-04
Validation rmse = 0.527102
Epoch 30
Loss = 5.5445e-01, PNorm = 43.1144, GNorm = 0.8838, lr_0 = 1.9731e-04
Validation rmse = 0.529186
Epoch 31
Loss = 5.6988e-01, PNorm = 43.1197, GNorm = 2.6175, lr_0 = 1.8806e-04
Validation rmse = 0.545395
Epoch 32
Loss = 4.9118e-01, PNorm = 43.1230, GNorm = 1.7402, lr_0 = 1.8069e-04
Loss = 5.5315e-01, PNorm = 43.1271, GNorm = 0.7330, lr_0 = 1.7361e-04
Loss = 5.5098e-01, PNorm = 43.1279, GNorm = 2.6310, lr_0 = 1.7223e-04
Validation rmse = 0.519772
Epoch 33
Loss = 5.3335e-01, PNorm = 43.1310, GNorm = 1.1168, lr_0 = 1.6548e-04
Validation rmse = 0.535221
Epoch 34
Loss = 4.7155e-01, PNorm = 43.1346, GNorm = 0.7808, lr_0 = 1.5900e-04
Validation rmse = 0.520897
Epoch 35
Loss = 5.0443e-01, PNorm = 43.1387, GNorm = 2.1982, lr_0 = 1.5155e-04
Loss = 5.4549e-01, PNorm = 43.1416, GNorm = 1.6303, lr_0 = 1.4561e-04
Validation rmse = 0.531003
Epoch 36
Loss = 5.1545e-01, PNorm = 43.1448, GNorm = 1.3373, lr_0 = 1.3991e-04
Validation rmse = 0.525894
Epoch 37
Loss = 5.4889e-01, PNorm = 43.1485, GNorm = 2.5997, lr_0 = 1.3335e-04
Validation rmse = 0.528008
Epoch 38
Loss = 5.8404e-01, PNorm = 43.1517, GNorm = 1.4672, lr_0 = 1.2813e-04
Loss = 4.6764e-01, PNorm = 43.1542, GNorm = 1.7870, lr_0 = 1.2311e-04
Validation rmse = 0.535250
Epoch 39
Loss = 5.1803e-01, PNorm = 43.1568, GNorm = 2.5695, lr_0 = 1.1828e-04
Validation rmse = 0.520174
Epoch 40
Loss = 5.5957e-01, PNorm = 43.1597, GNorm = 2.4125, lr_0 = 1.1274e-04
Validation rmse = 0.537906
Epoch 41
Loss = 5.1380e-01, PNorm = 43.1618, GNorm = 3.5538, lr_0 = 1.0832e-04
Validation rmse = 0.522305
Epoch 42
Loss = 4.6612e-01, PNorm = 43.1649, GNorm = 0.6162, lr_0 = 1.0325e-04
Loss = 5.3045e-01, PNorm = 43.1671, GNorm = 2.7144, lr_0 = 1.0000e-04
Validation rmse = 0.530968
Epoch 43
Loss = 4.8267e-01, PNorm = 43.1695, GNorm = 0.9048, lr_0 = 1.0000e-04
Validation rmse = 0.527451
Epoch 44
Loss = 5.2771e-01, PNorm = 43.1721, GNorm = 1.1108, lr_0 = 1.0000e-04
Validation rmse = 0.531686
Epoch 45
Loss = 5.6795e-01, PNorm = 43.1744, GNorm = 0.7244, lr_0 = 1.0000e-04
Loss = 5.0998e-01, PNorm = 43.1766, GNorm = 1.4807, lr_0 = 1.0000e-04
Loss = 4.9791e-01, PNorm = 43.1770, GNorm = 1.9456, lr_0 = 1.0000e-04
Validation rmse = 0.534025
Epoch 46
Loss = 5.0025e-01, PNorm = 43.1791, GNorm = 1.2396, lr_0 = 1.0000e-04
Validation rmse = 0.529248
Epoch 47
Loss = 4.7258e-01, PNorm = 43.1815, GNorm = 2.2470, lr_0 = 1.0000e-04
Validation rmse = 0.534954
Epoch 48
Loss = 5.9952e-01, PNorm = 43.1842, GNorm = 2.1324, lr_0 = 1.0000e-04
Loss = 4.4780e-01, PNorm = 43.1861, GNorm = 2.9743, lr_0 = 1.0000e-04
Validation rmse = 0.530928
Epoch 49
Loss = 5.1201e-01, PNorm = 43.1884, GNorm = 0.8031, lr_0 = 1.0000e-04
Validation rmse = 0.522019
Model 0 best validation rmse = 0.519772 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.573976
Ensemble test rmse = 0.573976
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.744915
Epoch 2
Loss = 8.6485e-01, PNorm = 42.7545, GNorm = 0.6917, lr_0 = 9.6081e-04
Validation rmse = 0.732367
Epoch 3
Loss = 9.2638e-01, PNorm = 42.7904, GNorm = 0.6258, lr_0 = 9.1581e-04
Loss = 9.7448e-01, PNorm = 42.8142, GNorm = 0.7180, lr_0 = 8.7992e-04
Validation rmse = 0.725324
Epoch 4
Loss = 9.2228e-01, PNorm = 42.8367, GNorm = 1.6641, lr_0 = 8.4544e-04
Validation rmse = 0.762112
Epoch 5
Loss = 8.0916e-01, PNorm = 42.8623, GNorm = 0.9734, lr_0 = 8.0584e-04
Validation rmse = 0.721074
Epoch 6
Loss = 9.2603e-01, PNorm = 42.8767, GNorm = 2.0749, lr_0 = 7.7426e-04
Loss = 7.4940e-01, PNorm = 42.8903, GNorm = 0.9793, lr_0 = 7.4392e-04
Loss = 6.2840e-01, PNorm = 42.8929, GNorm = 1.9568, lr_0 = 7.3800e-04
Validation rmse = 0.687455
Epoch 7
Loss = 7.0840e-01, PNorm = 42.9061, GNorm = 0.9054, lr_0 = 7.0908e-04
Validation rmse = 0.658955
Epoch 8
Loss = 6.9844e-01, PNorm = 42.9191, GNorm = 1.9106, lr_0 = 6.8129e-04
Validation rmse = 0.631478
Epoch 9
Loss = 6.5425e-01, PNorm = 42.9324, GNorm = 3.6529, lr_0 = 6.4938e-04
Loss = 7.1557e-01, PNorm = 42.9419, GNorm = 3.2294, lr_0 = 6.2393e-04
Validation rmse = 0.631343
Epoch 10
Loss = 6.1029e-01, PNorm = 42.9529, GNorm = 2.0958, lr_0 = 5.9948e-04
Validation rmse = 0.610010
Epoch 11
Loss = 6.5629e-01, PNorm = 42.9652, GNorm = 3.3576, lr_0 = 5.7141e-04
Validation rmse = 0.600151
Epoch 12
Loss = 5.6302e-01, PNorm = 42.9744, GNorm = 2.8485, lr_0 = 5.4901e-04
Loss = 6.6416e-01, PNorm = 42.9830, GNorm = 1.3063, lr_0 = 5.2750e-04
Validation rmse = 0.624658
Epoch 13
Loss = 6.0087e-01, PNorm = 42.9910, GNorm = 1.6155, lr_0 = 5.0683e-04
Validation rmse = 0.607558
Epoch 14
Loss = 5.9920e-01, PNorm = 43.0023, GNorm = 0.7370, lr_0 = 4.8309e-04
Validation rmse = 0.607923
Epoch 15
Loss = 6.7088e-01, PNorm = 43.0098, GNorm = 1.6087, lr_0 = 4.6416e-04
Validation rmse = 0.636262
Epoch 16
Loss = 6.5013e-01, PNorm = 43.0170, GNorm = 1.9773, lr_0 = 4.4242e-04
Loss = 5.8322e-01, PNorm = 43.0236, GNorm = 1.6343, lr_0 = 4.2508e-04
Validation rmse = 0.623467
Epoch 17
Loss = 5.8470e-01, PNorm = 43.0322, GNorm = 1.6330, lr_0 = 4.0842e-04
Validation rmse = 0.657007
Epoch 18
Loss = 6.1292e-01, PNorm = 43.0394, GNorm = 9.3172, lr_0 = 3.8929e-04
Validation rmse = 0.669399
Epoch 19
Loss = 6.7034e-01, PNorm = 43.0440, GNorm = 4.4544, lr_0 = 3.7404e-04
Loss = 5.6277e-01, PNorm = 43.0511, GNorm = 2.9011, lr_0 = 3.5938e-04
Loss = 6.9208e-01, PNorm = 43.0522, GNorm = 1.3345, lr_0 = 3.5652e-04
Validation rmse = 0.604930
Epoch 20
Loss = 5.7462e-01, PNorm = 43.0588, GNorm = 1.2109, lr_0 = 3.4255e-04
Validation rmse = 0.593561
Epoch 21
Loss = 5.4640e-01, PNorm = 43.0649, GNorm = 1.1005, lr_0 = 3.2913e-04
Validation rmse = 0.626237
Epoch 22
Loss = 5.4987e-01, PNorm = 43.0717, GNorm = 1.9241, lr_0 = 3.1371e-04
Loss = 5.7394e-01, PNorm = 43.0770, GNorm = 3.8550, lr_0 = 3.0142e-04
Validation rmse = 0.575768
Epoch 23
Loss = 5.5935e-01, PNorm = 43.0810, GNorm = 2.3430, lr_0 = 2.8960e-04
Validation rmse = 0.629664
Epoch 24
Loss = 5.5560e-01, PNorm = 43.0879, GNorm = 5.2356, lr_0 = 2.7604e-04
Validation rmse = 0.624438
Epoch 25
Loss = 5.9518e-01, PNorm = 43.0929, GNorm = 1.4844, lr_0 = 2.6522e-04
Loss = 5.6730e-01, PNorm = 43.0961, GNorm = 2.4505, lr_0 = 2.5483e-04
Validation rmse = 0.704078
Epoch 26
Loss = 5.4380e-01, PNorm = 43.1012, GNorm = 2.6582, lr_0 = 2.4484e-04
Validation rmse = 0.569677
Epoch 27
Loss = 5.5253e-01, PNorm = 43.1055, GNorm = 0.6798, lr_0 = 2.3338e-04
Validation rmse = 0.634141
Epoch 28
Loss = 4.4589e-01, PNorm = 43.1104, GNorm = 0.9508, lr_0 = 2.2423e-04
Validation rmse = 0.590835
Epoch 29
Loss = 5.2982e-01, PNorm = 43.1157, GNorm = 3.9613, lr_0 = 2.1373e-04
Loss = 5.1816e-01, PNorm = 43.1198, GNorm = 4.2249, lr_0 = 2.0535e-04
Validation rmse = 0.599278
Epoch 30
Loss = 5.3731e-01, PNorm = 43.1241, GNorm = 2.8107, lr_0 = 1.9731e-04
Validation rmse = 0.628205
Epoch 31
Loss = 5.5646e-01, PNorm = 43.1282, GNorm = 1.6970, lr_0 = 1.8806e-04
Validation rmse = 0.593188
Epoch 32
Loss = 5.1063e-01, PNorm = 43.1316, GNorm = 1.3246, lr_0 = 1.8069e-04
Loss = 5.2553e-01, PNorm = 43.1350, GNorm = 1.3521, lr_0 = 1.7361e-04
Loss = 4.5026e-01, PNorm = 43.1357, GNorm = 3.1461, lr_0 = 1.7223e-04
Validation rmse = 0.598117
Epoch 33
Loss = 5.0467e-01, PNorm = 43.1391, GNorm = 1.6715, lr_0 = 1.6548e-04
Validation rmse = 0.617019
Epoch 34
Loss = 5.2009e-01, PNorm = 43.1429, GNorm = 1.2471, lr_0 = 1.5900e-04
Validation rmse = 0.621699
Epoch 35
Loss = 5.1403e-01, PNorm = 43.1465, GNorm = 1.9909, lr_0 = 1.5155e-04
Loss = 4.9599e-01, PNorm = 43.1498, GNorm = 3.6385, lr_0 = 1.4561e-04
Validation rmse = 0.588037
Epoch 36
Loss = 4.8274e-01, PNorm = 43.1523, GNorm = 3.0823, lr_0 = 1.3991e-04
Validation rmse = 0.633785
Epoch 37
Loss = 5.2309e-01, PNorm = 43.1556, GNorm = 0.8905, lr_0 = 1.3335e-04
Validation rmse = 0.587100
Epoch 38
Loss = 5.1740e-01, PNorm = 43.1584, GNorm = 0.9766, lr_0 = 1.2813e-04
Loss = 4.8160e-01, PNorm = 43.1611, GNorm = 1.4618, lr_0 = 1.2311e-04
Validation rmse = 0.617883
Epoch 39
Loss = 4.8034e-01, PNorm = 43.1639, GNorm = 3.7272, lr_0 = 1.1828e-04
Validation rmse = 0.609135
Epoch 40
Loss = 5.2349e-01, PNorm = 43.1667, GNorm = 5.1198, lr_0 = 1.1274e-04
Validation rmse = 0.598291
Epoch 41
Loss = 4.8324e-01, PNorm = 43.1689, GNorm = 3.4337, lr_0 = 1.0832e-04
Validation rmse = 0.605704
Epoch 42
Loss = 4.9115e-01, PNorm = 43.1716, GNorm = 2.0709, lr_0 = 1.0325e-04
Loss = 5.1568e-01, PNorm = 43.1738, GNorm = 3.0564, lr_0 = 1.0000e-04
Validation rmse = 0.612977
Epoch 43
Loss = 4.9672e-01, PNorm = 43.1759, GNorm = 1.2460, lr_0 = 1.0000e-04
Validation rmse = 0.611327
Epoch 44
Loss = 4.4809e-01, PNorm = 43.1784, GNorm = 2.5257, lr_0 = 1.0000e-04
Validation rmse = 0.594959
Epoch 45
Loss = 4.4266e-01, PNorm = 43.1807, GNorm = 2.0488, lr_0 = 1.0000e-04
Loss = 4.9858e-01, PNorm = 43.1828, GNorm = 2.5104, lr_0 = 1.0000e-04
Loss = 4.9950e-01, PNorm = 43.1832, GNorm = 1.6182, lr_0 = 1.0000e-04
Validation rmse = 0.608081
Epoch 46
Loss = 4.7206e-01, PNorm = 43.1854, GNorm = 0.9393, lr_0 = 1.0000e-04
Validation rmse = 0.606950
Epoch 47
Loss = 4.8574e-01, PNorm = 43.1875, GNorm = 1.1287, lr_0 = 1.0000e-04
Validation rmse = 0.597271
Epoch 48
Loss = 5.0658e-01, PNorm = 43.1902, GNorm = 3.3686, lr_0 = 1.0000e-04
Loss = 4.6359e-01, PNorm = 43.1922, GNorm = 2.2969, lr_0 = 1.0000e-04
Validation rmse = 0.615465
Epoch 49
Loss = 4.6613e-01, PNorm = 43.1944, GNorm = 6.8586, lr_0 = 1.0000e-04
Validation rmse = 0.595283
Model 0 best validation rmse = 0.569677 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.531520
Ensemble test rmse = 0.531520
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732175
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7520, GNorm = 0.8329, lr_0 = 9.6081e-04
Validation rmse = 0.725436
Epoch 3
Loss = 9.6696e-01, PNorm = 42.7875, GNorm = 0.8183, lr_0 = 9.1581e-04
Loss = 9.3853e-01, PNorm = 42.8129, GNorm = 0.9191, lr_0 = 8.7992e-04
Validation rmse = 0.690701
Epoch 4
Loss = 8.9802e-01, PNorm = 42.8346, GNorm = 1.1266, lr_0 = 8.4544e-04
Validation rmse = 0.676597
Epoch 5
Loss = 8.6211e-01, PNorm = 42.8598, GNorm = 1.1236, lr_0 = 8.0584e-04
Validation rmse = 0.655937
Epoch 6
Loss = 7.3475e-01, PNorm = 42.8790, GNorm = 1.2896, lr_0 = 7.7426e-04
Loss = 7.3972e-01, PNorm = 42.8942, GNorm = 2.6156, lr_0 = 7.4392e-04
Loss = 7.7591e-01, PNorm = 42.8966, GNorm = 2.6759, lr_0 = 7.3800e-04
Validation rmse = 0.636719
Epoch 7
Loss = 7.4942e-01, PNorm = 42.9097, GNorm = 4.4558, lr_0 = 7.0908e-04
Validation rmse = 0.659499
Epoch 8
Loss = 6.5145e-01, PNorm = 42.9224, GNorm = 2.2730, lr_0 = 6.8129e-04
Validation rmse = 0.592910
Epoch 9
Loss = 6.4793e-01, PNorm = 42.9377, GNorm = 3.6997, lr_0 = 6.4938e-04
Loss = 6.8406e-01, PNorm = 42.9484, GNorm = 2.4550, lr_0 = 6.2393e-04
Validation rmse = 0.568382
Epoch 10
Loss = 6.6599e-01, PNorm = 42.9584, GNorm = 4.5140, lr_0 = 5.9948e-04
Validation rmse = 0.590685
Epoch 11
Loss = 6.5184e-01, PNorm = 42.9687, GNorm = 3.0642, lr_0 = 5.7141e-04
Validation rmse = 0.572547
Epoch 12
Loss = 6.5654e-01, PNorm = 42.9771, GNorm = 0.9257, lr_0 = 5.4901e-04
Loss = 6.5488e-01, PNorm = 42.9871, GNorm = 1.4509, lr_0 = 5.2750e-04
Validation rmse = 0.565147
Epoch 13
Loss = 6.5751e-01, PNorm = 42.9952, GNorm = 1.6383, lr_0 = 5.0683e-04
Validation rmse = 0.643280
Epoch 14
Loss = 6.2841e-01, PNorm = 43.0068, GNorm = 1.5261, lr_0 = 4.8309e-04
Validation rmse = 0.561856
Epoch 15
Loss = 6.5803e-01, PNorm = 43.0157, GNorm = 1.0248, lr_0 = 4.6416e-04
Validation rmse = 0.565974
Epoch 16
Loss = 6.1076e-01, PNorm = 43.0273, GNorm = 1.2640, lr_0 = 4.4242e-04
Loss = 6.1596e-01, PNorm = 43.0337, GNorm = 0.7078, lr_0 = 4.2508e-04
Validation rmse = 0.630033
Epoch 17
Loss = 5.9758e-01, PNorm = 43.0420, GNorm = 2.0359, lr_0 = 4.0842e-04
Validation rmse = 0.568126
Epoch 18
Loss = 5.5112e-01, PNorm = 43.0501, GNorm = 0.7489, lr_0 = 3.8929e-04
Validation rmse = 0.570189
Epoch 19
Loss = 6.1209e-01, PNorm = 43.0585, GNorm = 1.1376, lr_0 = 3.7404e-04
Loss = 5.7680e-01, PNorm = 43.0659, GNorm = 0.9443, lr_0 = 3.5938e-04
Loss = 4.8164e-01, PNorm = 43.0672, GNorm = 1.9283, lr_0 = 3.5652e-04
Validation rmse = 0.552606
Epoch 20
Loss = 5.8503e-01, PNorm = 43.0728, GNorm = 0.8926, lr_0 = 3.4255e-04
Validation rmse = 0.569776
Epoch 21
Loss = 5.9390e-01, PNorm = 43.0797, GNorm = 3.3916, lr_0 = 3.2913e-04
Validation rmse = 0.580423
Epoch 22
Loss = 5.1376e-01, PNorm = 43.0875, GNorm = 1.0813, lr_0 = 3.1371e-04
Loss = 5.5968e-01, PNorm = 43.0941, GNorm = 2.8590, lr_0 = 3.0142e-04
Validation rmse = 0.560026
Epoch 23
Loss = 5.1388e-01, PNorm = 43.1003, GNorm = 2.4130, lr_0 = 2.8960e-04
Validation rmse = 0.525615
Epoch 24
Loss = 5.3432e-01, PNorm = 43.1078, GNorm = 2.9767, lr_0 = 2.7604e-04
Validation rmse = 0.560131
Epoch 25
Loss = 5.2424e-01, PNorm = 43.1147, GNorm = 0.8224, lr_0 = 2.6522e-04
Loss = 5.3469e-01, PNorm = 43.1207, GNorm = 1.7745, lr_0 = 2.5483e-04
Validation rmse = 0.577160
Epoch 26
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-b43f099e-d291-457c-9693-29f974983f57.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715428
Epoch 2
Loss = 8.0470e-01, PNorm = 42.7511, GNorm = 0.7403, lr_0 = 9.6081e-04
Validation rmse = 0.707724
Epoch 3
Loss = 8.5218e-01, PNorm = 42.7845, GNorm = 0.8345, lr_0 = 9.1581e-04
Loss = 9.8716e-01, PNorm = 42.8072, GNorm = 1.0967, lr_0 = 8.7992e-04
Validation rmse = 0.682377
Epoch 4
Loss = 9.3868e-01, PNorm = 42.8287, GNorm = 0.7124, lr_0 = 8.4544e-04
Validation rmse = 0.643952
Epoch 5
Loss = 7.8700e-01, PNorm = 42.8538, GNorm = 0.8321, lr_0 = 8.0584e-04
Validation rmse = 0.621464
Epoch 6
Loss = 7.2425e-01, PNorm = 42.8740, GNorm = 1.2316, lr_0 = 7.7426e-04
Loss = 7.6944e-01, PNorm = 42.8914, GNorm = 3.6430, lr_0 = 7.4392e-04
Loss = 8.3177e-01, PNorm = 42.8940, GNorm = 1.9631, lr_0 = 7.3800e-04
Validation rmse = 0.611985
Epoch 7
Loss = 7.2520e-01, PNorm = 42.9051, GNorm = 3.8268, lr_0 = 7.0908e-04
Validation rmse = 0.593673
Epoch 8
Loss = 6.9420e-01, PNorm = 42.9169, GNorm = 2.0557, lr_0 = 6.8129e-04
Validation rmse = 0.603795
Epoch 9
Loss = 6.5729e-01, PNorm = 42.9319, GNorm = 1.8476, lr_0 = 6.4938e-04
Loss = 6.6250e-01, PNorm = 42.9428, GNorm = 5.9652, lr_0 = 6.2393e-04
Validation rmse = 0.627030
Epoch 10
Loss = 6.3767e-01, PNorm = 42.9509, GNorm = 7.4064, lr_0 = 5.9948e-04
Validation rmse = 0.609701
Epoch 11
Loss = 6.8265e-01, PNorm = 42.9579, GNorm = 0.8366, lr_0 = 5.7141e-04
Validation rmse = 0.578364
Epoch 12
Loss = 6.7506e-01, PNorm = 42.9654, GNorm = 0.8450, lr_0 = 5.4901e-04
Loss = 6.5360e-01, PNorm = 42.9758, GNorm = 1.5181, lr_0 = 5.2750e-04
Validation rmse = 0.595749
Epoch 13
Loss = 6.5460e-01, PNorm = 42.9845, GNorm = 2.6990, lr_0 = 5.0683e-04
Validation rmse = 0.583494
Epoch 14
Loss = 6.7414e-01, PNorm = 42.9944, GNorm = 4.0631, lr_0 = 4.8309e-04
Validation rmse = 0.588445
Epoch 15
Loss = 5.6812e-01, PNorm = 43.0004, GNorm = 4.7747, lr_0 = 4.6416e-04
Validation rmse = 0.566447
Epoch 16
Loss = 6.4410e-01, PNorm = 43.0071, GNorm = 2.2309, lr_0 = 4.4242e-04
Loss = 6.1837e-01, PNorm = 43.0143, GNorm = 1.5162, lr_0 = 4.2508e-04
Validation rmse = 0.577991
Epoch 17
Loss = 5.7222e-01, PNorm = 43.0208, GNorm = 0.8120, lr_0 = 4.0842e-04
Validation rmse = 0.572175
Epoch 18
Loss = 4.9129e-01, PNorm = 43.0294, GNorm = 0.6802, lr_0 = 3.8929e-04
Validation rmse = 0.561993
Epoch 19
Loss = 6.1194e-01, PNorm = 43.0357, GNorm = 1.4579, lr_0 = 3.7404e-04
Loss = 5.8762e-01, PNorm = 43.0430, GNorm = 1.8799, lr_0 = 3.5938e-04
Loss = 7.9552e-01, PNorm = 43.0441, GNorm = 5.6805, lr_0 = 3.5652e-04
Validation rmse = 0.589406
Epoch 20
Loss = 5.8092e-01, PNorm = 43.0479, GNorm = 3.1521, lr_0 = 3.4255e-04
Validation rmse = 0.567041
Epoch 21
Loss = 5.3800e-01, PNorm = 43.0543, GNorm = 0.8935, lr_0 = 3.2913e-04
Validation rmse = 0.556743
Epoch 22
Loss = 6.0893e-01, PNorm = 43.0607, GNorm = 4.6159, lr_0 = 3.1371e-04
Loss = 5.2362e-01, PNorm = 43.0671, GNorm = 1.3602, lr_0 = 3.0142e-04
Validation rmse = 0.561430
Epoch 23
Loss = 5.8316e-01, PNorm = 43.0722, GNorm = 1.1697, lr_0 = 2.8960e-04
Validation rmse = 0.577356
Epoch 24
Loss = 5.4694e-01, PNorm = 43.0789, GNorm = 1.8599, lr_0 = 2.7604e-04
Validation rmse = 0.564905
Epoch 25
Loss = 5.7970e-01, PNorm = 43.0844, GNorm = 0.8631, lr_0 = 2.6522e-04
Loss = 5.3776e-01, PNorm = 43.0889, GNorm = 1.1021, lr_0 = 2.5483e-04
Validation rmse = 0.574223
Epoch 26
Loss = 5.4713e-01, PNorm = 43.0939, GNorm = 1.3857, lr_0 = 2.4484e-04
Validation rmse = 0.558112
Epoch 27
Loss = 5.8598e-01, PNorm = 43.0990, GNorm = 2.0705, lr_0 = 2.3338e-04
Validation rmse = 0.566323
Epoch 28
Loss = 4.9446e-01, PNorm = 43.1027, GNorm = 5.1450, lr_0 = 2.2423e-04
Validation rmse = 0.559486
Epoch 29
Loss = 4.8991e-01, PNorm = 43.1074, GNorm = 3.1827, lr_0 = 2.1373e-04
Loss = 5.5363e-01, PNorm = 43.1110, GNorm = 0.8950, lr_0 = 2.0535e-04
Validation rmse = 0.560240
Epoch 30
Loss = 5.1193e-01, PNorm = 43.1150, GNorm = 1.7071, lr_0 = 1.9731e-04
Validation rmse = 0.558462
Epoch 31
Loss = 5.1452e-01, PNorm = 43.1200, GNorm = 3.8862, lr_0 = 1.8806e-04
Validation rmse = 0.569437
Epoch 32
Loss = 5.6899e-01, PNorm = 43.1238, GNorm = 3.5975, lr_0 = 1.8069e-04
Loss = 5.0646e-01, PNorm = 43.1276, GNorm = 0.9401, lr_0 = 1.7361e-04
Loss = 5.5674e-01, PNorm = 43.1282, GNorm = 5.2906, lr_0 = 1.7223e-04
Validation rmse = 0.564932
Epoch 33
Loss = 5.3275e-01, PNorm = 43.1315, GNorm = 2.0579, lr_0 = 1.6548e-04
Validation rmse = 0.557440
Epoch 34
Loss = 4.7139e-01, PNorm = 43.1346, GNorm = 3.4663, lr_0 = 1.5900e-04
Validation rmse = 0.558906
Epoch 35
Loss = 5.2989e-01, PNorm = 43.1386, GNorm = 4.1664, lr_0 = 1.5155e-04
Loss = 4.7476e-01, PNorm = 43.1414, GNorm = 2.9065, lr_0 = 1.4561e-04
Validation rmse = 0.563319
Epoch 36
Loss = 4.9772e-01, PNorm = 43.1447, GNorm = 3.7442, lr_0 = 1.3991e-04
Validation rmse = 0.563336
Epoch 37
Loss = 5.5534e-01, PNorm = 43.1482, GNorm = 2.7444, lr_0 = 1.3335e-04
Validation rmse = 0.583908
Epoch 38
Loss = 5.2870e-01, PNorm = 43.1507, GNorm = 3.9643, lr_0 = 1.2813e-04
Loss = 5.3348e-01, PNorm = 43.1534, GNorm = 2.8061, lr_0 = 1.2311e-04
Validation rmse = 0.560037
Epoch 39
Loss = 5.0813e-01, PNorm = 43.1550, GNorm = 1.8508, lr_0 = 1.1828e-04
Validation rmse = 0.563303
Epoch 40
Loss = 5.1284e-01, PNorm = 43.1582, GNorm = 1.1284, lr_0 = 1.1274e-04
Validation rmse = 0.552070
Epoch 41
Loss = 5.4818e-01, PNorm = 43.1605, GNorm = 0.7870, lr_0 = 1.0832e-04
Validation rmse = 0.565203
Epoch 42
Loss = 5.1586e-01, PNorm = 43.1633, GNorm = 3.4882, lr_0 = 1.0325e-04
Loss = 4.7938e-01, PNorm = 43.1659, GNorm = 2.4709, lr_0 = 1.0000e-04
Validation rmse = 0.562598
Epoch 43
Loss = 4.7321e-01, PNorm = 43.1674, GNorm = 3.5288, lr_0 = 1.0000e-04
Validation rmse = 0.568006
Epoch 44
Loss = 4.6907e-01, PNorm = 43.1699, GNorm = 1.0523, lr_0 = 1.0000e-04
Validation rmse = 0.554128
Epoch 45
Loss = 4.8075e-01, PNorm = 43.1722, GNorm = 1.8755, lr_0 = 1.0000e-04
Loss = 5.2424e-01, PNorm = 43.1739, GNorm = 5.6489, lr_0 = 1.0000e-04
Loss = 3.6971e-01, PNorm = 43.1743, GNorm = 4.4004, lr_0 = 1.0000e-04
Validation rmse = 0.561272
Epoch 46
Loss = 5.0686e-01, PNorm = 43.1767, GNorm = 6.1700, lr_0 = 1.0000e-04
Validation rmse = 0.551847
Epoch 47
Loss = 4.5478e-01, PNorm = 43.1786, GNorm = 2.4554, lr_0 = 1.0000e-04
Validation rmse = 0.559788
Epoch 48
Loss = 4.5685e-01, PNorm = 43.1816, GNorm = 1.6674, lr_0 = 1.0000e-04
Loss = 4.9320e-01, PNorm = 43.1837, GNorm = 1.9811, lr_0 = 1.0000e-04
Validation rmse = 0.562831
Epoch 49
Loss = 5.2424e-01, PNorm = 43.1857, GNorm = 1.6787, lr_0 = 1.0000e-04
Validation rmse = 0.554206
Model 0 best validation rmse = 0.551847 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.512859
Ensemble test rmse = 0.512859
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.696990
Epoch 2
Loss = 1.0447e+00, PNorm = 42.7500, GNorm = 1.2388, lr_0 = 9.6081e-04
Validation rmse = 0.692277
Epoch 3
Loss = 8.9254e-01, PNorm = 42.7829, GNorm = 1.5975, lr_0 = 9.1581e-04
Loss = 9.9338e-01, PNorm = 42.8038, GNorm = 0.8217, lr_0 = 8.7992e-04
Validation rmse = 0.674967
Epoch 4
Loss = 9.7613e-01, PNorm = 42.8216, GNorm = 0.7748, lr_0 = 8.4544e-04
Validation rmse = 0.662272
Epoch 5
Loss = 7.8577e-01, PNorm = 42.8409, GNorm = 1.4517, lr_0 = 8.0584e-04
Validation rmse = 0.621103
Epoch 6
Loss = 8.7162e-01, PNorm = 42.8582, GNorm = 1.7258, lr_0 = 7.7426e-04
Loss = 7.9467e-01, PNorm = 42.8765, GNorm = 1.0621, lr_0 = 7.4392e-04
Loss = 7.7843e-01, PNorm = 42.8803, GNorm = 3.1518, lr_0 = 7.3800e-04
Validation rmse = 0.587920
Epoch 7
Loss = 7.5921e-01, PNorm = 42.8951, GNorm = 0.8871, lr_0 = 7.0908e-04
Validation rmse = 0.585541
Epoch 8
Loss = 7.7772e-01, PNorm = 42.9053, GNorm = 2.9853, lr_0 = 6.8129e-04
Validation rmse = 0.582299
Epoch 9
Loss = 7.0291e-01, PNorm = 42.9159, GNorm = 2.9786, lr_0 = 6.4938e-04
Loss = 7.4704e-01, PNorm = 42.9253, GNorm = 3.2116, lr_0 = 6.2393e-04
Validation rmse = 0.575011
Epoch 10
Loss = 6.5459e-01, PNorm = 42.9372, GNorm = 1.2224, lr_0 = 5.9948e-04
Validation rmse = 0.557648
Epoch 11
Loss = 6.7359e-01, PNorm = 42.9503, GNorm = 1.6368, lr_0 = 5.7141e-04
Validation rmse = 0.560364
Epoch 12
Loss = 6.3304e-01, PNorm = 42.9595, GNorm = 1.8930, lr_0 = 5.4901e-04
Loss = 7.2487e-01, PNorm = 42.9648, GNorm = 4.2086, lr_0 = 5.2750e-04
Validation rmse = 0.576731
Epoch 13
Loss = 6.6775e-01, PNorm = 42.9738, GNorm = 3.2056, lr_0 = 5.0683e-04
Validation rmse = 0.572470
Epoch 14
Loss = 6.7671e-01, PNorm = 42.9822, GNorm = 5.4024, lr_0 = 4.8309e-04
Validation rmse = 0.582456
Epoch 15
Loss = 6.9123e-01, PNorm = 42.9907, GNorm = 4.3484, lr_0 = 4.6416e-04
Validation rmse = 0.572216
Epoch 16
Loss = 6.9538e-01, PNorm = 42.9991, GNorm = 1.8054, lr_0 = 4.4242e-04
Loss = 6.3154e-01, PNorm = 43.0087, GNorm = 1.5925, lr_0 = 4.2508e-04
Validation rmse = 0.541308
Epoch 17
Loss = 6.3984e-01, PNorm = 43.0156, GNorm = 1.6484, lr_0 = 4.0842e-04
Validation rmse = 0.546549
Epoch 18
Loss = 5.6626e-01, PNorm = 43.0243, GNorm = 1.7038, lr_0 = 3.8929e-04
Validation rmse = 0.530527
Epoch 19
Loss = 6.6410e-01, PNorm = 43.0309, GNorm = 0.8371, lr_0 = 3.7404e-04
Loss = 5.9479e-01, PNorm = 43.0364, GNorm = 0.9600, lr_0 = 3.5938e-04
Loss = 5.6317e-01, PNorm = 43.0375, GNorm = 0.8070, lr_0 = 3.5652e-04
Validation rmse = 0.540658
Epoch 20
Loss = 6.1110e-01, PNorm = 43.0438, GNorm = 0.7230, lr_0 = 3.4255e-04
Validation rmse = 0.527473
Epoch 21
Loss = 5.3560e-01, PNorm = 43.0494, GNorm = 1.7630, lr_0 = 3.2913e-04
Validation rmse = 0.523255
Epoch 22
Loss = 6.0813e-01, PNorm = 43.0576, GNorm = 3.2511, lr_0 = 3.1371e-04
Loss = 5.6227e-01, PNorm = 43.0629, GNorm = 2.3973, lr_0 = 3.0142e-04
Validation rmse = 0.549969
Epoch 23
Loss = 5.9956e-01, PNorm = 43.0689, GNorm = 2.4572, lr_0 = 2.8960e-04
Validation rmse = 0.529292
Epoch 24
Loss = 6.0218e-01, PNorm = 43.0747, GNorm = 2.8582, lr_0 = 2.7604e-04
Validation rmse = 0.524658
Epoch 25
Loss = 5.2732e-01, PNorm = 43.0803, GNorm = 5.2927, lr_0 = 2.6522e-04
Loss = 5.7755e-01, PNorm = 43.0850, GNorm = 1.7692, lr_0 = 2.5483e-04
Validation rmse = 0.546885
Epoch 26
Loss = 5.9812e-01, PNorm = 43.0904, GNorm = 2.4465, lr_0 = 2.4484e-04
Validation rmse = 0.523644
Epoch 27
Loss = 5.7309e-01, PNorm = 43.0955, GNorm = 1.5962, lr_0 = 2.3338e-04
Validation rmse = 0.526208
Epoch 28
Loss = 5.9665e-01, PNorm = 43.1006, GNorm = 1.9923, lr_0 = 2.2423e-04
Validation rmse = 0.539433
Epoch 29
Loss = 6.3180e-01, PNorm = 43.1058, GNorm = 2.2887, lr_0 = 2.1373e-04
Loss = 5.3454e-01, PNorm = 43.1104, GNorm = 1.4275, lr_0 = 2.0535e-04
Validation rmse = 0.527102
Epoch 30
Loss = 5.5445e-01, PNorm = 43.1144, GNorm = 0.8838, lr_0 = 1.9731e-04
Validation rmse = 0.529186
Epoch 31
Loss = 5.6988e-01, PNorm = 43.1197, GNorm = 2.6175, lr_0 = 1.8806e-04
Validation rmse = 0.545395
Epoch 32
Loss = 4.9118e-01, PNorm = 43.1230, GNorm = 1.7402, lr_0 = 1.8069e-04
Loss = 5.5315e-01, PNorm = 43.1271, GNorm = 0.7330, lr_0 = 1.7361e-04
Loss = 5.5098e-01, PNorm = 43.1279, GNorm = 2.6310, lr_0 = 1.7223e-04
Validation rmse = 0.519772
Epoch 33
Loss = 5.3335e-01, PNorm = 43.1310, GNorm = 1.1168, lr_0 = 1.6548e-04
Validation rmse = 0.535221
Epoch 34
Loss = 4.7155e-01, PNorm = 43.1346, GNorm = 0.7808, lr_0 = 1.5900e-04
Validation rmse = 0.520897
Epoch 35
Loss = 5.0443e-01, PNorm = 43.1387, GNorm = 2.1982, lr_0 = 1.5155e-04
Loss = 5.4549e-01, PNorm = 43.1416, GNorm = 1.6303, lr_0 = 1.4561e-04
Validation rmse = 0.531003
Epoch 36
Loss = 5.1545e-01, PNorm = 43.1448, GNorm = 1.3373, lr_0 = 1.3991e-04
Validation rmse = 0.525894
Epoch 37
Loss = 5.4889e-01, PNorm = 43.1485, GNorm = 2.5997, lr_0 = 1.3335e-04
Validation rmse = 0.528008
Epoch 38
Loss = 5.8404e-01, PNorm = 43.1517, GNorm = 1.4672, lr_0 = 1.2813e-04
Loss = 4.6764e-01, PNorm = 43.1542, GNorm = 1.7870, lr_0 = 1.2311e-04
Validation rmse = 0.535250
Epoch 39
Loss = 5.1803e-01, PNorm = 43.1568, GNorm = 2.5695, lr_0 = 1.1828e-04
Validation rmse = 0.520174
Epoch 40
Loss = 5.5957e-01, PNorm = 43.1597, GNorm = 2.4125, lr_0 = 1.1274e-04
Validation rmse = 0.537906
Epoch 41
Loss = 5.1380e-01, PNorm = 43.1618, GNorm = 3.5538, lr_0 = 1.0832e-04
Validation rmse = 0.522305
Epoch 42
Loss = 4.6612e-01, PNorm = 43.1649, GNorm = 0.6162, lr_0 = 1.0325e-04
Loss = 5.3045e-01, PNorm = 43.1671, GNorm = 2.7144, lr_0 = 1.0000e-04
Validation rmse = 0.530968
Epoch 43
Loss = 4.8267e-01, PNorm = 43.1695, GNorm = 0.9048, lr_0 = 1.0000e-04
Validation rmse = 0.527451
Epoch 44
Loss = 5.2771e-01, PNorm = 43.1721, GNorm = 1.1108, lr_0 = 1.0000e-04
Validation rmse = 0.531686
Epoch 45
Loss = 5.6795e-01, PNorm = 43.1744, GNorm = 0.7244, lr_0 = 1.0000e-04
Loss = 5.0998e-01, PNorm = 43.1766, GNorm = 1.4807, lr_0 = 1.0000e-04
Loss = 4.9791e-01, PNorm = 43.1770, GNorm = 1.9456, lr_0 = 1.0000e-04
Validation rmse = 0.534025
Epoch 46
Loss = 5.0025e-01, PNorm = 43.1791, GNorm = 1.2396, lr_0 = 1.0000e-04
Validation rmse = 0.529248
Epoch 47
Loss = 4.7258e-01, PNorm = 43.1815, GNorm = 2.2470, lr_0 = 1.0000e-04
Validation rmse = 0.534954
Epoch 48
Loss = 5.9952e-01, PNorm = 43.1842, GNorm = 2.1324, lr_0 = 1.0000e-04
Loss = 4.4780e-01, PNorm = 43.1861, GNorm = 2.9743, lr_0 = 1.0000e-04
Validation rmse = 0.530928
Epoch 49
Loss = 5.1201e-01, PNorm = 43.1884, GNorm = 0.8031, lr_0 = 1.0000e-04
Validation rmse = 0.522019
Model 0 best validation rmse = 0.519772 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.573976
Ensemble test rmse = 0.573976
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.744915
Epoch 2
Loss = 8.6485e-01, PNorm = 42.7545, GNorm = 0.6917, lr_0 = 9.6081e-04
Validation rmse = 0.732367
Epoch 3
Loss = 9.2638e-01, PNorm = 42.7904, GNorm = 0.6258, lr_0 = 9.1581e-04
Loss = 9.7448e-01, PNorm = 42.8142, GNorm = 0.7180, lr_0 = 8.7992e-04
Validation rmse = 0.725324
Epoch 4
Loss = 9.2228e-01, PNorm = 42.8367, GNorm = 1.6641, lr_0 = 8.4544e-04
Validation rmse = 0.762112
Epoch 5
Loss = 8.0916e-01, PNorm = 42.8623, GNorm = 0.9734, lr_0 = 8.0584e-04
Validation rmse = 0.721074
Epoch 6
Loss = 9.2603e-01, PNorm = 42.8767, GNorm = 2.0749, lr_0 = 7.7426e-04
Loss = 7.4940e-01, PNorm = 42.8903, GNorm = 0.9793, lr_0 = 7.4392e-04
Loss = 6.2840e-01, PNorm = 42.8929, GNorm = 1.9568, lr_0 = 7.3800e-04
Validation rmse = 0.687455
Epoch 7
Loss = 7.0840e-01, PNorm = 42.9061, GNorm = 0.9054, lr_0 = 7.0908e-04
Validation rmse = 0.658955
Epoch 8
Loss = 6.9844e-01, PNorm = 42.9191, GNorm = 1.9106, lr_0 = 6.8129e-04
Validation rmse = 0.631478
Epoch 9
Loss = 6.5425e-01, PNorm = 42.9324, GNorm = 3.6529, lr_0 = 6.4938e-04
Loss = 7.1557e-01, PNorm = 42.9419, GNorm = 3.2294, lr_0 = 6.2393e-04
Validation rmse = 0.631343
Epoch 10
Loss = 6.1029e-01, PNorm = 42.9529, GNorm = 2.0958, lr_0 = 5.9948e-04
Validation rmse = 0.610010
Epoch 11
Loss = 6.5629e-01, PNorm = 42.9652, GNorm = 3.3576, lr_0 = 5.7141e-04
Validation rmse = 0.600151
Epoch 12
Loss = 5.6302e-01, PNorm = 42.9744, GNorm = 2.8485, lr_0 = 5.4901e-04
Loss = 6.6416e-01, PNorm = 42.9830, GNorm = 1.3063, lr_0 = 5.2750e-04
Validation rmse = 0.624658
Epoch 13
Loss = 6.0087e-01, PNorm = 42.9910, GNorm = 1.6155, lr_0 = 5.0683e-04
Validation rmse = 0.607558
Epoch 14
Loss = 5.9920e-01, PNorm = 43.0023, GNorm = 0.7370, lr_0 = 4.8309e-04
Validation rmse = 0.607923
Epoch 15
Loss = 6.7088e-01, PNorm = 43.0098, GNorm = 1.6087, lr_0 = 4.6416e-04
Validation rmse = 0.636262
Epoch 16
Loss = 6.5013e-01, PNorm = 43.0170, GNorm = 1.9773, lr_0 = 4.4242e-04
Loss = 5.8322e-01, PNorm = 43.0236, GNorm = 1.6343, lr_0 = 4.2508e-04
Validation rmse = 0.623467
Epoch 17
Loss = 5.8470e-01, PNorm = 43.0322, GNorm = 1.6330, lr_0 = 4.0842e-04
Validation rmse = 0.657007
Epoch 18
Loss = 6.1292e-01, PNorm = 43.0394, GNorm = 9.3172, lr_0 = 3.8929e-04
Validation rmse = 0.669399
Epoch 19
Loss = 6.7034e-01, PNorm = 43.0440, GNorm = 4.4544, lr_0 = 3.7404e-04
Loss = 5.6277e-01, PNorm = 43.0511, GNorm = 2.9011, lr_0 = 3.5938e-04
Loss = 6.9208e-01, PNorm = 43.0522, GNorm = 1.3345, lr_0 = 3.5652e-04
Validation rmse = 0.604930
Epoch 20
Loss = 5.7462e-01, PNorm = 43.0588, GNorm = 1.2109, lr_0 = 3.4255e-04
Validation rmse = 0.593561
Epoch 21
Loss = 5.4640e-01, PNorm = 43.0649, GNorm = 1.1005, lr_0 = 3.2913e-04
Validation rmse = 0.626237
Epoch 22
Loss = 5.4987e-01, PNorm = 43.0717, GNorm = 1.9241, lr_0 = 3.1371e-04
Loss = 5.7394e-01, PNorm = 43.0770, GNorm = 3.8550, lr_0 = 3.0142e-04
Validation rmse = 0.575768
Epoch 23
Loss = 5.5935e-01, PNorm = 43.0810, GNorm = 2.3430, lr_0 = 2.8960e-04
Validation rmse = 0.629664
Epoch 24
Loss = 5.5560e-01, PNorm = 43.0879, GNorm = 5.2356, lr_0 = 2.7604e-04
Validation rmse = 0.624438
Epoch 25
Loss = 5.9518e-01, PNorm = 43.0929, GNorm = 1.4844, lr_0 = 2.6522e-04
Loss = 5.6730e-01, PNorm = 43.0961, GNorm = 2.4505, lr_0 = 2.5483e-04
Validation rmse = 0.704078
Epoch 26
Loss = 5.4380e-01, PNorm = 43.1012, GNorm = 2.6582, lr_0 = 2.4484e-04
Validation rmse = 0.569677
Epoch 27
Loss = 5.5253e-01, PNorm = 43.1055, GNorm = 0.6798, lr_0 = 2.3338e-04
Validation rmse = 0.634141
Epoch 28
Loss = 4.4589e-01, PNorm = 43.1104, GNorm = 0.9508, lr_0 = 2.2423e-04
Validation rmse = 0.590835
Epoch 29
Loss = 5.2982e-01, PNorm = 43.1157, GNorm = 3.9613, lr_0 = 2.1373e-04
Loss = 5.1816e-01, PNorm = 43.1198, GNorm = 4.2249, lr_0 = 2.0535e-04
Validation rmse = 0.599278
Epoch 30
Loss = 5.3731e-01, PNorm = 43.1241, GNorm = 2.8107, lr_0 = 1.9731e-04
Validation rmse = 0.628205
Epoch 31
Loss = 5.5646e-01, PNorm = 43.1282, GNorm = 1.6970, lr_0 = 1.8806e-04
Validation rmse = 0.593188
Epoch 32
Loss = 5.1063e-01, PNorm = 43.1316, GNorm = 1.3246, lr_0 = 1.8069e-04
Loss = 5.2553e-01, PNorm = 43.1350, GNorm = 1.3521, lr_0 = 1.7361e-04
Loss = 4.5026e-01, PNorm = 43.1357, GNorm = 3.1461, lr_0 = 1.7223e-04
Validation rmse = 0.598117
Epoch 33
Loss = 5.0467e-01, PNorm = 43.1391, GNorm = 1.6715, lr_0 = 1.6548e-04
Validation rmse = 0.617019
Epoch 34
Loss = 5.2009e-01, PNorm = 43.1429, GNorm = 1.2471, lr_0 = 1.5900e-04
Validation rmse = 0.621699
Epoch 35
Loss = 5.1403e-01, PNorm = 43.1465, GNorm = 1.9909, lr_0 = 1.5155e-04
Loss = 4.9599e-01, PNorm = 43.1498, GNorm = 3.6385, lr_0 = 1.4561e-04
Validation rmse = 0.588037
Epoch 36
Loss = 4.8274e-01, PNorm = 43.1523, GNorm = 3.0823, lr_0 = 1.3991e-04
Validation rmse = 0.633785
Epoch 37
Loss = 5.2309e-01, PNorm = 43.1556, GNorm = 0.8905, lr_0 = 1.3335e-04
Validation rmse = 0.587100
Epoch 38
Loss = 5.1740e-01, PNorm = 43.1584, GNorm = 0.9766, lr_0 = 1.2813e-04
Loss = 4.8160e-01, PNorm = 43.1611, GNorm = 1.4618, lr_0 = 1.2311e-04
Validation rmse = 0.617883
Epoch 39
Loss = 4.8034e-01, PNorm = 43.1639, GNorm = 3.7272, lr_0 = 1.1828e-04
Validation rmse = 0.609135
Epoch 40
Loss = 5.2349e-01, PNorm = 43.1667, GNorm = 5.1198, lr_0 = 1.1274e-04
Validation rmse = 0.598291
Epoch 41
Loss = 4.8324e-01, PNorm = 43.1689, GNorm = 3.4337, lr_0 = 1.0832e-04
Validation rmse = 0.605704
Epoch 42
Loss = 4.9115e-01, PNorm = 43.1716, GNorm = 2.0709, lr_0 = 1.0325e-04
Loss = 5.1568e-01, PNorm = 43.1738, GNorm = 3.0564, lr_0 = 1.0000e-04
Validation rmse = 0.612977
Epoch 43
Loss = 4.9672e-01, PNorm = 43.1759, GNorm = 1.2460, lr_0 = 1.0000e-04
Validation rmse = 0.611327
Epoch 44
Loss = 4.4809e-01, PNorm = 43.1784, GNorm = 2.5257, lr_0 = 1.0000e-04
Validation rmse = 0.594959
Epoch 45
Loss = 4.4266e-01, PNorm = 43.1807, GNorm = 2.0488, lr_0 = 1.0000e-04
Loss = 4.9858e-01, PNorm = 43.1828, GNorm = 2.5104, lr_0 = 1.0000e-04
Loss = 4.9950e-01, PNorm = 43.1832, GNorm = 1.6182, lr_0 = 1.0000e-04
Validation rmse = 0.608081
Epoch 46
Loss = 4.7206e-01, PNorm = 43.1854, GNorm = 0.9393, lr_0 = 1.0000e-04
Validation rmse = 0.606950
Epoch 47
Loss = 4.8574e-01, PNorm = 43.1875, GNorm = 1.1287, lr_0 = 1.0000e-04
Validation rmse = 0.597271
Epoch 48
Loss = 5.0658e-01, PNorm = 43.1902, GNorm = 3.3686, lr_0 = 1.0000e-04
Loss = 4.6359e-01, PNorm = 43.1922, GNorm = 2.2969, lr_0 = 1.0000e-04
Validation rmse = 0.615465
Epoch 49
Loss = 4.6613e-01, PNorm = 43.1944, GNorm = 6.8586, lr_0 = 1.0000e-04
Validation rmse = 0.595283
Model 0 best validation rmse = 0.569677 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.531520
Ensemble test rmse = 0.531520
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732175
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7520, GNorm = 0.8329, lr_0 = 9.6081e-04
Validation rmse = 0.725436
Epoch 3
Loss = 9.6696e-01, PNorm = 42.7875, GNorm = 0.8183, lr_0 = 9.1581e-04
Loss = 9.3853e-01, PNorm = 42.8129, GNorm = 0.9191, lr_0 = 8.7992e-04
Validation rmse = 0.690701
Epoch 4
Loss = 8.9802e-01, PNorm = 42.8346, GNorm = 1.1266, lr_0 = 8.4544e-04
Validation rmse = 0.676597
Epoch 5
Loss = 8.6211e-01, PNorm = 42.8598, GNorm = 1.1236, lr_0 = 8.0584e-04
Validation rmse = 0.655937
Epoch 6
Loss = 7.3475e-01, PNorm = 42.8790, GNorm = 1.2896, lr_0 = 7.7426e-04
Loss = 7.3972e-01, PNorm = 42.8942, GNorm = 2.6156, lr_0 = 7.4392e-04
Loss = 7.7591e-01, PNorm = 42.8966, GNorm = 2.6759, lr_0 = 7.3800e-04
Validation rmse = 0.636719
Epoch 7
Loss = 7.4942e-01, PNorm = 42.9097, GNorm = 4.4558, lr_0 = 7.0908e-04
Validation rmse = 0.659499
Epoch 8
Loss = 6.5145e-01, PNorm = 42.9224, GNorm = 2.2730, lr_0 = 6.8129e-04
Validation rmse = 0.592910
Epoch 9
Loss = 6.4793e-01, PNorm = 42.9377, GNorm = 3.6997, lr_0 = 6.4938e-04
Loss = 6.8406e-01, PNorm = 42.9484, GNorm = 2.4550, lr_0 = 6.2393e-04
Validation rmse = 0.568382
Epoch 10
Loss = 6.6599e-01, PNorm = 42.9584, GNorm = 4.5140, lr_0 = 5.9948e-04
Validation rmse = 0.590685
Epoch 11
Loss = 6.5184e-01, PNorm = 42.9687, GNorm = 3.0642, lr_0 = 5.7141e-04
Validation rmse = 0.572547
Epoch 12
Loss = 6.5654e-01, PNorm = 42.9771, GNorm = 0.9257, lr_0 = 5.4901e-04
Loss = 6.5488e-01, PNorm = 42.9871, GNorm = 1.4509, lr_0 = 5.2750e-04
Validation rmse = 0.565147
Epoch 13
Loss = 6.5751e-01, PNorm = 42.9952, GNorm = 1.6383, lr_0 = 5.0683e-04
Validation rmse = 0.643280
Epoch 14
Loss = 6.2841e-01, PNorm = 43.0068, GNorm = 1.5261, lr_0 = 4.8309e-04
Validation rmse = 0.561856
Epoch 15
Loss = 6.5803e-01, PNorm = 43.0157, GNorm = 1.0248, lr_0 = 4.6416e-04
Validation rmse = 0.565974
Epoch 16
Loss = 6.1076e-01, PNorm = 43.0273, GNorm = 1.2640, lr_0 = 4.4242e-04
Loss = 6.1596e-01, PNorm = 43.0337, GNorm = 0.7078, lr_0 = 4.2508e-04
Validation rmse = 0.630033
Epoch 17
Loss = 5.9758e-01, PNorm = 43.0420, GNorm = 2.0359, lr_0 = 4.0842e-04
Validation rmse = 0.568126
Epoch 18
Loss = 5.5112e-01, PNorm = 43.0501, GNorm = 0.7489, lr_0 = 3.8929e-04
Validation rmse = 0.570189
Epoch 19
Loss = 6.1209e-01, PNorm = 43.0585, GNorm = 1.1376, lr_0 = 3.7404e-04
Loss = 5.7680e-01, PNorm = 43.0659, GNorm = 0.9443, lr_0 = 3.5938e-04
Loss = 4.8164e-01, PNorm = 43.0672, GNorm = 1.9283, lr_0 = 3.5652e-04
Validation rmse = 0.552606
Epoch 20
Loss = 5.8503e-01, PNorm = 43.0728, GNorm = 0.8926, lr_0 = 3.4255e-04
Validation rmse = 0.569776
Epoch 21
Loss = 5.9390e-01, PNorm = 43.0797, GNorm = 3.3916, lr_0 = 3.2913e-04
Validation rmse = 0.580423
Epoch 22
Loss = 5.1376e-01, PNorm = 43.0875, GNorm = 1.0813, lr_0 = 3.1371e-04
Loss = 5.5968e-01, PNorm = 43.0941, GNorm = 2.8590, lr_0 = 3.0142e-04
Validation rmse = 0.560026
Epoch 23
Loss = 5.1388e-01, PNorm = 43.1003, GNorm = 2.4130, lr_0 = 2.8960e-04
Validation rmse = 0.525615
Epoch 24
Loss = 5.3432e-01, PNorm = 43.1078, GNorm = 2.9767, lr_0 = 2.7604e-04
Validation rmse = 0.560131
Epoch 25
Loss = 5.2424e-01, PNorm = 43.1147, GNorm = 0.8224, lr_0 = 2.6522e-04
Loss = 5.3469e-01, PNorm = 43.1207, GNorm = 1.7745, lr_0 = 2.5483e-04
Validation rmse = 0.577160
Epoch 26
Loss = 5.3834e-01, PNorm = 43.1269, GNorm = 1.1777, lr_0 = 2.4484e-04
Validation rmse = 0.538220
Epoch 27
Loss = 5.5429e-01, PNorm = 43.1336, GNorm = 2.4374, lr_0 = 2.3338e-04
Validation rmse = 0.558620
Epoch 28
Loss = 5.4999e-01, PNorm = 43.1391, GNorm = 2.1939, lr_0 = 2.2423e-04
Validation rmse = 0.608195
Epoch 29
Loss = 4.9182e-01, PNorm = 43.1442, GNorm = 2.3960, lr_0 = 2.1373e-04
Loss = 5.0673e-01, PNorm = 43.1495, GNorm = 1.1828, lr_0 = 2.0535e-04
Validation rmse = 0.531119
Epoch 30
Loss = 5.0208e-01, PNorm = 43.1532, GNorm = 2.1018, lr_0 = 1.9731e-04
Validation rmse = 0.529228
Epoch 31
Loss = 5.6733e-01, PNorm = 43.1591, GNorm = 6.6215, lr_0 = 1.8806e-04
Validation rmse = 0.597578
Epoch 32
Loss = 5.0459e-01, PNorm = 43.1628, GNorm = 2.7386, lr_0 = 1.8069e-04
Loss = 5.0013e-01, PNorm = 43.1674, GNorm = 2.7041, lr_0 = 1.7361e-04
Loss = 5.7654e-01, PNorm = 43.1683, GNorm = 1.6364, lr_0 = 1.7223e-04
Validation rmse = 0.519444
Epoch 33
Loss = 5.3161e-01, PNorm = 43.1719, GNorm = 6.3019, lr_0 = 1.6548e-04
Validation rmse = 0.558917
Epoch 34
Loss = 5.5324e-01, PNorm = 43.1760, GNorm = 0.9523, lr_0 = 1.5900e-04
Validation rmse = 0.551702
Epoch 35
Loss = 5.0424e-01, PNorm = 43.1802, GNorm = 1.9967, lr_0 = 1.5155e-04
Loss = 4.9707e-01, PNorm = 43.1836, GNorm = 2.6951, lr_0 = 1.4561e-04
Validation rmse = 0.539288
Epoch 36
Loss = 4.8725e-01, PNorm = 43.1863, GNorm = 1.2030, lr_0 = 1.3991e-04
Validation rmse = 0.541334
Epoch 37
Loss = 4.6935e-01, PNorm = 43.1900, GNorm = 1.6318, lr_0 = 1.3335e-04
Validation rmse = 0.575766
Epoch 38
Loss = 4.8709e-01, PNorm = 43.1929, GNorm = 1.5381, lr_0 = 1.2813e-04
Loss = 4.9534e-01, PNorm = 43.1960, GNorm = 1.7026, lr_0 = 1.2311e-04
Validation rmse = 0.555365
Epoch 39
Loss = 4.7482e-01, PNorm = 43.1986, GNorm = 3.6698, lr_0 = 1.1828e-04
Validation rmse = 0.531889
Epoch 40
Loss = 4.4314e-01, PNorm = 43.2018, GNorm = 1.6739, lr_0 = 1.1274e-04
Validation rmse = 0.567735
Epoch 41
Loss = 5.1341e-01, PNorm = 43.2044, GNorm = 0.9104, lr_0 = 1.0832e-04
Validation rmse = 0.554929
Epoch 42
Loss = 4.7737e-01, PNorm = 43.2070, GNorm = 4.2479, lr_0 = 1.0325e-04
Loss = 4.8630e-01, PNorm = 43.2092, GNorm = 1.6810, lr_0 = 1.0000e-04
Validation rmse = 0.525583
Epoch 43
Loss = 4.8539e-01, PNorm = 43.2116, GNorm = 3.3688, lr_0 = 1.0000e-04
Validation rmse = 0.579186
Epoch 44
Loss = 5.1356e-01, PNorm = 43.2138, GNorm = 3.5476, lr_0 = 1.0000e-04
Validation rmse = 0.532182
Epoch 45
Loss = 5.1604e-01, PNorm = 43.2165, GNorm = 4.5321, lr_0 = 1.0000e-04
Loss = 4.7332e-01, PNorm = 43.2186, GNorm = 1.7756, lr_0 = 1.0000e-04
Loss = 4.3928e-01, PNorm = 43.2191, GNorm = 3.1335, lr_0 = 1.0000e-04
Validation rmse = 0.551464
Epoch 46
Loss = 4.7051e-01, PNorm = 43.2213, GNorm = 1.2073, lr_0 = 1.0000e-04
Validation rmse = 0.545521
Epoch 47
Loss = 4.2038e-01, PNorm = 43.2235, GNorm = 1.4983, lr_0 = 1.0000e-04
Validation rmse = 0.548369
Epoch 48
Loss = 4.5087e-01, PNorm = 43.2263, GNorm = 1.0292, lr_0 = 1.0000e-04
Loss = 4.7395e-01, PNorm = 43.2288, GNorm = 3.9539, lr_0 = 1.0000e-04
Validation rmse = 0.533480
Epoch 49
Loss = 4.5950e-01, PNorm = 43.2307, GNorm = 2.6961, lr_0 = 1.0000e-04
Validation rmse = 0.539725
Model 0 best validation rmse = 0.519444 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.475291
Ensemble test rmse = 0.475291
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.6854e+00, PNorm = 42.6832, GNorm = 6.5055, lr_0 = 7.5000e-04
Validation rmse = 0.779950
Epoch 1
Loss = 1.0715e+00, PNorm = 42.7188, GNorm = 1.6002, lr_0 = 1.0000e-03
Validation rmse = 0.764412
Epoch 2
Loss = 9.2667e-01, PNorm = 42.7535, GNorm = 0.9784, lr_0 = 9.6081e-04
Validation rmse = 0.742779
Epoch 3
Loss = 9.2276e-01, PNorm = 42.7873, GNorm = 0.7816, lr_0 = 9.1581e-04
Loss = 9.6840e-01, PNorm = 42.8103, GNorm = 0.7806, lr_0 = 8.7992e-04
Validation rmse = 0.738063
Epoch 4
Loss = 9.0325e-01, PNorm = 42.8311, GNorm = 0.7982, lr_0 = 8.4544e-04
Validation rmse = 0.687609
Epoch 5
Loss = 9.3018e-01, PNorm = 42.8556, GNorm = 2.0777, lr_0 = 8.0584e-04
Validation rmse = 0.744201
Epoch 6
Loss = 7.7005e-01, PNorm = 42.8733, GNorm = 3.8007, lr_0 = 7.7426e-04
Loss = 8.2223e-01, PNorm = 42.8874, GNorm = 3.3249, lr_0 = 7.4392e-04
Loss = 1.0001e+00, PNorm = 42.8901, GNorm = 4.4107, lr_0 = 7.3800e-04
Validation rmse = 0.697079
Epoch 7
Loss = 8.1545e-01, PNorm = 42.9039, GNorm = 3.7575, lr_0 = 7.0908e-04
Validation rmse = 0.666133
Epoch 8
Loss = 7.7399e-01, PNorm = 42.9156, GNorm = 2.1042, lr_0 = 6.8129e-04
Validation rmse = 0.601339
Epoch 9
Loss = 6.9724e-01, PNorm = 42.9319, GNorm = 1.9748, lr_0 = 6.4938e-04
Loss = 7.4098e-01, PNorm = 42.9437, GNorm = 1.4287, lr_0 = 6.2393e-04
Validation rmse = 0.632894
Epoch 10
Loss = 7.0405e-01, PNorm = 42.9561, GNorm = 1.5701, lr_0 = 5.9948e-04
Validation rmse = 0.597565
Epoch 11
Loss = 6.5673e-01, PNorm = 42.9691, GNorm = 0.7748, lr_0 = 5.7141e-04
Validation rmse = 0.583754
Epoch 12
Loss = 5.5007e-01, PNorm = 42.9802, GNorm = 1.2046, lr_0 = 5.4901e-04
Loss = 6.8826e-01, PNorm = 42.9898, GNorm = 2.6975, lr_0 = 5.2750e-04
Validation rmse = 0.628635
Epoch 13
Loss = 6.1374e-01, PNorm = 42.9999, GNorm = 0.7025, lr_0 = 5.0683e-04
Validation rmse = 0.573072
Epoch 14
Loss = 6.7469e-01, PNorm = 43.0108, GNorm = 1.0798, lr_0 = 4.8309e-04
Validation rmse = 0.558508
Epoch 15
Loss = 6.6599e-01, PNorm = 43.0205, GNorm = 1.1265, lr_0 = 4.6416e-04
Validation rmse = 0.562863
Epoch 16
Loss = 5.7521e-01, PNorm = 43.0308, GNorm = 0.9522, lr_0 = 4.4242e-04
Loss = 6.2677e-01, PNorm = 43.0375, GNorm = 4.0305, lr_0 = 4.2508e-04
Validation rmse = 0.578486
Epoch 17
Loss = 5.8752e-01, PNorm = 43.0452, GNorm = 5.0322, lr_0 = 4.0842e-04
Validation rmse = 0.591303
Epoch 18
Loss = 5.9017e-01, PNorm = 43.0553, GNorm = 2.6869, lr_0 = 3.8929e-04
Validation rmse = 0.599849
Epoch 19
Loss = 6.5140e-01, PNorm = 43.0626, GNorm = 1.2006, lr_0 = 3.7404e-04
Loss = 5.6357e-01, PNorm = 43.0702, GNorm = 1.6717, lr_0 = 3.5938e-04
Loss = 5.3875e-01, PNorm = 43.0712, GNorm = 1.4281, lr_0 = 3.5652e-04
Validation rmse = 0.584882
Epoch 20
Loss = 6.0273e-01, PNorm = 43.0783, GNorm = 1.3053, lr_0 = 3.4255e-04
Validation rmse = 0.546698
Epoch 21
Loss = 5.7297e-01, PNorm = 43.0854, GNorm = 1.2976, lr_0 = 3.2913e-04
Validation rmse = 0.557707
Epoch 22
Loss = 5.2579e-01, PNorm = 43.0944, GNorm = 1.5474, lr_0 = 3.1371e-04
Loss = 5.7106e-01, PNorm = 43.1005, GNorm = 1.6075, lr_0 = 3.0142e-04
Validation rmse = 0.598279
Epoch 23
Loss = 5.6258e-01, PNorm = 43.1074, GNorm = 0.9945, lr_0 = 2.8960e-04
Validation rmse = 0.555931
Epoch 24
Loss = 5.7231e-01, PNorm = 43.1134, GNorm = 3.3388, lr_0 = 2.7604e-04
Validation rmse = 0.543168
Epoch 25
Loss = 5.4927e-01, PNorm = 43.1197, GNorm = 3.1962, lr_0 = 2.6522e-04
Loss = 5.4379e-01, PNorm = 43.1246, GNorm = 2.2911, lr_0 = 2.5483e-04
Validation rmse = 0.600341
Epoch 26
Loss = 5.5119e-01, PNorm = 43.1305, GNorm = 1.8715, lr_0 = 2.4484e-04
Validation rmse = 0.554880
Epoch 27
Loss = 5.3268e-01, PNorm = 43.1360, GNorm = 4.5075, lr_0 = 2.3338e-04
Validation rmse = 0.538111
Epoch 28
Loss = 5.9010e-01, PNorm = 43.1411, GNorm = 3.8050, lr_0 = 2.2423e-04
Validation rmse = 0.592506
Epoch 29
Loss = 5.4657e-01, PNorm = 43.1461, GNorm = 3.8382, lr_0 = 2.1373e-04
Loss = 5.2947e-01, PNorm = 43.1506, GNorm = 1.1686, lr_0 = 2.0535e-04
Validation rmse = 0.543419
Epoch 30
Loss = 5.5368e-01, PNorm = 43.1542, GNorm = 1.0444, lr_0 = 1.9731e-04
Validation rmse = 0.578961
Epoch 31
Loss = 5.0484e-01, PNorm = 43.1585, GNorm = 1.7343, lr_0 = 1.8806e-04
Validation rmse = 0.541218
Epoch 32
Loss = 4.9651e-01, PNorm = 43.1623, GNorm = 4.0503, lr_0 = 1.8069e-04
Loss = 5.3948e-01, PNorm = 43.1658, GNorm = 1.6292, lr_0 = 1.7361e-04
Loss = 5.6296e-01, PNorm = 43.1669, GNorm = 1.2944, lr_0 = 1.7223e-04
Validation rmse = 0.528782
Epoch 33
Loss = 4.9984e-01, PNorm = 43.1704, GNorm = 1.6379, lr_0 = 1.6548e-04
Validation rmse = 0.614149
Epoch 34
Loss = 5.6957e-01, PNorm = 43.1738, GNorm = 4.8285, lr_0 = 1.5900e-04
Validation rmse = 0.521788
Epoch 35
Loss = 4.4401e-01, PNorm = 43.1780, GNorm = 3.9923, lr_0 = 1.5155e-04
Loss = 5.6902e-01, PNorm = 43.1807, GNorm = 5.3522, lr_0 = 1.4561e-04
Validation rmse = 0.577418
Epoch 36
Loss = 4.8539e-01, PNorm = 43.1842, GNorm = 1.9202, lr_0 = 1.3991e-04
Validation rmse = 0.545207
Epoch 37
Loss = 4.8691e-01, PNorm = 43.1872, GNorm = 2.1152, lr_0 = 1.3335e-04
Validation rmse = 0.548507
Epoch 38
Loss = 4.5917e-01, PNorm = 43.1902, GNorm = 1.3240, lr_0 = 1.2813e-04
Loss = 5.1416e-01, PNorm = 43.1928, GNorm = 3.7745, lr_0 = 1.2311e-04
Validation rmse = 0.562560
Epoch 39
Loss = 4.5512e-01, PNorm = 43.1955, GNorm = 1.3439, lr_0 = 1.1828e-04
Validation rmse = 0.538482
Epoch 40
Loss = 4.8009e-01, PNorm = 43.1981, GNorm = 2.6546, lr_0 = 1.1274e-04
Validation rmse = 0.562587
Epoch 41
Loss = 4.3450e-01, PNorm = 43.2006, GNorm = 1.5779, lr_0 = 1.0832e-04
Validation rmse = 0.547256
Epoch 42
Loss = 4.5320e-01, PNorm = 43.2032, GNorm = 1.7799, lr_0 = 1.0325e-04
Loss = 4.8529e-01, PNorm = 43.2054, GNorm = 4.5397, lr_0 = 1.0000e-04
Validation rmse = 0.553555
Epoch 43
Loss = 5.0543e-01, PNorm = 43.2083, GNorm = 7.2797, lr_0 = 1.0000e-04
Validation rmse = 0.571098
Epoch 44
Loss = 4.7033e-01, PNorm = 43.2100, GNorm = 4.0006, lr_0 = 1.0000e-04
Validation rmse = 0.535141
Epoch 45
Loss = 5.8062e-01, PNorm = 43.2128, GNorm = 2.5373, lr_0 = 1.0000e-04
Loss = 4.9333e-01, PNorm = 43.2144, GNorm = 3.2010, lr_0 = 1.0000e-04
Loss = 5.5284e-01, PNorm = 43.2146, GNorm = 1.9812, lr_0 = 1.0000e-04
Validation rmse = 0.563674
Epoch 46
Loss = 5.1197e-01, PNorm = 43.2164, GNorm = 5.6722, lr_0 = 1.0000e-04
Validation rmse = 0.547070
Epoch 47
Loss = 4.7590e-01, PNorm = 43.2193, GNorm = 3.0388, lr_0 = 1.0000e-04
Validation rmse = 0.537789
Epoch 48
Loss = 5.1578e-01, PNorm = 43.2212, GNorm = 1.3849, lr_0 = 1.0000e-04
Loss = 4.9813e-01, PNorm = 43.2234, GNorm = 1.4909, lr_0 = 1.0000e-04
Validation rmse = 0.573864
Epoch 49
Loss = 4.6626e-01, PNorm = 43.2259, GNorm = 2.0195, lr_0 = 1.0000e-04
Validation rmse = 0.525440
Model 0 best validation rmse = 0.521788 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.567819
Ensemble test rmse = 0.567819
5-fold cross validation
	Seed 0 ==> test rmse = 0.512859
	Seed 1 ==> test rmse = 0.573976
	Seed 2 ==> test rmse = 0.531520
	Seed 3 ==> test rmse = 0.475291
	Seed 4 ==> test rmse = 0.567819
Overall test rmse = 0.532293 +/- 0.036406
Elapsed time = 0:47:37
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
Namespace(data_path='/content/drive/MyDrive/BBB dataset/df.csv', dataset_type='regression', save_dir='/content/drive/MyDrive/BBB dataset/test_checkpoints_reg', epochs=37, batch_size=77, hidden_size=491, depth=7, dropout=0.4438954890457819, init_lr=0.003333389777460861, max_lr=0.001164876200920602, log_frequency=5, num_folds=5, quiet='false', seed=42, smiles_columns='smiles', target_columns='target', ignore_columns='', task_names='target')
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
Namespace(data_path='/content/drive/MyDrive/BBB dataset/df.csv', dataset_type='regression', save_dir='/content/drive/MyDrive/BBB dataset/test_checkpoints_reg', epochs=42, batch_size=83, hidden_size=499, depth=6, dropout=0.4428891809818992, init_lr=5.961611989222032e-05, max_lr=0.0005988755930171658, log_frequency=5, num_folds=5, quiet='false', seed=42, smiles_columns='smiles', target_columns='target', ignore_columns='', task_names='target')
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
Namespace(data_path='/content/drive/MyDrive/BBB dataset/df.csv', dataset_type='regression', save_dir='/content/drive/MyDrive/BBB dataset/test_checkpoints_reg', epochs=43, batch_size=37, hidden_size=413, depth=4, dropout=0.31808805333950074, init_lr=0.0013832927393883218, max_lr=0.00012090249600333407, log_frequency=5, num_folds=5, quiet='true', seed=42, smiles_columns='smiles', target_columns='target', ignore_columns='', task_names='target')
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715447
Epoch 2
Loss = 8.0487e-01, PNorm = 42.7507, GNorm = 0.7394, lr_0 = 9.3377e-04
Validation rmse = 0.708588
Epoch 3
Loss = 8.5113e-01, PNorm = 42.7825, GNorm = 0.8180, lr_0 = 8.6005e-04
Loss = 9.8843e-01, PNorm = 42.8032, GNorm = 1.0666, lr_0 = 8.0309e-04
Validation rmse = 0.684489
Epoch 4
Loss = 9.4407e-01, PNorm = 42.8219, GNorm = 0.7002, lr_0 = 7.4989e-04
Validation rmse = 0.651962
Epoch 5
Loss = 7.9518e-01, PNorm = 42.8430, GNorm = 0.8147, lr_0 = 6.9069e-04
Validation rmse = 0.623145
Epoch 6
Loss = 7.4120e-01, PNorm = 42.8602, GNorm = 1.0412, lr_0 = 6.4495e-04
Loss = 7.8074e-01, PNorm = 42.8755, GNorm = 2.7053, lr_0 = 6.0223e-04
Loss = 8.3489e-01, PNorm = 42.8777, GNorm = 1.9338, lr_0 = 5.9403e-04
Validation rmse = 0.616748
Epoch 7
Loss = 7.4086e-01, PNorm = 42.8864, GNorm = 4.4054, lr_0 = 5.5469e-04
Validation rmse = 0.602573
Epoch 8
Loss = 7.0457e-01, PNorm = 42.8946, GNorm = 2.1754, lr_0 = 5.1795e-04
Validation rmse = 0.601231
Epoch 9
Loss = 6.6914e-01, PNorm = 42.9046, GNorm = 1.0762, lr_0 = 4.7706e-04
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715447
Epoch 2
Loss = 8.0487e-01, PNorm = 42.7507, GNorm = 0.7394, lr_0 = 9.3377e-04
Validation rmse = 0.708588
Epoch 3
Loss = 8.5113e-01, PNorm = 42.7825, GNorm = 0.8180, lr_0 = 8.6005e-04
Loss = 9.8843e-01, PNorm = 42.8032, GNorm = 1.0666, lr_0 = 8.0309e-04
Validation rmse = 0.684489
Epoch 4
Loss = 9.4407e-01, PNorm = 42.8219, GNorm = 0.7002, lr_0 = 7.4989e-04
Validation rmse = 0.651962
Epoch 5
Loss = 7.9518e-01, PNorm = 42.8430, GNorm = 0.8147, lr_0 = 6.9069e-04
Validation rmse = 0.623145
Epoch 6
Loss = 7.4120e-01, PNorm = 42.8602, GNorm = 1.0412, lr_0 = 6.4495e-04
Loss = 7.8074e-01, PNorm = 42.8755, GNorm = 2.7053, lr_0 = 6.0223e-04
Loss = 8.3489e-01, PNorm = 42.8777, GNorm = 1.9338, lr_0 = 5.9403e-04
Validation rmse = 0.616748
Epoch 7
Loss = 7.4086e-01, PNorm = 42.8864, GNorm = 4.4054, lr_0 = 5.5469e-04
Validation rmse = 0.602573
Epoch 8
Loss = 7.0457e-01, PNorm = 42.8946, GNorm = 2.1754, lr_0 = 5.1795e-04
Validation rmse = 0.601231
Epoch 9
Loss = 6.6914e-01, PNorm = 42.9046, GNorm = 1.0762, lr_0 = 4.7706e-04
Loss = 6.6757e-01, PNorm = 42.9126, GNorm = 4.3875, lr_0 = 4.4546e-04
Validation rmse = 0.624125
Epoch 10
Loss = 6.3684e-01, PNorm = 42.9194, GNorm = 5.9240, lr_0 = 4.1596e-04
Validation rmse = 0.601339
Epoch 11
Loss = 6.8493e-01, PNorm = 42.9232, GNorm = 2.0348, lr_0 = 3.8312e-04
Validation rmse = 0.585315
Epoch 12
Loss = 6.8623e-01, PNorm = 42.9273, GNorm = 1.7222, lr_0 = 3.5774e-04
Loss = 6.7039e-01, PNorm = 42.9324, GNorm = 1.8731, lr_0 = 3.3405e-04
Validation rmse = 0.582237
Epoch 13
Loss = 6.6420e-01, PNorm = 42.9377, GNorm = 1.2057, lr_0 = 3.1192e-04
Validation rmse = 0.595454
Epoch 14
Loss = 6.8159e-01, PNorm = 42.9433, GNorm = 0.9846, lr_0 = 2.8730e-04
Validation rmse = 0.579271
Epoch 15
Loss = 5.5480e-01, PNorm = 42.9469, GNorm = 3.1158, lr_0 = 2.6827e-04
Validation rmse = 0.577980
Epoch 16
Loss = 6.2479e-01, PNorm = 42.9504, GNorm = 1.3285, lr_0 = 2.4709e-04
Loss = 6.1518e-01, PNorm = 42.9527, GNorm = 1.5005, lr_0 = 2.3073e-04
Validation rmse = 0.575709
Epoch 17
Loss = 5.7437e-01, PNorm = 42.9552, GNorm = 0.8858, lr_0 = 2.1544e-04
Validation rmse = 0.578661
Epoch 18
Loss = 5.0416e-01, PNorm = 42.9579, GNorm = 1.7992, lr_0 = 1.9844e-04
Validation rmse = 0.570862
Epoch 19
Loss = 6.3821e-01, PNorm = 42.9605, GNorm = 3.0865, lr_0 = 1.8529e-04
Loss = 5.9297e-01, PNorm = 42.9632, GNorm = 4.3740, lr_0 = 1.7302e-04
Loss = 7.2890e-01, PNorm = 42.9637, GNorm = 3.0891, lr_0 = 1.7066e-04
Validation rmse = 0.574181
Epoch 20
Loss = 5.8448e-01, PNorm = 42.9655, GNorm = 1.2306, lr_0 = 1.5936e-04
Validation rmse = 0.579921
Epoch 21
Loss = 5.5304e-01, PNorm = 42.9675, GNorm = 3.2840, lr_0 = 1.4881e-04
Validation rmse = 0.570589
Epoch 22
Loss = 6.0437e-01, PNorm = 42.9698, GNorm = 3.2927, lr_0 = 1.3706e-04
Loss = 5.5397e-01, PNorm = 42.9714, GNorm = 1.1944, lr_0 = 1.2798e-04
Validation rmse = 0.574282
Epoch 23
Loss = 6.0504e-01, PNorm = 42.9730, GNorm = 2.1663, lr_0 = 1.1950e-04
Validation rmse = 0.576067
Epoch 24
Loss = 5.7027e-01, PNorm = 42.9747, GNorm = 1.1007, lr_0 = 1.1007e-04
Validation rmse = 0.574619
Epoch 25
Loss = 6.1276e-01, PNorm = 42.9764, GNorm = 0.9364, lr_0 = 1.0278e-04
Loss = 5.7233e-01, PNorm = 42.9776, GNorm = 2.4917, lr_0 = 1.0000e-04
Validation rmse = 0.577679
Epoch 26
Loss = 5.7895e-01, PNorm = 42.9788, GNorm = 2.7188, lr_0 = 1.0000e-04
Validation rmse = 0.569597
Epoch 27
Loss = 6.1566e-01, PNorm = 42.9805, GNorm = 1.4070, lr_0 = 1.0000e-04
Validation rmse = 0.573767
Epoch 28
Loss = 5.3009e-01, PNorm = 42.9813, GNorm = 6.0147, lr_0 = 1.0000e-04
Validation rmse = 0.568470
Epoch 29
Loss = 5.1411e-01, PNorm = 42.9829, GNorm = 2.1339, lr_0 = 1.0000e-04
Loss = 6.0269e-01, PNorm = 42.9841, GNorm = 2.9299, lr_0 = 1.0000e-04
Validation rmse = 0.568607
Model 0 best validation rmse = 0.568470 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.558738
Ensemble test rmse = 0.558738
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.697055
Epoch 2
Loss = 1.0452e+00, PNorm = 42.7495, GNorm = 1.2479, lr_0 = 9.3377e-04
Validation rmse = 0.693144
Epoch 3
Loss = 8.9572e-01, PNorm = 42.7809, GNorm = 1.6347, lr_0 = 8.6005e-04
Loss = 9.9188e-01, PNorm = 42.8000, GNorm = 0.7933, lr_0 = 8.0309e-04
Validation rmse = 0.675681
Epoch 4
Loss = 9.8065e-01, PNorm = 42.8156, GNorm = 0.8143, lr_0 = 7.4989e-04
Validation rmse = 0.664044
Epoch 5
Loss = 7.9354e-01, PNorm = 42.8318, GNorm = 1.5595, lr_0 = 6.9069e-04
Validation rmse = 0.629157
Epoch 6
Loss = 8.8346e-01, PNorm = 42.8456, GNorm = 1.4928, lr_0 = 6.4495e-04
Loss = 8.1587e-01, PNorm = 42.8603, GNorm = 1.2781, lr_0 = 6.0223e-04
Loss = 7.6936e-01, PNorm = 42.8633, GNorm = 2.0556, lr_0 = 5.9403e-04
Validation rmse = 0.595276
Epoch 7
Loss = 7.7725e-01, PNorm = 42.8760, GNorm = 1.0913, lr_0 = 5.5469e-04
Validation rmse = 0.588194
Epoch 8
Loss = 7.8536e-01, PNorm = 42.8851, GNorm = 3.2896, lr_0 = 5.1795e-04
Validation rmse = 0.586777
Epoch 9
Loss = 6.9878e-01, PNorm = 42.8925, GNorm = 3.6494, lr_0 = 4.7706e-04
Loss = 7.5277e-01, PNorm = 42.8980, GNorm = 4.0819, lr_0 = 4.4546e-04
Validation rmse = 0.579362
Epoch 10
Loss = 6.6476e-01, PNorm = 42.9052, GNorm = 1.6136, lr_0 = 4.1596e-04
Validation rmse = 0.564571
Epoch 11
Loss = 6.8695e-01, PNorm = 42.9134, GNorm = 1.9792, lr_0 = 3.8312e-04
Validation rmse = 0.570716
Epoch 12
Loss = 6.5224e-01, PNorm = 42.9194, GNorm = 0.9267, lr_0 = 3.5774e-04
Loss = 7.2791e-01, PNorm = 42.9230, GNorm = 2.6806, lr_0 = 3.3405e-04
Validation rmse = 0.580236
Epoch 13
Loss = 6.6983e-01, PNorm = 42.9281, GNorm = 2.8828, lr_0 = 3.1192e-04
Validation rmse = 0.562129
Epoch 14
Loss = 6.7631e-01, PNorm = 42.9315, GNorm = 6.9046, lr_0 = 2.8730e-04
Validation rmse = 0.559640
Epoch 15
Loss = 6.4654e-01, PNorm = 42.9356, GNorm = 4.9788, lr_0 = 2.6827e-04
Validation rmse = 0.570588
Epoch 16
Loss = 6.9040e-01, PNorm = 42.9386, GNorm = 1.4570, lr_0 = 2.4709e-04
Loss = 6.4366e-01, PNorm = 42.9427, GNorm = 0.7145, lr_0 = 2.3073e-04
Validation rmse = 0.541543
Epoch 17
Loss = 6.4980e-01, PNorm = 42.9460, GNorm = 1.1029, lr_0 = 2.1544e-04
Validation rmse = 0.548159
Epoch 18
Loss = 5.8314e-01, PNorm = 42.9494, GNorm = 2.1729, lr_0 = 1.9844e-04
Validation rmse = 0.541053
Epoch 19
Loss = 6.9420e-01, PNorm = 42.9526, GNorm = 0.8432, lr_0 = 1.8529e-04
Loss = 6.2855e-01, PNorm = 42.9550, GNorm = 2.9874, lr_0 = 1.7302e-04
Loss = 5.8369e-01, PNorm = 42.9554, GNorm = 1.3358, lr_0 = 1.7066e-04
Validation rmse = 0.548293
Epoch 20
Loss = 6.3278e-01, PNorm = 42.9576, GNorm = 2.2793, lr_0 = 1.5936e-04
Validation rmse = 0.544885
Epoch 21
Loss = 5.6064e-01, PNorm = 42.9598, GNorm = 1.0006, lr_0 = 1.4881e-04
Validation rmse = 0.538562
Epoch 22
Loss = 6.4052e-01, PNorm = 42.9623, GNorm = 2.2828, lr_0 = 1.3706e-04
Loss = 5.7620e-01, PNorm = 42.9641, GNorm = 1.1120, lr_0 = 1.2798e-04
Validation rmse = 0.547499
Epoch 23
Loss = 6.2489e-01, PNorm = 42.9660, GNorm = 0.6796, lr_0 = 1.1950e-04
Validation rmse = 0.541677
Epoch 24
Loss = 6.3415e-01, PNorm = 42.9679, GNorm = 1.4635, lr_0 = 1.1007e-04
Validation rmse = 0.539578
Epoch 25
Loss = 5.4053e-01, PNorm = 42.9695, GNorm = 3.3444, lr_0 = 1.0278e-04
Loss = 6.0679e-01, PNorm = 42.9708, GNorm = 1.2789, lr_0 = 1.0000e-04
Validation rmse = 0.540755
Epoch 26
Loss = 6.1915e-01, PNorm = 42.9721, GNorm = 1.1925, lr_0 = 1.0000e-04
Validation rmse = 0.542182
Epoch 27
Loss = 6.1016e-01, PNorm = 42.9736, GNorm = 0.8586, lr_0 = 1.0000e-04
Validation rmse = 0.541266
Epoch 28
Loss = 6.2205e-01, PNorm = 42.9751, GNorm = 1.6679, lr_0 = 1.0000e-04
Validation rmse = 0.542742
Epoch 29
Loss = 6.6923e-01, PNorm = 42.9769, GNorm = 1.4430, lr_0 = 1.0000e-04
Loss = 5.7500e-01, PNorm = 42.9784, GNorm = 2.4009, lr_0 = 1.0000e-04
Validation rmse = 0.546111
Model 0 best validation rmse = 0.538562 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.615220
Ensemble test rmse = 0.615220
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.745014
Epoch 2
Loss = 8.6480e-01, PNorm = 42.7541, GNorm = 0.6907, lr_0 = 9.3377e-04
Validation rmse = 0.732480
Epoch 3
Loss = 9.2699e-01, PNorm = 42.7882, GNorm = 0.6241, lr_0 = 8.6005e-04
Loss = 9.7685e-01, PNorm = 42.8099, GNorm = 0.7089, lr_0 = 8.0309e-04
Validation rmse = 0.727688
Epoch 4
Loss = 9.3093e-01, PNorm = 42.8297, GNorm = 1.4995, lr_0 = 7.4989e-04
Validation rmse = 0.754503
Epoch 5
Loss = 8.4557e-01, PNorm = 42.8504, GNorm = 2.4476, lr_0 = 6.9069e-04
Validation rmse = 0.712809
Epoch 6
Loss = 9.2734e-01, PNorm = 42.8635, GNorm = 1.3516, lr_0 = 6.4495e-04
Loss = 7.5516e-01, PNorm = 42.8767, GNorm = 1.6220, lr_0 = 6.0223e-04
Loss = 6.3021e-01, PNorm = 42.8787, GNorm = 1.0692, lr_0 = 5.9403e-04
Validation rmse = 0.681059
Epoch 7
Loss = 7.0157e-01, PNorm = 42.8888, GNorm = 1.0523, lr_0 = 5.5469e-04
Validation rmse = 0.652395
Epoch 8
Loss = 7.1081e-01, PNorm = 42.8976, GNorm = 1.1103, lr_0 = 5.1795e-04
Validation rmse = 0.634330
Epoch 9
Loss = 6.7770e-01, PNorm = 42.9071, GNorm = 4.3400, lr_0 = 4.7706e-04
Loss = 7.3622e-01, PNorm = 42.9134, GNorm = 3.9563, lr_0 = 4.4546e-04
Validation rmse = 0.650625
Epoch 10
Loss = 6.2309e-01, PNorm = 42.9208, GNorm = 0.8798, lr_0 = 4.1596e-04
Validation rmse = 0.637108
Epoch 11
Loss = 6.3913e-01, PNorm = 42.9297, GNorm = 1.2827, lr_0 = 3.8312e-04
Validation rmse = 0.620600
Epoch 12
Loss = 5.6220e-01, PNorm = 42.9355, GNorm = 1.8147, lr_0 = 3.5774e-04
Loss = 6.6391e-01, PNorm = 42.9402, GNorm = 1.2362, lr_0 = 3.3405e-04
Validation rmse = 0.648329
Epoch 13
Loss = 6.0462e-01, PNorm = 42.9443, GNorm = 1.1426, lr_0 = 3.1192e-04
Validation rmse = 0.615714
Epoch 14
Loss = 6.1554e-01, PNorm = 42.9498, GNorm = 0.8260, lr_0 = 2.8730e-04
Validation rmse = 0.615097
Epoch 15
Loss = 6.8301e-01, PNorm = 42.9541, GNorm = 1.6553, lr_0 = 2.6827e-04
Validation rmse = 0.654201
Epoch 16
Loss = 6.7847e-01, PNorm = 42.9577, GNorm = 2.7978, lr_0 = 2.4709e-04
Loss = 5.9677e-01, PNorm = 42.9607, GNorm = 0.8036, lr_0 = 2.3073e-04
Validation rmse = 0.624268
Epoch 17
Loss = 6.0603e-01, PNorm = 42.9647, GNorm = 0.7444, lr_0 = 2.1544e-04
Validation rmse = 0.641255
Epoch 18
Loss = 5.8953e-01, PNorm = 42.9681, GNorm = 5.5179, lr_0 = 1.9844e-04
Validation rmse = 0.645475
Epoch 19
Loss = 6.5256e-01, PNorm = 42.9703, GNorm = 2.1616, lr_0 = 1.8529e-04
Loss = 5.7974e-01, PNorm = 42.9734, GNorm = 2.0146, lr_0 = 1.7302e-04
Loss = 7.1703e-01, PNorm = 42.9738, GNorm = 1.9822, lr_0 = 1.7066e-04
Validation rmse = 0.599997
Epoch 20
Loss = 5.9001e-01, PNorm = 42.9756, GNorm = 0.9041, lr_0 = 1.5936e-04
Validation rmse = 0.620606
Epoch 21
Loss = 5.7376e-01, PNorm = 42.9779, GNorm = 1.8346, lr_0 = 1.4881e-04
Validation rmse = 0.659861
Epoch 22
Loss = 5.8563e-01, PNorm = 42.9799, GNorm = 1.8335, lr_0 = 1.3706e-04
Loss = 6.1153e-01, PNorm = 42.9823, GNorm = 2.7638, lr_0 = 1.2798e-04
Validation rmse = 0.579832
Epoch 23
Loss = 6.1080e-01, PNorm = 42.9831, GNorm = 1.6801, lr_0 = 1.1950e-04
Validation rmse = 0.692404
Epoch 24
Loss = 5.8252e-01, PNorm = 42.9852, GNorm = 1.6802, lr_0 = 1.1007e-04
Validation rmse = 0.587816
Epoch 25
Loss = 6.4176e-01, PNorm = 42.9869, GNorm = 1.6123, lr_0 = 1.0278e-04
Loss = 5.7966e-01, PNorm = 42.9877, GNorm = 1.2270, lr_0 = 1.0000e-04
Validation rmse = 0.659771
Epoch 26
Loss = 5.7840e-01, PNorm = 42.9890, GNorm = 7.9568, lr_0 = 1.0000e-04
Validation rmse = 0.593303
Epoch 27
Loss = 5.8145e-01, PNorm = 42.9909, GNorm = 5.3887, lr_0 = 1.0000e-04
Validation rmse = 0.627146
Epoch 28
Loss = 4.7976e-01, PNorm = 42.9918, GNorm = 0.7777, lr_0 = 1.0000e-04
Validation rmse = 0.617427
Epoch 29
Loss = 5.3644e-01, PNorm = 42.9938, GNorm = 3.2924, lr_0 = 1.0000e-04
Loss = 5.4825e-01, PNorm = 42.9953, GNorm = 1.6108, lr_0 = 1.0000e-04
Validation rmse = 0.615616
Model 0 best validation rmse = 0.579832 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.540600
Ensemble test rmse = 0.540600
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732287
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7516, GNorm = 0.8283, lr_0 = 9.3377e-04
Validation rmse = 0.724968
Epoch 3
Loss = 9.6774e-01, PNorm = 42.7852, GNorm = 0.8058, lr_0 = 8.6005e-04
Loss = 9.3914e-01, PNorm = 42.8083, GNorm = 0.9354, lr_0 = 8.0309e-04
Validation rmse = 0.692859
Epoch 4
Loss = 9.0352e-01, PNorm = 42.8275, GNorm = 0.9715, lr_0 = 7.4989e-04
Validation rmse = 0.676653
Epoch 5
Loss = 8.7032e-01, PNorm = 42.8492, GNorm = 1.1377, lr_0 = 6.9069e-04
Validation rmse = 0.650986
Epoch 6
Loss = 7.4644e-01, PNorm = 42.8654, GNorm = 1.0085, lr_0 = 6.4495e-04
Loss = 7.5113e-01, PNorm = 42.8778, GNorm = 3.0592, lr_0 = 6.0223e-04
Loss = 7.9329e-01, PNorm = 42.8795, GNorm = 2.8613, lr_0 = 5.9403e-04
Validation rmse = 0.647570
Epoch 7
Loss = 7.6479e-01, PNorm = 42.8892, GNorm = 4.2655, lr_0 = 5.5469e-04
Validation rmse = 0.649186
Epoch 8
Loss = 6.5220e-01, PNorm = 42.8978, GNorm = 1.2345, lr_0 = 5.1795e-04
Validation rmse = 0.590833
Epoch 9
Loss = 6.6616e-01, PNorm = 42.9091, GNorm = 3.3266, lr_0 = 4.7706e-04
Loss = 6.9083e-01, PNorm = 42.9167, GNorm = 1.5630, lr_0 = 4.4546e-04
Validation rmse = 0.574987
Epoch 10
Loss = 6.8607e-01, PNorm = 42.9227, GNorm = 5.0904, lr_0 = 4.1596e-04
Validation rmse = 0.593418
Epoch 11
Loss = 6.5940e-01, PNorm = 42.9286, GNorm = 3.0436, lr_0 = 3.8312e-04
Validation rmse = 0.573596
Epoch 12
Loss = 6.7135e-01, PNorm = 42.9337, GNorm = 1.8743, lr_0 = 3.5774e-04
Loss = 6.6665e-01, PNorm = 42.9390, GNorm = 3.2668, lr_0 = 3.3405e-04
Validation rmse = 0.583987
Epoch 13
Loss = 6.5664e-01, PNorm = 42.9438, GNorm = 3.7455, lr_0 = 3.1192e-04
Validation rmse = 0.626113
Epoch 14
Loss = 6.4508e-01, PNorm = 42.9492, GNorm = 0.7264, lr_0 = 2.8730e-04
Validation rmse = 0.562780
Epoch 15
Loss = 7.0182e-01, PNorm = 42.9543, GNorm = 2.5945, lr_0 = 2.6827e-04
Validation rmse = 0.605249
Epoch 16
Loss = 6.7658e-01, PNorm = 42.9593, GNorm = 3.9114, lr_0 = 2.4709e-04
Loss = 6.2914e-01, PNorm = 42.9632, GNorm = 4.1965, lr_0 = 2.3073e-04
Validation rmse = 0.587026
Epoch 17
Loss = 6.1386e-01, PNorm = 42.9664, GNorm = 1.0943, lr_0 = 2.1544e-04
Validation rmse = 0.570642
Epoch 18
Loss = 5.7743e-01, PNorm = 42.9704, GNorm = 2.9941, lr_0 = 1.9844e-04
Validation rmse = 0.603230
Epoch 19
Loss = 6.5491e-01, PNorm = 42.9730, GNorm = 1.2436, lr_0 = 1.8529e-04
Loss = 6.0316e-01, PNorm = 42.9763, GNorm = 0.8511, lr_0 = 1.7302e-04
Loss = 4.8995e-01, PNorm = 42.9768, GNorm = 1.2689, lr_0 = 1.7066e-04
Validation rmse = 0.553563
Epoch 20
Loss = 6.2179e-01, PNorm = 42.9787, GNorm = 0.8571, lr_0 = 1.5936e-04
Validation rmse = 0.598982
Epoch 21
Loss = 6.4572e-01, PNorm = 42.9809, GNorm = 4.5459, lr_0 = 1.4881e-04
Validation rmse = 0.567650
Epoch 22
Loss = 5.4236e-01, PNorm = 42.9836, GNorm = 0.9194, lr_0 = 1.3706e-04
Loss = 5.8949e-01, PNorm = 42.9856, GNorm = 1.7218, lr_0 = 1.2798e-04
Validation rmse = 0.577125
Epoch 23
Loss = 5.4694e-01, PNorm = 42.9875, GNorm = 1.4612, lr_0 = 1.1950e-04
Validation rmse = 0.570667
Epoch 24
Loss = 5.4388e-01, PNorm = 42.9899, GNorm = 0.8843, lr_0 = 1.1007e-04
Validation rmse = 0.566004
Epoch 25
Loss = 5.7132e-01, PNorm = 42.9915, GNorm = 1.3957, lr_0 = 1.0278e-04
Loss = 5.8223e-01, PNorm = 42.9930, GNorm = 1.3698, lr_0 = 1.0000e-04
Validation rmse = 0.590476
Epoch 26
Loss = 5.7345e-01, PNorm = 42.9946, GNorm = 1.1480, lr_0 = 1.0000e-04
Validation rmse = 0.563667
Epoch 27
Loss = 5.9223e-01, PNorm = 42.9967, GNorm = 1.3229, lr_0 = 1.0000e-04
Validation rmse = 0.571173
Epoch 28
Loss = 6.0937e-01, PNorm = 42.9983, GNorm = 2.8622, lr_0 = 1.0000e-04
Validation rmse = 0.578253
Epoch 29
Loss = 5.4590e-01, PNorm = 43.0001, GNorm = 1.3352, lr_0 = 1.0000e-04
Loss = 5.4714e-01, PNorm = 43.0018, GNorm = 2.7380, lr_0 = 1.0000e-04
Validation rmse = 0.567166
Model 0 best validation rmse = 0.553563 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.509092
Ensemble test rmse = 0.509092
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.6854e+00, PNorm = 42.6832, GNorm = 6.5055, lr_0 = 7.5000e-04
Validation rmse = 0.779950
Epoch 1
Loss = 1.0715e+00, PNorm = 42.7188, GNorm = 1.6002, lr_0 = 1.0000e-03
Validation rmse = 0.764579
Epoch 2
Loss = 9.2654e-01, PNorm = 42.7530, GNorm = 0.9732, lr_0 = 9.3377e-04
Validation rmse = 0.742976
Epoch 3
Loss = 9.2375e-01, PNorm = 42.7852, GNorm = 0.7881, lr_0 = 8.6005e-04
Loss = 9.7017e-01, PNorm = 42.8061, GNorm = 0.7445, lr_0 = 8.0309e-04
Validation rmse = 0.740080
Epoch 4
Loss = 9.0769e-01, PNorm = 42.8242, GNorm = 0.8472, lr_0 = 7.4989e-04
Validation rmse = 0.691824
Epoch 5
Loss = 9.4401e-01, PNorm = 42.8445, GNorm = 1.8134, lr_0 = 6.9069e-04
Validation rmse = 0.761126
Epoch 6
Loss = 8.1456e-01, PNorm = 42.8585, GNorm = 3.7963, lr_0 = 6.4495e-04
Loss = 8.2173e-01, PNorm = 42.8709, GNorm = 1.2023, lr_0 = 6.0223e-04
Loss = 9.0238e-01, PNorm = 42.8731, GNorm = 2.9814, lr_0 = 5.9403e-04
Validation rmse = 0.669339
Epoch 7
Loss = 7.9231e-01, PNorm = 42.8841, GNorm = 2.8026, lr_0 = 5.5469e-04
Validation rmse = 0.674879
Epoch 8
Loss = 7.5719e-01, PNorm = 42.8941, GNorm = 1.7403, lr_0 = 5.1795e-04
Validation rmse = 0.600533
Epoch 9
Loss = 6.8314e-01, PNorm = 42.9044, GNorm = 0.7767, lr_0 = 4.7706e-04
Loss = 7.4529e-01, PNorm = 42.9125, GNorm = 1.1521, lr_0 = 4.4546e-04
Validation rmse = 0.596390
Epoch 10
Loss = 7.0681e-01, PNorm = 42.9193, GNorm = 0.8526, lr_0 = 4.1596e-04
Validation rmse = 0.610619
Epoch 11
Loss = 6.7377e-01, PNorm = 42.9282, GNorm = 2.0053, lr_0 = 3.8312e-04
Validation rmse = 0.612908
Epoch 12
Loss = 5.6888e-01, PNorm = 42.9349, GNorm = 0.6088, lr_0 = 3.5774e-04
Loss = 7.0610e-01, PNorm = 42.9407, GNorm = 1.6145, lr_0 = 3.3405e-04
Validation rmse = 0.625737
Epoch 13
Loss = 6.3175e-01, PNorm = 42.9462, GNorm = 1.8825, lr_0 = 3.1192e-04
Validation rmse = 0.563181
Epoch 14
Loss = 7.0096e-01, PNorm = 42.9512, GNorm = 1.0218, lr_0 = 2.8730e-04
Validation rmse = 0.584562
Epoch 15
Loss = 6.8360e-01, PNorm = 42.9563, GNorm = 1.2391, lr_0 = 2.6827e-04
Validation rmse = 0.611963
Epoch 16
Loss = 6.2911e-01, PNorm = 42.9607, GNorm = 2.5036, lr_0 = 2.4709e-04
Loss = 6.2543e-01, PNorm = 42.9642, GNorm = 1.6521, lr_0 = 2.3073e-04
Validation rmse = 0.580209
Epoch 17
Loss = 5.8802e-01, PNorm = 42.9673, GNorm = 3.4584, lr_0 = 2.1544e-04
Validation rmse = 0.585811
Epoch 18
Loss = 6.1483e-01, PNorm = 42.9712, GNorm = 3.1527, lr_0 = 1.9844e-04
Validation rmse = 0.613035
Epoch 19
Loss = 6.8221e-01, PNorm = 42.9739, GNorm = 0.9879, lr_0 = 1.8529e-04
Loss = 5.9303e-01, PNorm = 42.9770, GNorm = 1.9863, lr_0 = 1.7302e-04
Loss = 5.8525e-01, PNorm = 42.9775, GNorm = 2.1712, lr_0 = 1.7066e-04
Validation rmse = 0.570227
Epoch 20
Loss = 6.3022e-01, PNorm = 42.9798, GNorm = 1.9853, lr_0 = 1.5936e-04
Validation rmse = 0.581600
Epoch 21
Loss = 5.8953e-01, PNorm = 42.9827, GNorm = 0.7531, lr_0 = 1.4881e-04
Validation rmse = 0.578079
Epoch 22
Loss = 5.4615e-01, PNorm = 42.9857, GNorm = 0.7035, lr_0 = 1.3706e-04
Loss = 6.1001e-01, PNorm = 42.9881, GNorm = 1.2397, lr_0 = 1.2798e-04
Validation rmse = 0.584981
Epoch 23
Loss = 6.0172e-01, PNorm = 42.9902, GNorm = 2.0141, lr_0 = 1.1950e-04
Validation rmse = 0.572697
Epoch 24
Loss = 5.9022e-01, PNorm = 42.9921, GNorm = 1.0733, lr_0 = 1.1007e-04
Validation rmse = 0.588081
Epoch 25
Loss = 5.8080e-01, PNorm = 42.9937, GNorm = 0.6415, lr_0 = 1.0278e-04
Loss = 5.7565e-01, PNorm = 42.9951, GNorm = 0.9107, lr_0 = 1.0000e-04
Validation rmse = 0.580123
Epoch 26
Loss = 5.7992e-01, PNorm = 42.9966, GNorm = 1.6194, lr_0 = 1.0000e-04
Validation rmse = 0.578048
Epoch 27
Loss = 5.6540e-01, PNorm = 42.9986, GNorm = 2.4857, lr_0 = 1.0000e-04
Validation rmse = 0.572529
Epoch 28
Loss = 6.1825e-01, PNorm = 43.0002, GNorm = 2.3043, lr_0 = 1.0000e-04
Validation rmse = 0.588287
Epoch 29
Loss = 5.5521e-01, PNorm = 43.0021, GNorm = 2.0182, lr_0 = 1.0000e-04
Loss = 5.7663e-01, PNorm = 43.0038, GNorm = 1.2371, lr_0 = 1.0000e-04
Validation rmse = 0.570823
Model 0 best validation rmse = 0.563181 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.626215
Ensemble test rmse = 0.626215
5-fold cross validation
	Seed 0 ==> test rmse = 0.558738
	Seed 1 ==> test rmse = 0.615220
	Seed 2 ==> test rmse = 0.540600
	Seed 3 ==> test rmse = 0.509092
	Seed 4 ==> test rmse = 0.626215
Overall test rmse = 0.569973 +/- 0.044511
Elapsed time = 0:27:57
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.5583e+00, PNorm = 42.7051, GNorm = 4.5689, lr_0 = 1.0000e-03
Validation rmse = 0.765591
Epoch 1
Loss = 1.0221e+00, PNorm = 42.7736, GNorm = 0.6422, lr_0 = 1.0000e-03
Validation rmse = 0.717877
Epoch 2
Loss = 8.2527e-01, PNorm = 42.8228, GNorm = 0.5747, lr_0 = 9.3377e-04
Validation rmse = 0.708456
Epoch 3
Loss = 8.5208e-01, PNorm = 42.8645, GNorm = 1.0132, lr_0 = 8.6005e-04
Loss = 9.9162e-01, PNorm = 42.8903, GNorm = 1.3690, lr_0 = 8.0309e-04
Validation rmse = 0.690005
Epoch 4
Loss = 9.4043e-01, PNorm = 42.9118, GNorm = 0.7637, lr_0 = 7.4989e-04
Validation rmse = 0.656430
Epoch 5
Loss = 8.2563e-01, PNorm = 42.9337, GNorm = 0.7707, lr_0 = 6.9069e-04
Validation rmse = 0.630951
Epoch 6
Loss = 7.7378e-01, PNorm = 42.9517, GNorm = 0.9287, lr_0 = 6.4495e-04
Loss = 7.6918e-01, PNorm = 42.9684, GNorm = 4.2682, lr_0 = 6.0223e-04
Loss = 8.2596e-01, PNorm = 42.9708, GNorm = 2.5290, lr_0 = 5.9403e-04
Validation rmse = 0.643495
Epoch 7
Loss = 7.7376e-01, PNorm = 42.9797, GNorm = 6.1367, lr_0 = 5.5469e-04
Validation rmse = 0.610680
Epoch 8
Loss = 6.7755e-01, PNorm = 42.9878, GNorm = 1.0014, lr_0 = 5.1795e-04
Validation rmse = 0.613745
Epoch 9
Loss = 6.5628e-01, PNorm = 42.9972, GNorm = 1.3477, lr_0 = 4.7706e-04
Loss = 6.9437e-01, PNorm = 43.0041, GNorm = 7.4381, lr_0 = 4.4546e-04
Validation rmse = 0.630227
Epoch 10
Loss = 6.8111e-01, PNorm = 43.0106, GNorm = 6.6319, lr_0 = 4.1596e-04
Validation rmse = 0.606610
Epoch 11
Loss = 6.9165e-01, PNorm = 43.0143, GNorm = 2.9561, lr_0 = 3.8312e-04
Validation rmse = 0.607488
Epoch 12
Loss = 6.8833e-01, PNorm = 43.0189, GNorm = 3.9424, lr_0 = 3.5774e-04
Loss = 6.6043e-01, PNorm = 43.0236, GNorm = 3.1837, lr_0 = 3.3405e-04
Validation rmse = 0.594934
Epoch 13
Loss = 6.5825e-01, PNorm = 43.0289, GNorm = 1.7714, lr_0 = 3.1192e-04
Validation rmse = 0.600126
Epoch 14
Loss = 6.6264e-01, PNorm = 43.0341, GNorm = 1.4001, lr_0 = 2.8730e-04
Validation rmse = 0.594777
Epoch 15
Loss = 6.0276e-01, PNorm = 43.0377, GNorm = 4.2058, lr_0 = 2.6827e-04
Validation rmse = 0.595114
Epoch 16
Loss = 6.0552e-01, PNorm = 43.0415, GNorm = 1.7485, lr_0 = 2.4709e-04
Loss = 6.2333e-01, PNorm = 43.0444, GNorm = 2.5477, lr_0 = 2.3073e-04
Validation rmse = 0.595020
Epoch 17
Loss = 5.7924e-01, PNorm = 43.0471, GNorm = 0.7597, lr_0 = 2.1544e-04
Validation rmse = 0.594002
Epoch 18
Loss = 5.1650e-01, PNorm = 43.0505, GNorm = 2.0663, lr_0 = 1.9844e-04
Validation rmse = 0.586843
Epoch 19
Loss = 6.1514e-01, PNorm = 43.0532, GNorm = 2.8348, lr_0 = 1.8529e-04
Loss = 6.0572e-01, PNorm = 43.0559, GNorm = 3.5940, lr_0 = 1.7302e-04
Loss = 7.9322e-01, PNorm = 43.0564, GNorm = 5.7741, lr_0 = 1.7066e-04
Validation rmse = 0.598430
Epoch 20
Loss = 6.1612e-01, PNorm = 43.0583, GNorm = 1.6483, lr_0 = 1.5936e-04
Validation rmse = 0.593167
Epoch 21
Loss = 5.6742e-01, PNorm = 43.0605, GNorm = 3.6662, lr_0 = 1.4881e-04
Validation rmse = 0.583146
Epoch 22
Loss = 6.3528e-01, PNorm = 43.0629, GNorm = 2.8799, lr_0 = 1.3706e-04
Loss = 5.7446e-01, PNorm = 43.0647, GNorm = 2.3818, lr_0 = 1.2798e-04
Validation rmse = 0.583738
Epoch 23
Loss = 6.1437e-01, PNorm = 43.0665, GNorm = 2.6050, lr_0 = 1.1950e-04
Validation rmse = 0.584794
Epoch 24
Loss = 5.9176e-01, PNorm = 43.0684, GNorm = 1.4613, lr_0 = 1.1007e-04
Validation rmse = 0.585440
Epoch 25
Loss = 6.0021e-01, PNorm = 43.0703, GNorm = 1.3139, lr_0 = 1.0278e-04
Loss = 6.0443e-01, PNorm = 43.0717, GNorm = 3.4114, lr_0 = 1.0000e-04
Validation rmse = 0.587748
Epoch 26
Loss = 5.8236e-01, PNorm = 43.0733, GNorm = 3.9806, lr_0 = 1.0000e-04
Validation rmse = 0.584730
Epoch 27
Loss = 6.1526e-01, PNorm = 43.0753, GNorm = 2.0056, lr_0 = 1.0000e-04
Validation rmse = 0.587851
Epoch 28
Loss = 5.5763e-01, PNorm = 43.0764, GNorm = 7.7233, lr_0 = 1.0000e-04
Validation rmse = 0.583312
Epoch 29
Loss = 5.3651e-01, PNorm = 43.0782, GNorm = 2.8326, lr_0 = 1.0000e-04
Loss = 5.9274e-01, PNorm = 43.0796, GNorm = 3.5381, lr_0 = 1.0000e-04
Validation rmse = 0.582147
Model 0 best validation rmse = 0.582147 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.571357
Ensemble test rmse = 0.571357
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.8485e+00, PNorm = 42.7066, GNorm = 4.6704, lr_0 = 1.0000e-03
Validation rmse = 0.737665
Epoch 1
Loss = 1.0160e+00, PNorm = 42.7774, GNorm = 1.7086, lr_0 = 1.0000e-03
Validation rmse = 0.694917
Epoch 2
Loss = 1.0256e+00, PNorm = 42.8265, GNorm = 0.7498, lr_0 = 9.3377e-04
Validation rmse = 0.685118
Epoch 3
Loss = 8.5614e-01, PNorm = 42.8676, GNorm = 1.1996, lr_0 = 8.6005e-04
Loss = 1.0327e+00, PNorm = 42.8913, GNorm = 1.1351, lr_0 = 8.0309e-04
Validation rmse = 0.682027
Epoch 4
Loss = 9.8253e-01, PNorm = 42.9091, GNorm = 0.6411, lr_0 = 7.4989e-04
Validation rmse = 0.682497
Epoch 5
Loss = 8.2337e-01, PNorm = 42.9258, GNorm = 1.5594, lr_0 = 6.9069e-04
Validation rmse = 0.653621
Epoch 6
Loss = 9.2659e-01, PNorm = 42.9387, GNorm = 0.8739, lr_0 = 6.4495e-04
Loss = 8.7058e-01, PNorm = 42.9527, GNorm = 1.2788, lr_0 = 6.0223e-04
Loss = 8.1740e-01, PNorm = 42.9557, GNorm = 1.0364, lr_0 = 5.9403e-04
Validation rmse = 0.628028
Epoch 7
Loss = 8.1664e-01, PNorm = 42.9695, GNorm = 0.6839, lr_0 = 5.5469e-04
Validation rmse = 0.589511
Epoch 8
Loss = 8.1143e-01, PNorm = 42.9825, GNorm = 2.9964, lr_0 = 5.1795e-04
Validation rmse = 0.587746
Epoch 9
Loss = 7.1503e-01, PNorm = 42.9945, GNorm = 4.7628, lr_0 = 4.7706e-04
Loss = 7.7683e-01, PNorm = 43.0022, GNorm = 5.4613, lr_0 = 4.4546e-04
Validation rmse = 0.586271
Epoch 10
Loss = 6.8961e-01, PNorm = 43.0099, GNorm = 2.5193, lr_0 = 4.1596e-04
Validation rmse = 0.577418
Epoch 11
Loss = 6.9919e-01, PNorm = 43.0188, GNorm = 2.4992, lr_0 = 3.8312e-04
Validation rmse = 0.574427
Epoch 12
Loss = 6.6079e-01, PNorm = 43.0249, GNorm = 1.0582, lr_0 = 3.5774e-04
Loss = 7.4267e-01, PNorm = 43.0298, GNorm = 1.9831, lr_0 = 3.3405e-04
Validation rmse = 0.575310
Epoch 13
Loss = 6.7795e-01, PNorm = 43.0356, GNorm = 3.0624, lr_0 = 3.1192e-04
Validation rmse = 0.572663
Epoch 14
Loss = 6.7931e-01, PNorm = 43.0403, GNorm = 6.9716, lr_0 = 2.8730e-04
Validation rmse = 0.581768
Epoch 15
Loss = 6.8207e-01, PNorm = 43.0445, GNorm = 5.3385, lr_0 = 2.6827e-04
Validation rmse = 0.582047
Epoch 16
Loss = 6.9079e-01, PNorm = 43.0483, GNorm = 2.2838, lr_0 = 2.4709e-04
Loss = 6.5362e-01, PNorm = 43.0526, GNorm = 1.4873, lr_0 = 2.3073e-04
Validation rmse = 0.554919
Epoch 17
Loss = 6.5919e-01, PNorm = 43.0565, GNorm = 2.0655, lr_0 = 2.1544e-04
Validation rmse = 0.555780
Epoch 18
Loss = 5.8272e-01, PNorm = 43.0612, GNorm = 1.5281, lr_0 = 1.9844e-04
Validation rmse = 0.547622
Epoch 19
Loss = 6.6588e-01, PNorm = 43.0651, GNorm = 0.7233, lr_0 = 1.8529e-04
Loss = 6.3301e-01, PNorm = 43.0682, GNorm = 2.6959, lr_0 = 1.7302e-04
Loss = 6.1774e-01, PNorm = 43.0688, GNorm = 1.1425, lr_0 = 1.7066e-04
Validation rmse = 0.558617
Epoch 20
Loss = 6.3849e-01, PNorm = 43.0718, GNorm = 2.1839, lr_0 = 1.5936e-04
Validation rmse = 0.546509
Epoch 21
Loss = 5.7734e-01, PNorm = 43.0743, GNorm = 0.6867, lr_0 = 1.4881e-04
Validation rmse = 0.546716
Epoch 22
Loss = 6.5154e-01, PNorm = 43.0773, GNorm = 2.2837, lr_0 = 1.3706e-04
Loss = 5.8376e-01, PNorm = 43.0796, GNorm = 1.0647, lr_0 = 1.2798e-04
Validation rmse = 0.548321
Epoch 23
Loss = 6.2499e-01, PNorm = 43.0819, GNorm = 0.6231, lr_0 = 1.1950e-04
Validation rmse = 0.545894
Epoch 24
Loss = 6.4257e-01, PNorm = 43.0844, GNorm = 1.4835, lr_0 = 1.1007e-04
Validation rmse = 0.542826
Epoch 25
Loss = 5.5343e-01, PNorm = 43.0863, GNorm = 3.9282, lr_0 = 1.0278e-04
Loss = 6.0762e-01, PNorm = 43.0879, GNorm = 1.4456, lr_0 = 1.0000e-04
Validation rmse = 0.543739
Epoch 26
Loss = 6.2031e-01, PNorm = 43.0897, GNorm = 1.1362, lr_0 = 1.0000e-04
Validation rmse = 0.543442
Epoch 27
Loss = 6.0069e-01, PNorm = 43.0919, GNorm = 0.6731, lr_0 = 1.0000e-04
Validation rmse = 0.543514
Epoch 28
Loss = 6.4674e-01, PNorm = 43.0938, GNorm = 2.2994, lr_0 = 1.0000e-04
Validation rmse = 0.544532
Epoch 29
Loss = 6.3653e-01, PNorm = 43.0962, GNorm = 1.6558, lr_0 = 1.0000e-04
Loss = 5.7239e-01, PNorm = 43.0982, GNorm = 2.9918, lr_0 = 1.0000e-04
Validation rmse = 0.543513
Model 0 best validation rmse = 0.542826 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.612690
Ensemble test rmse = 0.612690
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.6031e+00, PNorm = 42.7075, GNorm = 6.1307, lr_0 = 1.0000e-03
Validation rmse = 0.743983
Epoch 1
Loss = 1.0863e+00, PNorm = 42.7792, GNorm = 0.7100, lr_0 = 1.0000e-03
Validation rmse = 0.751241
Epoch 2
Loss = 8.5375e-01, PNorm = 42.8301, GNorm = 0.6866, lr_0 = 9.3377e-04
Validation rmse = 0.744113
Epoch 3
Loss = 9.3462e-01, PNorm = 42.8731, GNorm = 1.0901, lr_0 = 8.6005e-04
Loss = 9.8784e-01, PNorm = 42.8992, GNorm = 1.3133, lr_0 = 8.0309e-04
Validation rmse = 0.733508
Epoch 4
Loss = 9.3317e-01, PNorm = 42.9205, GNorm = 1.9830, lr_0 = 7.4989e-04
Validation rmse = 0.758948
Epoch 5
Loss = 8.5818e-01, PNorm = 42.9424, GNorm = 1.7465, lr_0 = 6.9069e-04
Validation rmse = 0.714117
Epoch 6
Loss = 9.5405e-01, PNorm = 42.9556, GNorm = 1.4879, lr_0 = 6.4495e-04
Loss = 7.8093e-01, PNorm = 42.9690, GNorm = 1.4557, lr_0 = 6.0223e-04
Loss = 6.0949e-01, PNorm = 42.9715, GNorm = 1.6656, lr_0 = 5.9403e-04
Validation rmse = 0.683479
Epoch 7
Loss = 7.2401e-01, PNorm = 42.9838, GNorm = 1.6304, lr_0 = 5.5469e-04
Validation rmse = 0.652815
Epoch 8
Loss = 7.2982e-01, PNorm = 42.9936, GNorm = 1.3956, lr_0 = 5.1795e-04
Validation rmse = 0.643614
Epoch 9
Loss = 6.8602e-01, PNorm = 43.0026, GNorm = 4.7559, lr_0 = 4.7706e-04
Loss = 7.5035e-01, PNorm = 43.0089, GNorm = 3.1553, lr_0 = 4.4546e-04
Validation rmse = 0.639880
Epoch 10
Loss = 6.4092e-01, PNorm = 43.0159, GNorm = 1.4472, lr_0 = 4.1596e-04
Validation rmse = 0.637673
Epoch 11
Loss = 6.6198e-01, PNorm = 43.0243, GNorm = 0.8152, lr_0 = 3.8312e-04
Validation rmse = 0.625605
Epoch 12
Loss = 5.8906e-01, PNorm = 43.0301, GNorm = 2.3932, lr_0 = 3.5774e-04
Loss = 6.8333e-01, PNorm = 43.0348, GNorm = 1.6122, lr_0 = 3.3405e-04
Validation rmse = 0.655190
Epoch 13
Loss = 6.2313e-01, PNorm = 43.0391, GNorm = 1.1154, lr_0 = 3.1192e-04
Validation rmse = 0.616181
Epoch 14
Loss = 6.4043e-01, PNorm = 43.0449, GNorm = 1.2220, lr_0 = 2.8730e-04
Validation rmse = 0.612098
Epoch 15
Loss = 6.9318e-01, PNorm = 43.0489, GNorm = 1.8083, lr_0 = 2.6827e-04
Validation rmse = 0.637896
Epoch 16
Loss = 6.9808e-01, PNorm = 43.0529, GNorm = 3.1853, lr_0 = 2.4709e-04
Loss = 6.1318e-01, PNorm = 43.0564, GNorm = 0.6905, lr_0 = 2.3073e-04
Validation rmse = 0.615904
Epoch 17
Loss = 6.2141e-01, PNorm = 43.0606, GNorm = 0.6330, lr_0 = 2.1544e-04
Validation rmse = 0.621818
Epoch 18
Loss = 6.0279e-01, PNorm = 43.0643, GNorm = 5.5016, lr_0 = 1.9844e-04
Validation rmse = 0.623911
Epoch 19
Loss = 6.5807e-01, PNorm = 43.0670, GNorm = 1.2575, lr_0 = 1.8529e-04
Loss = 5.7936e-01, PNorm = 43.0704, GNorm = 1.5054, lr_0 = 1.7302e-04
Loss = 7.0139e-01, PNorm = 43.0709, GNorm = 2.4604, lr_0 = 1.7066e-04
Validation rmse = 0.596182
Epoch 20
Loss = 6.1256e-01, PNorm = 43.0736, GNorm = 1.6805, lr_0 = 1.5936e-04
Validation rmse = 0.611512
Epoch 21
Loss = 6.0398e-01, PNorm = 43.0763, GNorm = 1.6329, lr_0 = 1.4881e-04
Validation rmse = 0.621628
Epoch 22
Loss = 5.9473e-01, PNorm = 43.0791, GNorm = 0.9630, lr_0 = 1.3706e-04
Loss = 6.1751e-01, PNorm = 43.0816, GNorm = 3.5334, lr_0 = 1.2798e-04
Validation rmse = 0.585195
Epoch 23
Loss = 6.3329e-01, PNorm = 43.0830, GNorm = 1.6838, lr_0 = 1.1950e-04
Validation rmse = 0.659437
Epoch 24
Loss = 5.8245e-01, PNorm = 43.0855, GNorm = 2.2848, lr_0 = 1.1007e-04
Validation rmse = 0.586333
Epoch 25
Loss = 6.4069e-01, PNorm = 43.0875, GNorm = 1.5225, lr_0 = 1.0278e-04
Loss = 5.7424e-01, PNorm = 43.0889, GNorm = 1.3436, lr_0 = 1.0000e-04
Validation rmse = 0.641882
Epoch 26
Loss = 6.0302e-01, PNorm = 43.0906, GNorm = 9.7963, lr_0 = 1.0000e-04
Validation rmse = 0.585365
Epoch 27
Loss = 5.9419e-01, PNorm = 43.0929, GNorm = 6.2607, lr_0 = 1.0000e-04
Validation rmse = 0.616377
Epoch 28
Loss = 4.9487e-01, PNorm = 43.0944, GNorm = 0.6845, lr_0 = 1.0000e-04
Validation rmse = 0.598900
Epoch 29
Loss = 5.4715e-01, PNorm = 43.0969, GNorm = 3.8113, lr_0 = 1.0000e-04
Loss = 5.7607e-01, PNorm = 43.0987, GNorm = 1.9933, lr_0 = 1.0000e-04
Validation rmse = 0.602971
Model 0 best validation rmse = 0.585195 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.550695
Ensemble test rmse = 0.550695
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.2397e+00, PNorm = 42.7051, GNorm = 4.3451, lr_0 = 1.0000e-03
Validation rmse = 0.739987
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7732, GNorm = 2.2271, lr_0 = 1.0000e-03
Validation rmse = 0.731943
Epoch 2
Loss = 1.0877e+00, PNorm = 42.8218, GNorm = 0.9670, lr_0 = 9.3377e-04
Validation rmse = 0.734894
Epoch 3
Loss = 9.9266e-01, PNorm = 42.8641, GNorm = 0.7978, lr_0 = 8.6005e-04
Loss = 9.5256e-01, PNorm = 42.8904, GNorm = 0.8127, lr_0 = 8.0309e-04
Validation rmse = 0.712731
Epoch 4
Loss = 9.2066e-01, PNorm = 42.9123, GNorm = 0.8539, lr_0 = 7.4989e-04
Validation rmse = 0.709142
Epoch 5
Loss = 8.8406e-01, PNorm = 42.9353, GNorm = 1.1416, lr_0 = 6.9069e-04
Validation rmse = 0.680690
Epoch 6
Loss = 7.4925e-01, PNorm = 42.9535, GNorm = 1.5808, lr_0 = 6.4495e-04
Loss = 7.6052e-01, PNorm = 42.9681, GNorm = 2.1514, lr_0 = 6.0223e-04
Loss = 8.0949e-01, PNorm = 42.9702, GNorm = 3.8591, lr_0 = 5.9403e-04
Validation rmse = 0.647774
Epoch 7
Loss = 7.6187e-01, PNorm = 42.9801, GNorm = 6.1965, lr_0 = 5.5469e-04
Validation rmse = 0.672715
Epoch 8
Loss = 6.9160e-01, PNorm = 42.9885, GNorm = 0.7782, lr_0 = 5.1795e-04
Validation rmse = 0.610000
Epoch 9
Loss = 6.5049e-01, PNorm = 42.9999, GNorm = 2.1849, lr_0 = 4.7706e-04
Loss = 7.0258e-01, PNorm = 43.0089, GNorm = 2.3798, lr_0 = 4.4546e-04
Validation rmse = 0.587560
Epoch 10
Loss = 6.8335e-01, PNorm = 43.0167, GNorm = 5.4311, lr_0 = 4.1596e-04
Validation rmse = 0.603770
Epoch 11
Loss = 6.7317e-01, PNorm = 43.0229, GNorm = 4.6251, lr_0 = 3.8312e-04
Validation rmse = 0.578627
Epoch 12
Loss = 6.7931e-01, PNorm = 43.0273, GNorm = 1.3787, lr_0 = 3.5774e-04
Loss = 6.9245e-01, PNorm = 43.0323, GNorm = 3.1756, lr_0 = 3.3405e-04
Validation rmse = 0.585299
Epoch 13
Loss = 6.7693e-01, PNorm = 43.0372, GNorm = 3.4536, lr_0 = 3.1192e-04
Validation rmse = 0.615999
Epoch 14
Loss = 6.4988e-01, PNorm = 43.0428, GNorm = 1.0190, lr_0 = 2.8730e-04
Validation rmse = 0.574774
Epoch 15
Loss = 7.1097e-01, PNorm = 43.0481, GNorm = 3.3495, lr_0 = 2.6827e-04
Validation rmse = 0.612132
Epoch 16
Loss = 6.7364e-01, PNorm = 43.0532, GNorm = 4.4836, lr_0 = 2.4709e-04
Loss = 6.3049e-01, PNorm = 43.0574, GNorm = 4.7566, lr_0 = 2.3073e-04
Validation rmse = 0.584084
Epoch 17
Loss = 6.1509e-01, PNorm = 43.0611, GNorm = 1.4510, lr_0 = 2.1544e-04
Validation rmse = 0.573517
Epoch 18
Loss = 5.9461e-01, PNorm = 43.0655, GNorm = 3.0653, lr_0 = 1.9844e-04
Validation rmse = 0.599204
Epoch 19
Loss = 6.9756e-01, PNorm = 43.0687, GNorm = 1.0250, lr_0 = 1.8529e-04
Loss = 6.0571e-01, PNorm = 43.0724, GNorm = 0.9513, lr_0 = 1.7302e-04
Loss = 5.0116e-01, PNorm = 43.0731, GNorm = 2.1925, lr_0 = 1.7066e-04
Validation rmse = 0.562443
Epoch 20
Loss = 6.3437e-01, PNorm = 43.0757, GNorm = 0.6706, lr_0 = 1.5936e-04
Validation rmse = 0.595566
Epoch 21
Loss = 6.4383e-01, PNorm = 43.0783, GNorm = 4.3520, lr_0 = 1.4881e-04
Validation rmse = 0.577388
Epoch 22
Loss = 5.4336e-01, PNorm = 43.0814, GNorm = 0.7071, lr_0 = 1.3706e-04
Loss = 6.0871e-01, PNorm = 43.0838, GNorm = 2.6225, lr_0 = 1.2798e-04
Validation rmse = 0.571578
Epoch 23
Loss = 5.4982e-01, PNorm = 43.0859, GNorm = 1.5660, lr_0 = 1.1950e-04
Validation rmse = 0.575936
Epoch 24
Loss = 5.4719e-01, PNorm = 43.0887, GNorm = 1.2960, lr_0 = 1.1007e-04
Validation rmse = 0.563594
Epoch 25
Loss = 5.7686e-01, PNorm = 43.0907, GNorm = 0.8714, lr_0 = 1.0278e-04
Loss = 5.8000e-01, PNorm = 43.0926, GNorm = 1.2714, lr_0 = 1.0000e-04
Validation rmse = 0.592739
Epoch 26
Loss = 5.7426e-01, PNorm = 43.0946, GNorm = 1.0706, lr_0 = 1.0000e-04
Validation rmse = 0.562046
Epoch 27
Loss = 6.0018e-01, PNorm = 43.0970, GNorm = 1.5731, lr_0 = 1.0000e-04
Validation rmse = 0.572451
Epoch 28
Loss = 6.1981e-01, PNorm = 43.0990, GNorm = 3.8816, lr_0 = 1.0000e-04
Validation rmse = 0.576829
Epoch 29
Loss = 5.5745e-01, PNorm = 43.1014, GNorm = 1.0159, lr_0 = 1.0000e-04
Loss = 5.5445e-01, PNorm = 43.1036, GNorm = 3.4273, lr_0 = 1.0000e-04
Validation rmse = 0.568013
Model 0 best validation rmse = 0.562046 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.508137
Ensemble test rmse = 0.508137
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.3774e+00, PNorm = 42.7061, GNorm = 5.8343, lr_0 = 1.0000e-03
Validation rmse = 0.763242
Epoch 1
Loss = 1.0431e+00, PNorm = 42.7790, GNorm = 1.1057, lr_0 = 1.0000e-03
Validation rmse = 0.756883
Epoch 2
Loss = 9.3458e-01, PNorm = 42.8307, GNorm = 2.0843, lr_0 = 9.3377e-04
Validation rmse = 0.756478
Epoch 3
Loss = 9.0390e-01, PNorm = 42.8733, GNorm = 0.6147, lr_0 = 8.6005e-04
Loss = 9.8708e-01, PNorm = 42.8990, GNorm = 0.6160, lr_0 = 8.0309e-04
Validation rmse = 0.725295
Epoch 4
Loss = 9.2760e-01, PNorm = 42.9189, GNorm = 1.1890, lr_0 = 7.4989e-04
Validation rmse = 0.694345
Epoch 5
Loss = 9.7693e-01, PNorm = 42.9403, GNorm = 4.6737, lr_0 = 6.9069e-04
Validation rmse = 0.788144
Epoch 6
Loss = 8.7397e-01, PNorm = 42.9529, GNorm = 4.7125, lr_0 = 6.4495e-04
Loss = 8.6255e-01, PNorm = 42.9645, GNorm = 0.8467, lr_0 = 6.0223e-04
Loss = 8.6784e-01, PNorm = 42.9665, GNorm = 1.5072, lr_0 = 5.9403e-04
Validation rmse = 0.668027
Epoch 7
Loss = 8.0313e-01, PNorm = 42.9774, GNorm = 1.3361, lr_0 = 5.5469e-04
Validation rmse = 0.660040
Epoch 8
Loss = 7.8535e-01, PNorm = 42.9888, GNorm = 0.6453, lr_0 = 5.1795e-04
Validation rmse = 0.626498
Epoch 9
Loss = 7.0203e-01, PNorm = 43.0021, GNorm = 0.8828, lr_0 = 4.7706e-04
Loss = 7.4251e-01, PNorm = 43.0121, GNorm = 1.1411, lr_0 = 4.4546e-04
Validation rmse = 0.624301
Epoch 10
Loss = 7.0593e-01, PNorm = 43.0207, GNorm = 1.1050, lr_0 = 4.1596e-04
Validation rmse = 0.598134
Epoch 11
Loss = 6.6086e-01, PNorm = 43.0303, GNorm = 0.8967, lr_0 = 3.8312e-04
Validation rmse = 0.588431
Epoch 12
Loss = 5.9163e-01, PNorm = 43.0383, GNorm = 2.5735, lr_0 = 3.5774e-04
Loss = 6.9856e-01, PNorm = 43.0444, GNorm = 4.6835, lr_0 = 3.3405e-04
Validation rmse = 0.656113
Epoch 13
Loss = 6.3540e-01, PNorm = 43.0499, GNorm = 0.6523, lr_0 = 3.1192e-04
Validation rmse = 0.594733
Epoch 14
Loss = 6.8809e-01, PNorm = 43.0556, GNorm = 0.9671, lr_0 = 2.8730e-04
Validation rmse = 0.571263
Epoch 15
Loss = 6.8450e-01, PNorm = 43.0608, GNorm = 1.1000, lr_0 = 2.6827e-04
Validation rmse = 0.583436
Epoch 16
Loss = 6.3063e-01, PNorm = 43.0668, GNorm = 0.8301, lr_0 = 2.4709e-04
Loss = 6.4849e-01, PNorm = 43.0701, GNorm = 4.3707, lr_0 = 2.3073e-04
Validation rmse = 0.615713
Epoch 17
Loss = 5.8072e-01, PNorm = 43.0739, GNorm = 6.3678, lr_0 = 2.1544e-04
Validation rmse = 0.587150
Epoch 18
Loss = 6.1959e-01, PNorm = 43.0778, GNorm = 1.4447, lr_0 = 1.9844e-04
Validation rmse = 0.598975
Epoch 19
Loss = 6.9792e-01, PNorm = 43.0809, GNorm = 0.7804, lr_0 = 1.8529e-04
Loss = 5.9287e-01, PNorm = 43.0835, GNorm = 2.3978, lr_0 = 1.7302e-04
Loss = 5.9395e-01, PNorm = 43.0839, GNorm = 1.2613, lr_0 = 1.7066e-04
Validation rmse = 0.595790
Epoch 20
Loss = 6.3523e-01, PNorm = 43.0865, GNorm = 1.4953, lr_0 = 1.5936e-04
Validation rmse = 0.569106
Epoch 21
Loss = 5.9203e-01, PNorm = 43.0892, GNorm = 0.6730, lr_0 = 1.4881e-04
Validation rmse = 0.585219
Epoch 22
Loss = 5.3178e-01, PNorm = 43.0924, GNorm = 0.7010, lr_0 = 1.3706e-04
Loss = 6.1324e-01, PNorm = 43.0948, GNorm = 2.2216, lr_0 = 1.2798e-04
Validation rmse = 0.587245
Epoch 23
Loss = 6.1809e-01, PNorm = 43.0970, GNorm = 2.4488, lr_0 = 1.1950e-04
Validation rmse = 0.577685
Epoch 24
Loss = 5.9394e-01, PNorm = 43.0990, GNorm = 1.8833, lr_0 = 1.1007e-04
Validation rmse = 0.586700
Epoch 25
Loss = 5.6485e-01, PNorm = 43.1008, GNorm = 1.0313, lr_0 = 1.0278e-04
Loss = 5.7979e-01, PNorm = 43.1022, GNorm = 0.7895, lr_0 = 1.0000e-04
Validation rmse = 0.590766
Epoch 26
Loss = 5.9586e-01, PNorm = 43.1039, GNorm = 1.7561, lr_0 = 1.0000e-04
Validation rmse = 0.573226
Epoch 27
Loss = 5.7204e-01, PNorm = 43.1060, GNorm = 3.2475, lr_0 = 1.0000e-04
Validation rmse = 0.584301
Epoch 28
Loss = 6.3896e-01, PNorm = 43.1077, GNorm = 2.2298, lr_0 = 1.0000e-04
Validation rmse = 0.589364
Epoch 29
Loss = 5.3518e-01, PNorm = 43.1097, GNorm = 1.0869, lr_0 = 1.0000e-04
Loss = 5.7799e-01, PNorm = 43.1116, GNorm = 2.1961, lr_0 = 1.0000e-04
Validation rmse = 0.577583
Model 0 best validation rmse = 0.569106 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.611982
Ensemble test rmse = 0.611982
5-fold cross validation
	Seed 0 ==> test rmse = 0.571357
	Seed 1 ==> test rmse = 0.612690
	Seed 2 ==> test rmse = 0.550695
	Seed 3 ==> test rmse = 0.508137
	Seed 4 ==> test rmse = 0.611982
Overall test rmse = 0.570972 +/- 0.039451
Elapsed time = 0:28:12
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.4,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 7.3125e+00, PNorm = 43.1093, GNorm = 4.2761, lr_0 = 5.5000e-03
Validation rmse = 0.729328
Epoch 1
Loss = 1.0217e+00, PNorm = 45.3693, GNorm = 1.4221, lr_0 = 1.0000e-02
Validation rmse = 0.717383
Epoch 2
Loss = 8.5658e-01, PNorm = 47.6518, GNorm = 0.5879, lr_0 = 8.7192e-03
Validation rmse = 0.697478
Epoch 3
Loss = 8.0158e-01, PNorm = 49.3672, GNorm = 0.7123, lr_0 = 7.3969e-03
Loss = 9.3229e-01, PNorm = 50.1885, GNorm = 0.7603, lr_0 = 6.4495e-03
Validation rmse = 0.657824
Epoch 4
Loss = 8.7985e-01, PNorm = 50.6756, GNorm = 1.1310, lr_0 = 5.6234e-03
Validation rmse = 0.634253
Epoch 5
Loss = 7.5800e-01, PNorm = 51.0043, GNorm = 0.8082, lr_0 = 4.7706e-03
Validation rmse = 0.622103
Epoch 6
Loss = 7.2149e-01, PNorm = 51.1677, GNorm = 0.9990, lr_0 = 4.1596e-03
Loss = 7.5675e-01, PNorm = 51.2673, GNorm = 1.3905, lr_0 = 3.6268e-03
Loss = 8.6241e-01, PNorm = 51.2812, GNorm = 1.5426, lr_0 = 3.5287e-03
Validation rmse = 0.615434
Epoch 7
Loss = 7.4610e-01, PNorm = 51.3344, GNorm = 2.5661, lr_0 = 3.0768e-03
Validation rmse = 0.595745
Epoch 8
Loss = 6.9181e-01, PNorm = 51.3724, GNorm = 0.7866, lr_0 = 2.6827e-03
Validation rmse = 0.588484
Epoch 9
Loss = 6.9891e-01, PNorm = 51.4050, GNorm = 1.1738, lr_0 = 2.2758e-03
Loss = 7.2567e-01, PNorm = 51.4236, GNorm = 5.4066, lr_0 = 1.9844e-03
Validation rmse = 0.594569
Epoch 10
Loss = 7.0573e-01, PNorm = 51.4378, GNorm = 1.3984, lr_0 = 1.7302e-03
Validation rmse = 0.630089
Epoch 11
Loss = 7.2492e-01, PNorm = 51.4486, GNorm = 1.1217, lr_0 = 1.4678e-03
Validation rmse = 0.601178
Epoch 12
Loss = 7.6291e-01, PNorm = 51.4578, GNorm = 1.3946, lr_0 = 1.2798e-03
Loss = 6.7681e-01, PNorm = 51.4683, GNorm = 0.9788, lr_0 = 1.1159e-03
Validation rmse = 0.590206
Epoch 13
Loss = 6.8639e-01, PNorm = 51.4773, GNorm = 1.0185, lr_0 = 9.7296e-04
Validation rmse = 0.574215
Epoch 14
Loss = 7.0642e-01, PNorm = 51.4839, GNorm = 1.0931, lr_0 = 8.2540e-04
Validation rmse = 0.575365
Epoch 15
Loss = 5.9867e-01, PNorm = 51.4886, GNorm = 0.8827, lr_0 = 7.1969e-04
Validation rmse = 0.579677
Epoch 16
Loss = 6.5704e-01, PNorm = 51.4925, GNorm = 0.7514, lr_0 = 6.1054e-04
Loss = 6.5608e-01, PNorm = 51.4947, GNorm = 1.2518, lr_0 = 5.3234e-04
Validation rmse = 0.575755
Epoch 17
Loss = 6.1967e-01, PNorm = 51.4966, GNorm = 0.9961, lr_0 = 4.6416e-04
Validation rmse = 0.575209
Epoch 18
Loss = 5.4438e-01, PNorm = 51.4989, GNorm = 0.5996, lr_0 = 3.9377e-04
Validation rmse = 0.571040
Epoch 19
Loss = 6.6458e-01, PNorm = 51.5003, GNorm = 0.7803, lr_0 = 3.4333e-04
Loss = 6.2555e-01, PNorm = 51.5021, GNorm = 1.9035, lr_0 = 2.9936e-04
Loss = 8.1690e-01, PNorm = 51.5024, GNorm = 1.1406, lr_0 = 2.9126e-04
Validation rmse = 0.569691
Epoch 20
Loss = 6.2385e-01, PNorm = 51.5038, GNorm = 0.8801, lr_0 = 2.5396e-04
Validation rmse = 0.570431
Epoch 21
Loss = 6.1764e-01, PNorm = 51.5050, GNorm = 1.2677, lr_0 = 2.2143e-04
Validation rmse = 0.568842
Epoch 22
Loss = 6.7461e-01, PNorm = 51.5063, GNorm = 1.5075, lr_0 = 1.8785e-04
Loss = 6.0064e-01, PNorm = 51.5071, GNorm = 0.7921, lr_0 = 1.6379e-04
Validation rmse = 0.568093
Epoch 23
Loss = 6.5025e-01, PNorm = 51.5079, GNorm = 0.6579, lr_0 = 1.4281e-04
Validation rmse = 0.569030
Epoch 24
Loss = 6.3982e-01, PNorm = 51.5088, GNorm = 1.3858, lr_0 = 1.2115e-04
Validation rmse = 0.569636
Epoch 25
Loss = 6.5352e-01, PNorm = 51.5094, GNorm = 0.5924, lr_0 = 1.0564e-04
Loss = 6.1834e-01, PNorm = 51.5099, GNorm = 1.3691, lr_0 = 1.0000e-04
Validation rmse = 0.569646
Epoch 26
Loss = 6.0413e-01, PNorm = 51.5103, GNorm = 0.6139, lr_0 = 1.0000e-04
Validation rmse = 0.568330
Epoch 27
Loss = 6.5860e-01, PNorm = 51.5109, GNorm = 1.1060, lr_0 = 1.0000e-04
Validation rmse = 0.568445
Epoch 28
Loss = 6.2529e-01, PNorm = 51.5114, GNorm = 1.4619, lr_0 = 1.0000e-04
Validation rmse = 0.568007
Epoch 29
Loss = 5.8457e-01, PNorm = 51.5117, GNorm = 0.8237, lr_0 = 1.0000e-04
Loss = 6.4885e-01, PNorm = 51.5120, GNorm = 0.5623, lr_0 = 1.0000e-04
Validation rmse = 0.567772
Model 0 best validation rmse = 0.567772 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.570627
Ensemble test rmse = 0.570627
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 9.2039e+00, PNorm = 43.1107, GNorm = 4.6484, lr_0 = 5.5000e-03
Validation rmse = 0.704645
Epoch 1
Loss = 1.0207e+00, PNorm = 45.3888, GNorm = 1.4082, lr_0 = 1.0000e-02
Validation rmse = 0.691254
Epoch 2
Loss = 1.0233e+00, PNorm = 47.6940, GNorm = 0.8650, lr_0 = 8.7192e-03
Validation rmse = 0.678948
Epoch 3
Loss = 7.9576e-01, PNorm = 49.4294, GNorm = 0.5943, lr_0 = 7.3969e-03
Loss = 9.8201e-01, PNorm = 50.2519, GNorm = 0.6992, lr_0 = 6.4495e-03
Validation rmse = 0.660810
Epoch 4
Loss = 9.3589e-01, PNorm = 50.7419, GNorm = 0.7662, lr_0 = 5.6234e-03
Validation rmse = 0.632498
Epoch 5
Loss = 7.8861e-01, PNorm = 51.0850, GNorm = 0.7163, lr_0 = 4.7706e-03
Validation rmse = 0.636770
Epoch 6
Loss = 9.5003e-01, PNorm = 51.2511, GNorm = 1.7462, lr_0 = 4.1596e-03
Loss = 7.8853e-01, PNorm = 51.3569, GNorm = 0.7534, lr_0 = 3.6268e-03
Loss = 8.3892e-01, PNorm = 51.3740, GNorm = 1.9302, lr_0 = 3.5287e-03
Validation rmse = 0.594590
Epoch 7
Loss = 7.8420e-01, PNorm = 51.4404, GNorm = 2.1741, lr_0 = 3.0768e-03
Validation rmse = 0.577728
Epoch 8
Loss = 7.6655e-01, PNorm = 51.4783, GNorm = 0.7082, lr_0 = 2.6827e-03
Validation rmse = 0.561512
Epoch 9
Loss = 6.6127e-01, PNorm = 51.5106, GNorm = 1.3760, lr_0 = 2.2758e-03
Loss = 7.4461e-01, PNorm = 51.5312, GNorm = 1.5433, lr_0 = 1.9844e-03
Validation rmse = 0.549138
Epoch 10
Loss = 7.1546e-01, PNorm = 51.5460, GNorm = 1.3136, lr_0 = 1.7302e-03
Validation rmse = 0.546763
Epoch 11
Loss = 7.2008e-01, PNorm = 51.5598, GNorm = 0.9592, lr_0 = 1.4678e-03
Validation rmse = 0.542867
Epoch 12
Loss = 6.7677e-01, PNorm = 51.5686, GNorm = 0.6090, lr_0 = 1.2798e-03
Loss = 7.1852e-01, PNorm = 51.5762, GNorm = 0.9489, lr_0 = 1.1159e-03
Validation rmse = 0.539695
Epoch 13
Loss = 7.1100e-01, PNorm = 51.5855, GNorm = 0.5814, lr_0 = 9.7296e-04
Validation rmse = 0.533841
Epoch 14
Loss = 6.5940e-01, PNorm = 51.5911, GNorm = 1.8887, lr_0 = 8.2540e-04
Validation rmse = 0.533522
Epoch 15
Loss = 5.6827e-01, PNorm = 51.5960, GNorm = 0.8592, lr_0 = 7.1969e-04
Validation rmse = 0.531900
Epoch 16
Loss = 7.0770e-01, PNorm = 51.6001, GNorm = 1.3374, lr_0 = 6.1054e-04
Loss = 6.5698e-01, PNorm = 51.6028, GNorm = 0.6547, lr_0 = 5.3234e-04
Validation rmse = 0.531526
Epoch 17
Loss = 6.4866e-01, PNorm = 51.6056, GNorm = 1.1193, lr_0 = 4.6416e-04
Validation rmse = 0.528535
Epoch 18
Loss = 6.2268e-01, PNorm = 51.6087, GNorm = 0.6220, lr_0 = 3.9377e-04
Validation rmse = 0.527655
Epoch 19
Loss = 6.9827e-01, PNorm = 51.6107, GNorm = 1.0985, lr_0 = 3.4333e-04
Loss = 6.6802e-01, PNorm = 51.6125, GNorm = 0.7091, lr_0 = 2.9936e-04
Loss = 6.4784e-01, PNorm = 51.6128, GNorm = 0.7361, lr_0 = 2.9126e-04
Validation rmse = 0.527488
Epoch 20
Loss = 6.9363e-01, PNorm = 51.6143, GNorm = 0.4623, lr_0 = 2.5396e-04
Validation rmse = 0.526228
Epoch 21
Loss = 6.0727e-01, PNorm = 51.6153, GNorm = 0.6354, lr_0 = 2.2143e-04
Validation rmse = 0.526031
Epoch 22
Loss = 6.9689e-01, PNorm = 51.6166, GNorm = 1.0717, lr_0 = 1.8785e-04
Loss = 6.1713e-01, PNorm = 51.6175, GNorm = 0.9450, lr_0 = 1.6379e-04
Validation rmse = 0.524796
Epoch 23
Loss = 6.8523e-01, PNorm = 51.6183, GNorm = 0.9066, lr_0 = 1.4281e-04
Validation rmse = 0.524229
Epoch 24
Loss = 6.8840e-01, PNorm = 51.6189, GNorm = 0.9205, lr_0 = 1.2115e-04
Validation rmse = 0.524281
Epoch 25
Loss = 5.8733e-01, PNorm = 51.6194, GNorm = 1.1771, lr_0 = 1.0564e-04
Loss = 6.6176e-01, PNorm = 51.6198, GNorm = 0.7370, lr_0 = 1.0000e-04
Validation rmse = 0.523769
Epoch 26
Loss = 6.6379e-01, PNorm = 51.6202, GNorm = 0.7034, lr_0 = 1.0000e-04
Validation rmse = 0.523485
Epoch 27
Loss = 6.5370e-01, PNorm = 51.6208, GNorm = 0.4794, lr_0 = 1.0000e-04
Validation rmse = 0.523576
Epoch 28
Loss = 7.0507e-01, PNorm = 51.6213, GNorm = 0.8053, lr_0 = 1.0000e-04
Validation rmse = 0.523343
Epoch 29
Loss = 7.6730e-01, PNorm = 51.6219, GNorm = 0.7447, lr_0 = 1.0000e-04
Loss = 6.3612e-01, PNorm = 51.6223, GNorm = 1.3481, lr_0 = 1.0000e-04
Validation rmse = 0.523735
Model 0 best validation rmse = 0.523343 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.612212
Ensemble test rmse = 0.612212
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 6.6174e+00, PNorm = 43.1139, GNorm = 5.3712, lr_0 = 5.5000e-03
Validation rmse = 0.780629
Epoch 1
Loss = 1.1299e+00, PNorm = 45.3910, GNorm = 1.5808, lr_0 = 1.0000e-02
Validation rmse = 0.754516
Epoch 2
Loss = 8.6369e-01, PNorm = 47.6982, GNorm = 0.4742, lr_0 = 8.7192e-03
Validation rmse = 0.731851
Epoch 3
Loss = 9.1085e-01, PNorm = 49.4192, GNorm = 0.6002, lr_0 = 7.3969e-03
Loss = 9.7481e-01, PNorm = 50.2402, GNorm = 1.1389, lr_0 = 6.4495e-03
Validation rmse = 0.709175
Epoch 4
Loss = 9.2151e-01, PNorm = 50.7312, GNorm = 1.5046, lr_0 = 5.6234e-03
Validation rmse = 0.777038
Epoch 5
Loss = 8.7828e-01, PNorm = 51.0649, GNorm = 0.9173, lr_0 = 4.7706e-03
Validation rmse = 0.686300
Epoch 6
Loss = 9.7196e-01, PNorm = 51.2223, GNorm = 0.6625, lr_0 = 4.1596e-03
Loss = 7.6786e-01, PNorm = 51.3256, GNorm = 0.6651, lr_0 = 3.6268e-03
Loss = 5.8295e-01, PNorm = 51.3413, GNorm = 0.6477, lr_0 = 3.5287e-03
Validation rmse = 0.650304
Epoch 7
Loss = 7.1536e-01, PNorm = 51.4009, GNorm = 1.0441, lr_0 = 3.0768e-03
Validation rmse = 0.644365
Epoch 8
Loss = 7.5184e-01, PNorm = 51.4412, GNorm = 2.2663, lr_0 = 2.6827e-03
Validation rmse = 0.642837
Epoch 9
Loss = 6.5342e-01, PNorm = 51.4700, GNorm = 0.4342, lr_0 = 2.2758e-03
Loss = 7.4909e-01, PNorm = 51.4881, GNorm = 1.1005, lr_0 = 1.9844e-03
Validation rmse = 0.630088
Epoch 10
Loss = 6.3994e-01, PNorm = 51.5027, GNorm = 1.1685, lr_0 = 1.7302e-03
Validation rmse = 0.626737
Epoch 11
Loss = 6.5512e-01, PNorm = 51.5168, GNorm = 0.6056, lr_0 = 1.4678e-03
Validation rmse = 0.619592
Epoch 12
Loss = 5.7905e-01, PNorm = 51.5236, GNorm = 0.5011, lr_0 = 1.2798e-03
Loss = 6.8375e-01, PNorm = 51.5284, GNorm = 0.5962, lr_0 = 1.1159e-03
Validation rmse = 0.627570
Epoch 13
Loss = 6.5516e-01, PNorm = 51.5327, GNorm = 0.4871, lr_0 = 9.7296e-04
Validation rmse = 0.621409
Epoch 14
Loss = 6.7735e-01, PNorm = 51.5396, GNorm = 1.1425, lr_0 = 8.2540e-04
Validation rmse = 0.618126
Epoch 15
Loss = 6.8360e-01, PNorm = 51.5433, GNorm = 0.6089, lr_0 = 7.1969e-04
Validation rmse = 0.622727
Epoch 16
Loss = 7.2323e-01, PNorm = 51.5470, GNorm = 0.9619, lr_0 = 6.1054e-04
Loss = 6.4963e-01, PNorm = 51.5497, GNorm = 0.6692, lr_0 = 5.3234e-04
Validation rmse = 0.619932
Epoch 17
Loss = 6.4427e-01, PNorm = 51.5528, GNorm = 0.5018, lr_0 = 4.6416e-04
Validation rmse = 0.614690
Epoch 18
Loss = 6.3427e-01, PNorm = 51.5556, GNorm = 2.1996, lr_0 = 3.9377e-04
Validation rmse = 0.618492
Epoch 19
Loss = 7.0223e-01, PNorm = 51.5573, GNorm = 0.5628, lr_0 = 3.4333e-04
Loss = 6.3254e-01, PNorm = 51.5590, GNorm = 0.8114, lr_0 = 2.9936e-04
Loss = 7.2901e-01, PNorm = 51.5593, GNorm = 0.8159, lr_0 = 2.9126e-04
Validation rmse = 0.618938
Epoch 20
Loss = 6.4986e-01, PNorm = 51.5609, GNorm = 0.9196, lr_0 = 2.5396e-04
Validation rmse = 0.614271
Epoch 21
Loss = 6.4752e-01, PNorm = 51.5620, GNorm = 0.7100, lr_0 = 2.2143e-04
Validation rmse = 0.614830
Epoch 22
Loss = 6.6961e-01, PNorm = 51.5629, GNorm = 0.7962, lr_0 = 1.8785e-04
Loss = 6.7209e-01, PNorm = 51.5634, GNorm = 1.8019, lr_0 = 1.6379e-04
Validation rmse = 0.620501
Epoch 23
Loss = 6.6126e-01, PNorm = 51.5641, GNorm = 0.4385, lr_0 = 1.4281e-04
Validation rmse = 0.613984
Epoch 24
Loss = 6.3614e-01, PNorm = 51.5649, GNorm = 1.1094, lr_0 = 1.2115e-04
Validation rmse = 0.613068
Epoch 25
Loss = 7.4237e-01, PNorm = 51.5654, GNorm = 1.2226, lr_0 = 1.0564e-04
Loss = 6.3341e-01, PNorm = 51.5658, GNorm = 0.9992, lr_0 = 1.0000e-04
Validation rmse = 0.611608
Epoch 26
Loss = 6.6087e-01, PNorm = 51.5660, GNorm = 1.7402, lr_0 = 1.0000e-04
Validation rmse = 0.615523
Epoch 27
Loss = 6.0894e-01, PNorm = 51.5666, GNorm = 0.6454, lr_0 = 1.0000e-04
Validation rmse = 0.616152
Epoch 28
Loss = 5.6738e-01, PNorm = 51.5671, GNorm = 0.9463, lr_0 = 1.0000e-04
Validation rmse = 0.615418
Epoch 29
Loss = 5.9822e-01, PNorm = 51.5677, GNorm = 1.0209, lr_0 = 1.0000e-04
Loss = 6.5502e-01, PNorm = 51.5681, GNorm = 0.9092, lr_0 = 1.0000e-04
Validation rmse = 0.615292
Model 0 best validation rmse = 0.611608 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.540251
Ensemble test rmse = 0.540251
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 6.4132e+00, PNorm = 43.1121, GNorm = 4.1320, lr_0 = 5.5000e-03
Validation rmse = 0.780331
Epoch 1
Loss = 1.0163e+00, PNorm = 45.3830, GNorm = 1.0158, lr_0 = 1.0000e-02
Validation rmse = 0.758902
Epoch 2
Loss = 1.1276e+00, PNorm = 47.6794, GNorm = 0.8078, lr_0 = 8.7192e-03
Validation rmse = 0.717099
Epoch 3
Loss = 9.8398e-01, PNorm = 49.4015, GNorm = 0.6455, lr_0 = 7.3969e-03
Loss = 9.0303e-01, PNorm = 50.2293, GNorm = 1.0977, lr_0 = 6.4495e-03
Validation rmse = 0.668597
Epoch 4
Loss = 8.2168e-01, PNorm = 50.7246, GNorm = 1.8944, lr_0 = 5.6234e-03
Validation rmse = 0.641867
Epoch 5
Loss = 8.2454e-01, PNorm = 51.0486, GNorm = 0.9475, lr_0 = 4.7706e-03
Validation rmse = 0.616074
Epoch 6
Loss = 7.2979e-01, PNorm = 51.2079, GNorm = 1.0344, lr_0 = 4.1596e-03
Loss = 7.1589e-01, PNorm = 51.3066, GNorm = 1.6601, lr_0 = 3.6268e-03
Loss = 7.2427e-01, PNorm = 51.3202, GNorm = 1.7374, lr_0 = 3.5287e-03
Validation rmse = 0.628702
Epoch 7
Loss = 6.8575e-01, PNorm = 51.3778, GNorm = 2.7831, lr_0 = 3.0768e-03
Validation rmse = 0.635751
Epoch 8
Loss = 6.3563e-01, PNorm = 51.4153, GNorm = 1.2538, lr_0 = 2.6827e-03
Validation rmse = 0.607271
Epoch 9
Loss = 6.2873e-01, PNorm = 51.4460, GNorm = 0.8620, lr_0 = 2.2758e-03
Loss = 6.9129e-01, PNorm = 51.4645, GNorm = 1.2174, lr_0 = 1.9844e-03
Validation rmse = 0.604278
Epoch 10
Loss = 6.8204e-01, PNorm = 51.4801, GNorm = 1.8301, lr_0 = 1.7302e-03
Validation rmse = 0.591065
Epoch 11
Loss = 6.8892e-01, PNorm = 51.4866, GNorm = 2.2747, lr_0 = 1.4678e-03
Validation rmse = 0.602763
Epoch 12
Loss = 6.9858e-01, PNorm = 51.4956, GNorm = 1.0186, lr_0 = 1.2798e-03
Loss = 6.5206e-01, PNorm = 51.5025, GNorm = 1.1401, lr_0 = 1.1159e-03
Validation rmse = 0.603168
Epoch 13
Loss = 6.4190e-01, PNorm = 51.5099, GNorm = 0.7310, lr_0 = 9.7296e-04
Validation rmse = 0.591501
Epoch 14
Loss = 6.4373e-01, PNorm = 51.5157, GNorm = 1.2179, lr_0 = 8.2540e-04
Validation rmse = 0.600398
Epoch 15
Loss = 6.7356e-01, PNorm = 51.5190, GNorm = 0.9805, lr_0 = 7.1969e-04
Validation rmse = 0.588237
Epoch 16
Loss = 6.7043e-01, PNorm = 51.5228, GNorm = 1.1324, lr_0 = 6.1054e-04
Loss = 6.4063e-01, PNorm = 51.5246, GNorm = 2.0707, lr_0 = 5.3234e-04
Validation rmse = 0.590346
Epoch 17
Loss = 6.2600e-01, PNorm = 51.5263, GNorm = 0.6179, lr_0 = 4.6416e-04
Validation rmse = 0.594977
Epoch 18
Loss = 6.2446e-01, PNorm = 51.5291, GNorm = 0.7872, lr_0 = 3.9377e-04
Validation rmse = 0.585930
Epoch 19
Loss = 6.8376e-01, PNorm = 51.5309, GNorm = 1.0781, lr_0 = 3.4333e-04
Loss = 6.2498e-01, PNorm = 51.5322, GNorm = 0.7001, lr_0 = 2.9936e-04
Loss = 5.5687e-01, PNorm = 51.5325, GNorm = 2.1859, lr_0 = 2.9126e-04
Validation rmse = 0.590533
Epoch 20
Loss = 6.5989e-01, PNorm = 51.5337, GNorm = 0.5859, lr_0 = 2.5396e-04
Validation rmse = 0.586604
Epoch 21
Loss = 6.7181e-01, PNorm = 51.5347, GNorm = 1.5621, lr_0 = 2.2143e-04
Validation rmse = 0.586900
Epoch 22
Loss = 5.6762e-01, PNorm = 51.5355, GNorm = 0.5725, lr_0 = 1.8785e-04
Loss = 6.3318e-01, PNorm = 51.5362, GNorm = 0.8844, lr_0 = 1.6379e-04
Validation rmse = 0.589911
Epoch 23
Loss = 5.6526e-01, PNorm = 51.5369, GNorm = 0.7756, lr_0 = 1.4281e-04
Validation rmse = 0.590245
Epoch 24
Loss = 5.7167e-01, PNorm = 51.5377, GNorm = 1.5658, lr_0 = 1.2115e-04
Validation rmse = 0.586272
Epoch 25
Loss = 6.2638e-01, PNorm = 51.5383, GNorm = 0.7169, lr_0 = 1.0564e-04
Loss = 6.3515e-01, PNorm = 51.5385, GNorm = 1.0045, lr_0 = 1.0000e-04
Validation rmse = 0.585809
Epoch 26
Loss = 6.2657e-01, PNorm = 51.5388, GNorm = 1.2829, lr_0 = 1.0000e-04
Validation rmse = 0.586899
Epoch 27
Loss = 6.4741e-01, PNorm = 51.5393, GNorm = 1.3788, lr_0 = 1.0000e-04
Validation rmse = 0.585102
Epoch 28
Loss = 6.3150e-01, PNorm = 51.5398, GNorm = 1.5133, lr_0 = 1.0000e-04
Validation rmse = 0.582850
Epoch 29
Loss = 6.4599e-01, PNorm = 51.5403, GNorm = 0.8726, lr_0 = 1.0000e-04
Loss = 5.9915e-01, PNorm = 51.5406, GNorm = 0.8326, lr_0 = 1.0000e-04
Validation rmse = 0.584772
Model 0 best validation rmse = 0.582850 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.512687
Ensemble test rmse = 0.512687
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 7.6574e+00, PNorm = 43.1186, GNorm = 4.4624, lr_0 = 5.5000e-03
Validation rmse = 0.823685
Epoch 1
Loss = 1.0845e+00, PNorm = 45.4437, GNorm = 1.9760, lr_0 = 1.0000e-02
Validation rmse = 0.787524
Epoch 2
Loss = 9.1903e-01, PNorm = 47.8040, GNorm = 0.5782, lr_0 = 8.7192e-03
Validation rmse = 0.735321
Epoch 3
Loss = 9.3076e-01, PNorm = 49.5659, GNorm = 0.8833, lr_0 = 7.3969e-03
Loss = 9.6964e-01, PNorm = 50.4023, GNorm = 0.5234, lr_0 = 6.4495e-03
Validation rmse = 0.695379
Epoch 4
Loss = 8.9271e-01, PNorm = 50.9000, GNorm = 1.5293, lr_0 = 5.6234e-03
Validation rmse = 0.655832
Epoch 5
Loss = 8.9001e-01, PNorm = 51.2405, GNorm = 0.7138, lr_0 = 4.7706e-03
Validation rmse = 0.690028
Epoch 6
Loss = 6.9047e-01, PNorm = 51.4075, GNorm = 1.8167, lr_0 = 4.1596e-03
Loss = 8.1995e-01, PNorm = 51.5107, GNorm = 3.2817, lr_0 = 3.6268e-03
Loss = 9.5446e-01, PNorm = 51.5264, GNorm = 2.4699, lr_0 = 3.5287e-03
Validation rmse = 0.621864
Epoch 7
Loss = 7.9951e-01, PNorm = 51.5837, GNorm = 1.6927, lr_0 = 3.0768e-03
Validation rmse = 0.679463
Epoch 8
Loss = 8.1741e-01, PNorm = 51.6244, GNorm = 1.4218, lr_0 = 2.6827e-03
Validation rmse = 0.607540
Epoch 9
Loss = 7.3541e-01, PNorm = 51.6628, GNorm = 1.5897, lr_0 = 2.2758e-03
Loss = 7.6459e-01, PNorm = 51.6844, GNorm = 0.7820, lr_0 = 1.9844e-03
Validation rmse = 0.636421
Epoch 10
Loss = 7.3321e-01, PNorm = 51.7030, GNorm = 0.5548, lr_0 = 1.7302e-03
Validation rmse = 0.584566
Epoch 11
Loss = 6.8400e-01, PNorm = 51.7171, GNorm = 1.1771, lr_0 = 1.4678e-03
Validation rmse = 0.613426
Epoch 12
Loss = 6.3259e-01, PNorm = 51.7257, GNorm = 0.6539, lr_0 = 1.2798e-03
Loss = 7.3372e-01, PNorm = 51.7338, GNorm = 1.2387, lr_0 = 1.1159e-03
Validation rmse = 0.585622
Epoch 13
Loss = 6.6561e-01, PNorm = 51.7388, GNorm = 0.9261, lr_0 = 9.7296e-04
Validation rmse = 0.601402
Epoch 14
Loss = 7.3994e-01, PNorm = 51.7443, GNorm = 0.6022, lr_0 = 8.2540e-04
Validation rmse = 0.587010
Epoch 15
Loss = 7.3031e-01, PNorm = 51.7487, GNorm = 0.7320, lr_0 = 7.1969e-04
Validation rmse = 0.587182
Epoch 16
Loss = 6.9057e-01, PNorm = 51.7525, GNorm = 1.1051, lr_0 = 6.1054e-04
Loss = 6.6867e-01, PNorm = 51.7545, GNorm = 1.4885, lr_0 = 5.3234e-04
Validation rmse = 0.591136
Epoch 17
Loss = 6.3329e-01, PNorm = 51.7574, GNorm = 1.5427, lr_0 = 4.6416e-04
Validation rmse = 0.580896
Epoch 18
Loss = 6.8347e-01, PNorm = 51.7601, GNorm = 0.8141, lr_0 = 3.9377e-04
Validation rmse = 0.583149
Epoch 19
Loss = 7.3003e-01, PNorm = 51.7616, GNorm = 0.7097, lr_0 = 3.4333e-04
Loss = 6.4327e-01, PNorm = 51.7630, GNorm = 0.6685, lr_0 = 2.9936e-04
Loss = 6.0097e-01, PNorm = 51.7632, GNorm = 0.9691, lr_0 = 2.9126e-04
Validation rmse = 0.586171
Epoch 20
Loss = 6.8674e-01, PNorm = 51.7639, GNorm = 0.7511, lr_0 = 2.5396e-04
Validation rmse = 0.593970
Epoch 21
Loss = 6.6585e-01, PNorm = 51.7650, GNorm = 1.3111, lr_0 = 2.2143e-04
Validation rmse = 0.585478
Epoch 22
Loss = 5.6244e-01, PNorm = 51.7661, GNorm = 0.5099, lr_0 = 1.8785e-04
Loss = 6.7926e-01, PNorm = 51.7669, GNorm = 0.8020, lr_0 = 1.6379e-04
Validation rmse = 0.581891
Epoch 23
Loss = 6.7211e-01, PNorm = 51.7673, GNorm = 0.7858, lr_0 = 1.4281e-04
Validation rmse = 0.585672
Epoch 24
Loss = 6.7205e-01, PNorm = 51.7678, GNorm = 0.8526, lr_0 = 1.2115e-04
Validation rmse = 0.590267
Epoch 25
Loss = 6.5035e-01, PNorm = 51.7682, GNorm = 0.5322, lr_0 = 1.0564e-04
Loss = 6.4249e-01, PNorm = 51.7686, GNorm = 0.6828, lr_0 = 1.0000e-04
Validation rmse = 0.587608
Epoch 26
Loss = 6.5940e-01, PNorm = 51.7690, GNorm = 0.9337, lr_0 = 1.0000e-04
Validation rmse = 0.586009
Epoch 27
Loss = 6.8108e-01, PNorm = 51.7695, GNorm = 1.1061, lr_0 = 1.0000e-04
Validation rmse = 0.584674
Epoch 28
Loss = 7.4296e-01, PNorm = 51.7698, GNorm = 0.8672, lr_0 = 1.0000e-04
Validation rmse = 0.582605
Epoch 29
Loss = 6.3792e-01, PNorm = 51.7701, GNorm = 0.5276, lr_0 = 1.0000e-04
Loss = 6.6998e-01, PNorm = 51.7704, GNorm = 0.6747, lr_0 = 1.0000e-04
Validation rmse = 0.582207
Model 0 best validation rmse = 0.580896 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.605947
Ensemble test rmse = 0.605947
5-fold cross validation
	Seed 0 ==> test rmse = 0.570627
	Seed 1 ==> test rmse = 0.612212
	Seed 2 ==> test rmse = 0.540251
	Seed 3 ==> test rmse = 0.512687
	Seed 4 ==> test rmse = 0.605947
Overall test rmse = 0.568345 +/- 0.038028
Elapsed time = 0:27:42
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.01,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.1,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 5.2663e+07, PNorm = 81.0506, GNorm = 1.3843, lr_0 = 5.5000e-02
Validation rmse = 1.815397
Epoch 1
Loss = 3.2756e+01, PNorm = 166.2491, GNorm = 331.0863, lr_0 = 1.0000e-01
Validation rmse = 1.715186
Epoch 2
Loss = 5.9695e+01, PNorm = 219.9746, GNorm = 328.0217, lr_0 = 8.1417e-02
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715447
Epoch 2
Loss = 8.0487e-01, PNorm = 42.7507, GNorm = 0.7394, lr_0 = 9.3377e-04
Validation rmse = 0.708588
Epoch 3
Loss = 8.5113e-01, PNorm = 42.7825, GNorm = 0.8180, lr_0 = 8.6005e-04
Loss = 9.8843e-01, PNorm = 42.8032, GNorm = 1.0666, lr_0 = 8.0309e-04
Validation rmse = 0.684489
Epoch 4
Loss = 9.4407e-01, PNorm = 42.8219, GNorm = 0.7002, lr_0 = 7.4989e-04
Validation rmse = 0.651962
Epoch 5
Loss = 7.9518e-01, PNorm = 42.8430, GNorm = 0.8147, lr_0 = 6.9069e-04
Validation rmse = 0.623145
Epoch 6
Loss = 7.4120e-01, PNorm = 42.8602, GNorm = 1.0412, lr_0 = 6.4495e-04
Loss = 7.8074e-01, PNorm = 42.8755, GNorm = 2.7053, lr_0 = 6.0223e-04
Loss = 8.3489e-01, PNorm = 42.8777, GNorm = 1.9338, lr_0 = 5.9403e-04
Validation rmse = 0.616748
Epoch 7
Loss = 7.4086e-01, PNorm = 42.8864, GNorm = 4.4054, lr_0 = 5.5469e-04
Validation rmse = 0.602573
Epoch 8
Loss = 7.0457e-01, PNorm = 42.8946, GNorm = 2.1754, lr_0 = 5.1795e-04
Validation rmse = 0.601231
Epoch 9
Loss = 6.6914e-01, PNorm = 42.9046, GNorm = 1.0762, lr_0 = 4.7706e-04
Loss = 6.6757e-01, PNorm = 42.9126, GNorm = 4.3875, lr_0 = 4.4546e-04
Validation rmse = 0.624125
Epoch 10
Loss = 6.3684e-01, PNorm = 42.9194, GNorm = 5.9240, lr_0 = 4.1596e-04
Validation rmse = 0.601339
Epoch 11
Loss = 6.8493e-01, PNorm = 42.9232, GNorm = 2.0348, lr_0 = 3.8312e-04
Validation rmse = 0.585315
Epoch 12
Loss = 6.8623e-01, PNorm = 42.9273, GNorm = 1.7222, lr_0 = 3.5774e-04
Loss = 6.7039e-01, PNorm = 42.9324, GNorm = 1.8731, lr_0 = 3.3405e-04
Validation rmse = 0.582237
Epoch 13
Loss = 6.6420e-01, PNorm = 42.9377, GNorm = 1.2057, lr_0 = 3.1192e-04
Validation rmse = 0.595454
Epoch 14
Loss = 6.8159e-01, PNorm = 42.9433, GNorm = 0.9846, lr_0 = 2.8730e-04
Validation rmse = 0.579271
Epoch 15
Loss = 5.5480e-01, PNorm = 42.9469, GNorm = 3.1158, lr_0 = 2.6827e-04
Validation rmse = 0.577980
Epoch 16
Loss = 6.2479e-01, PNorm = 42.9504, GNorm = 1.3285, lr_0 = 2.4709e-04
Loss = 6.1518e-01, PNorm = 42.9527, GNorm = 1.5005, lr_0 = 2.3073e-04
Validation rmse = 0.575709
Epoch 17
Loss = 5.7437e-01, PNorm = 42.9552, GNorm = 0.8858, lr_0 = 2.1544e-04
Validation rmse = 0.578661
Epoch 18
Loss = 5.0416e-01, PNorm = 42.9579, GNorm = 1.7992, lr_0 = 1.9844e-04
Validation rmse = 0.570862
Epoch 19
Loss = 6.3821e-01, PNorm = 42.9605, GNorm = 3.0865, lr_0 = 1.8529e-04
Loss = 5.9297e-01, PNorm = 42.9632, GNorm = 4.3740, lr_0 = 1.7302e-04
Loss = 7.2890e-01, PNorm = 42.9637, GNorm = 3.0891, lr_0 = 1.7066e-04
Validation rmse = 0.574181
Epoch 20
Loss = 5.8448e-01, PNorm = 42.9655, GNorm = 1.2306, lr_0 = 1.5936e-04
Validation rmse = 0.579921
Epoch 21
Loss = 5.5304e-01, PNorm = 42.9675, GNorm = 3.2840, lr_0 = 1.4881e-04
Validation rmse = 0.570589
Epoch 22
Loss = 6.0437e-01, PNorm = 42.9698, GNorm = 3.2927, lr_0 = 1.3706e-04
Loss = 5.5397e-01, PNorm = 42.9714, GNorm = 1.1944, lr_0 = 1.2798e-04
Validation rmse = 0.574282
Epoch 23
Loss = 6.0504e-01, PNorm = 42.9730, GNorm = 2.1663, lr_0 = 1.1950e-04
Validation rmse = 0.576067
Epoch 24
Loss = 5.7027e-01, PNorm = 42.9747, GNorm = 1.1007, lr_0 = 1.1007e-04
Validation rmse = 0.574619
Epoch 25
Loss = 6.1276e-01, PNorm = 42.9764, GNorm = 0.9364, lr_0 = 1.0278e-04
Loss = 5.7233e-01, PNorm = 42.9776, GNorm = 2.4917, lr_0 = 1.0000e-04
Validation rmse = 0.577679
Epoch 26
Loss = 5.7895e-01, PNorm = 42.9788, GNorm = 2.7188, lr_0 = 1.0000e-04
Validation rmse = 0.569597
Epoch 27
Loss = 6.1566e-01, PNorm = 42.9805, GNorm = 1.4070, lr_0 = 1.0000e-04
Validation rmse = 0.573767
Epoch 28
Loss = 5.3009e-01, PNorm = 42.9813, GNorm = 6.0147, lr_0 = 1.0000e-04
Validation rmse = 0.568470
Epoch 29
Loss = 5.1411e-01, PNorm = 42.9829, GNorm = 2.1339, lr_0 = 1.0000e-04
Loss = 6.0269e-01, PNorm = 42.9841, GNorm = 2.9299, lr_0 = 1.0000e-04
Validation rmse = 0.568607
Model 0 best validation rmse = 0.568470 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.558738
Ensemble test rmse = 0.558738
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.697055
Epoch 2
Loss = 1.0452e+00, PNorm = 42.7495, GNorm = 1.2479, lr_0 = 9.3377e-04
Validation rmse = 0.693144
Epoch 3
Loss = 8.9572e-01, PNorm = 42.7809, GNorm = 1.6347, lr_0 = 8.6005e-04
Loss = 9.9188e-01, PNorm = 42.8000, GNorm = 0.7933, lr_0 = 8.0309e-04
Validation rmse = 0.675681
Epoch 4
Loss = 9.8065e-01, PNorm = 42.8156, GNorm = 0.8143, lr_0 = 7.4989e-04
Validation rmse = 0.664044
Epoch 5
Loss = 7.9354e-01, PNorm = 42.8318, GNorm = 1.5595, lr_0 = 6.9069e-04
Validation rmse = 0.629157
Epoch 6
Loss = 8.8346e-01, PNorm = 42.8456, GNorm = 1.4928, lr_0 = 6.4495e-04
Loss = 8.1587e-01, PNorm = 42.8603, GNorm = 1.2781, lr_0 = 6.0223e-04
Loss = 7.6936e-01, PNorm = 42.8633, GNorm = 2.0556, lr_0 = 5.9403e-04
Validation rmse = 0.595276
Epoch 7
Loss = 7.7725e-01, PNorm = 42.8760, GNorm = 1.0913, lr_0 = 5.5469e-04
Validation rmse = 0.588194
Epoch 8
Loss = 7.8536e-01, PNorm = 42.8851, GNorm = 3.2896, lr_0 = 5.1795e-04
Validation rmse = 0.586777
Epoch 9
Loss = 6.9878e-01, PNorm = 42.8925, GNorm = 3.6494, lr_0 = 4.7706e-04
Loss = 7.5277e-01, PNorm = 42.8980, GNorm = 4.0819, lr_0 = 4.4546e-04
Validation rmse = 0.579362
Epoch 10
Loss = 6.6476e-01, PNorm = 42.9052, GNorm = 1.6136, lr_0 = 4.1596e-04
Validation rmse = 0.564571
Epoch 11
Loss = 6.8695e-01, PNorm = 42.9134, GNorm = 1.9792, lr_0 = 3.8312e-04
Validation rmse = 0.570716
Epoch 12
Loss = 6.5224e-01, PNorm = 42.9194, GNorm = 0.9267, lr_0 = 3.5774e-04
Loss = 7.2791e-01, PNorm = 42.9230, GNorm = 2.6806, lr_0 = 3.3405e-04
Validation rmse = 0.580236
Epoch 13
Loss = 6.6983e-01, PNorm = 42.9281, GNorm = 2.8828, lr_0 = 3.1192e-04
Validation rmse = 0.562129
Epoch 14
Loss = 6.7631e-01, PNorm = 42.9315, GNorm = 6.9046, lr_0 = 2.8730e-04
Validation rmse = 0.559640
Epoch 15
Loss = 6.4654e-01, PNorm = 42.9356, GNorm = 4.9788, lr_0 = 2.6827e-04
Validation rmse = 0.570588
Epoch 16
Loss = 6.9040e-01, PNorm = 42.9386, GNorm = 1.4570, lr_0 = 2.4709e-04
Loss = 6.4366e-01, PNorm = 42.9427, GNorm = 0.7145, lr_0 = 2.3073e-04
Validation rmse = 0.541543
Epoch 17
Loss = 6.4980e-01, PNorm = 42.9460, GNorm = 1.1029, lr_0 = 2.1544e-04
Validation rmse = 0.548159
Epoch 18
Loss = 5.8314e-01, PNorm = 42.9494, GNorm = 2.1729, lr_0 = 1.9844e-04
Validation rmse = 0.541053
Epoch 19
Loss = 6.9420e-01, PNorm = 42.9526, GNorm = 0.8432, lr_0 = 1.8529e-04
Loss = 6.2855e-01, PNorm = 42.9550, GNorm = 2.9874, lr_0 = 1.7302e-04
Loss = 5.8369e-01, PNorm = 42.9554, GNorm = 1.3358, lr_0 = 1.7066e-04
Validation rmse = 0.548293
Epoch 20
Loss = 6.3278e-01, PNorm = 42.9576, GNorm = 2.2793, lr_0 = 1.5936e-04
Validation rmse = 0.544885
Epoch 21
Loss = 5.6064e-01, PNorm = 42.9598, GNorm = 1.0006, lr_0 = 1.4881e-04
Validation rmse = 0.538562
Epoch 22
Loss = 6.4052e-01, PNorm = 42.9623, GNorm = 2.2828, lr_0 = 1.3706e-04
Loss = 5.7620e-01, PNorm = 42.9641, GNorm = 1.1120, lr_0 = 1.2798e-04
Validation rmse = 0.547499
Epoch 23
Loss = 6.2489e-01, PNorm = 42.9660, GNorm = 0.6796, lr_0 = 1.1950e-04
Validation rmse = 0.541677
Epoch 24
Loss = 6.3415e-01, PNorm = 42.9679, GNorm = 1.4635, lr_0 = 1.1007e-04
Validation rmse = 0.539578
Epoch 25
Loss = 5.4053e-01, PNorm = 42.9695, GNorm = 3.3444, lr_0 = 1.0278e-04
Loss = 6.0679e-01, PNorm = 42.9708, GNorm = 1.2789, lr_0 = 1.0000e-04
Validation rmse = 0.540755
Epoch 26
Loss = 6.1915e-01, PNorm = 42.9721, GNorm = 1.1925, lr_0 = 1.0000e-04
Validation rmse = 0.542182
Epoch 27
Loss = 6.1016e-01, PNorm = 42.9736, GNorm = 0.8586, lr_0 = 1.0000e-04
Validation rmse = 0.541266
Epoch 28
Loss = 6.2205e-01, PNorm = 42.9751, GNorm = 1.6679, lr_0 = 1.0000e-04
Validation rmse = 0.542742
Epoch 29
Loss = 6.6923e-01, PNorm = 42.9769, GNorm = 1.4430, lr_0 = 1.0000e-04
Loss = 5.7500e-01, PNorm = 42.9784, GNorm = 2.4009, lr_0 = 1.0000e-04
Validation rmse = 0.546111
Model 0 best validation rmse = 0.538562 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.615220
Ensemble test rmse = 0.615220
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.745014
Epoch 2
Loss = 8.6480e-01, PNorm = 42.7541, GNorm = 0.6907, lr_0 = 9.3377e-04
Validation rmse = 0.732480
Epoch 3
Loss = 9.2699e-01, PNorm = 42.7882, GNorm = 0.6241, lr_0 = 8.6005e-04
Loss = 9.7685e-01, PNorm = 42.8099, GNorm = 0.7089, lr_0 = 8.0309e-04
Validation rmse = 0.727688
Epoch 4
Loss = 9.3093e-01, PNorm = 42.8297, GNorm = 1.4995, lr_0 = 7.4989e-04
Validation rmse = 0.754503
Epoch 5
Loss = 8.4557e-01, PNorm = 42.8504, GNorm = 2.4476, lr_0 = 6.9069e-04
Validation rmse = 0.712809
Epoch 6
Loss = 9.2734e-01, PNorm = 42.8635, GNorm = 1.3516, lr_0 = 6.4495e-04
Loss = 7.5516e-01, PNorm = 42.8767, GNorm = 1.6220, lr_0 = 6.0223e-04
Loss = 6.3021e-01, PNorm = 42.8787, GNorm = 1.0692, lr_0 = 5.9403e-04
Validation rmse = 0.681059
Epoch 7
Loss = 7.0157e-01, PNorm = 42.8888, GNorm = 1.0523, lr_0 = 5.5469e-04
Validation rmse = 0.652395
Epoch 8
Loss = 7.1081e-01, PNorm = 42.8976, GNorm = 1.1103, lr_0 = 5.1795e-04
Validation rmse = 0.634330
Epoch 9
Loss = 6.7770e-01, PNorm = 42.9071, GNorm = 4.3400, lr_0 = 4.7706e-04
Loss = 7.3622e-01, PNorm = 42.9134, GNorm = 3.9563, lr_0 = 4.4546e-04
Validation rmse = 0.650625
Epoch 10
Loss = 6.2309e-01, PNorm = 42.9208, GNorm = 0.8798, lr_0 = 4.1596e-04
Validation rmse = 0.637108
Epoch 11
Loss = 6.3913e-01, PNorm = 42.9297, GNorm = 1.2827, lr_0 = 3.8312e-04
Validation rmse = 0.620600
Epoch 12
Loss = 5.6220e-01, PNorm = 42.9355, GNorm = 1.8147, lr_0 = 3.5774e-04
Loss = 6.6391e-01, PNorm = 42.9402, GNorm = 1.2362, lr_0 = 3.3405e-04
Validation rmse = 0.648329
Epoch 13
Loss = 6.0462e-01, PNorm = 42.9443, GNorm = 1.1426, lr_0 = 3.1192e-04
Validation rmse = 0.615714
Epoch 14
Loss = 6.1554e-01, PNorm = 42.9498, GNorm = 0.8260, lr_0 = 2.8730e-04
Validation rmse = 0.615097
Epoch 15
Loss = 6.8301e-01, PNorm = 42.9541, GNorm = 1.6553, lr_0 = 2.6827e-04
Validation rmse = 0.654201
Epoch 16
Loss = 6.7847e-01, PNorm = 42.9577, GNorm = 2.7978, lr_0 = 2.4709e-04
Loss = 5.9677e-01, PNorm = 42.9607, GNorm = 0.8036, lr_0 = 2.3073e-04
Validation rmse = 0.624268
Epoch 17
Loss = 6.0603e-01, PNorm = 42.9647, GNorm = 0.7444, lr_0 = 2.1544e-04
Validation rmse = 0.641255
Epoch 18
Loss = 5.8953e-01, PNorm = 42.9681, GNorm = 5.5179, lr_0 = 1.9844e-04
Validation rmse = 0.645475
Epoch 19
Loss = 6.5256e-01, PNorm = 42.9703, GNorm = 2.1616, lr_0 = 1.8529e-04
Loss = 5.7974e-01, PNorm = 42.9734, GNorm = 2.0146, lr_0 = 1.7302e-04
Loss = 7.1703e-01, PNorm = 42.9738, GNorm = 1.9822, lr_0 = 1.7066e-04
Validation rmse = 0.599997
Epoch 20
Loss = 5.9001e-01, PNorm = 42.9756, GNorm = 0.9041, lr_0 = 1.5936e-04
Validation rmse = 0.620606
Epoch 21
Loss = 5.7376e-01, PNorm = 42.9779, GNorm = 1.8346, lr_0 = 1.4881e-04
Validation rmse = 0.659861
Epoch 22
Loss = 5.8563e-01, PNorm = 42.9799, GNorm = 1.8335, lr_0 = 1.3706e-04
Loss = 6.1153e-01, PNorm = 42.9823, GNorm = 2.7638, lr_0 = 1.2798e-04
Validation rmse = 0.579832
Epoch 23
Loss = 6.1080e-01, PNorm = 42.9831, GNorm = 1.6801, lr_0 = 1.1950e-04
Validation rmse = 0.692404
Epoch 24
Loss = 5.8252e-01, PNorm = 42.9852, GNorm = 1.6802, lr_0 = 1.1007e-04
Validation rmse = 0.587816
Epoch 25
Loss = 6.4176e-01, PNorm = 42.9869, GNorm = 1.6123, lr_0 = 1.0278e-04
Loss = 5.7966e-01, PNorm = 42.9877, GNorm = 1.2270, lr_0 = 1.0000e-04
Validation rmse = 0.659771
Epoch 26
Loss = 5.7840e-01, PNorm = 42.9890, GNorm = 7.9568, lr_0 = 1.0000e-04
Validation rmse = 0.593303
Epoch 27
Loss = 5.8145e-01, PNorm = 42.9909, GNorm = 5.3887, lr_0 = 1.0000e-04
Validation rmse = 0.627146
Epoch 28
Loss = 4.7976e-01, PNorm = 42.9918, GNorm = 0.7777, lr_0 = 1.0000e-04
Validation rmse = 0.617427
Epoch 29
Loss = 5.3644e-01, PNorm = 42.9938, GNorm = 3.2924, lr_0 = 1.0000e-04
Loss = 5.4825e-01, PNorm = 42.9953, GNorm = 1.6108, lr_0 = 1.0000e-04
Validation rmse = 0.615616
Model 0 best validation rmse = 0.579832 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.540600
Ensemble test rmse = 0.540600
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732287
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7516, GNorm = 0.8283, lr_0 = 9.3377e-04
Validation rmse = 0.724968
Epoch 3
Loss = 9.6774e-01, PNorm = 42.7852, GNorm = 0.8058, lr_0 = 8.6005e-04
Loss = 9.3914e-01, PNorm = 42.8083, GNorm = 0.9354, lr_0 = 8.0309e-04
Validation rmse = 0.692859
Epoch 4
Loss = 9.0352e-01, PNorm = 42.8275, GNorm = 0.9715, lr_0 = 7.4989e-04
Validation rmse = 0.676653
Epoch 5
Loss = 8.7032e-01, PNorm = 42.8492, GNorm = 1.1377, lr_0 = 6.9069e-04
Validation rmse = 0.650986
Epoch 6
Loss = 7.4644e-01, PNorm = 42.8654, GNorm = 1.0085, lr_0 = 6.4495e-04
Loss = 7.5113e-01, PNorm = 42.8778, GNorm = 3.0592, lr_0 = 6.0223e-04
Loss = 7.9329e-01, PNorm = 42.8795, GNorm = 2.8613, lr_0 = 5.9403e-04
Validation rmse = 0.647570
Epoch 7
Loss = 7.6479e-01, PNorm = 42.8892, GNorm = 4.2655, lr_0 = 5.5469e-04
Validation rmse = 0.649186
Epoch 8
Loss = 6.5220e-01, PNorm = 42.8978, GNorm = 1.2345, lr_0 = 5.1795e-04
Validation rmse = 0.590833
Epoch 9
Loss = 6.6616e-01, PNorm = 42.9091, GNorm = 3.3266, lr_0 = 4.7706e-04
Loss = 6.9083e-01, PNorm = 42.9167, GNorm = 1.5630, lr_0 = 4.4546e-04
Validation rmse = 0.574987
Epoch 10
Loss = 6.8607e-01, PNorm = 42.9227, GNorm = 5.0904, lr_0 = 4.1596e-04
Validation rmse = 0.593418
Epoch 11
Loss = 6.5940e-01, PNorm = 42.9286, GNorm = 3.0436, lr_0 = 3.8312e-04
Validation rmse = 0.573596
Epoch 12
Loss = 6.7135e-01, PNorm = 42.9337, GNorm = 1.8743, lr_0 = 3.5774e-04
Loss = 6.6665e-01, PNorm = 42.9390, GNorm = 3.2668, lr_0 = 3.3405e-04
Validation rmse = 0.583987
Epoch 13
Loss = 6.5664e-01, PNorm = 42.9438, GNorm = 3.7455, lr_0 = 3.1192e-04
Validation rmse = 0.626113
Epoch 14
Loss = 6.4508e-01, PNorm = 42.9492, GNorm = 0.7264, lr_0 = 2.8730e-04
Validation rmse = 0.562780
Epoch 15
Loss = 7.0182e-01, PNorm = 42.9543, GNorm = 2.5945, lr_0 = 2.6827e-04
Validation rmse = 0.605249
Epoch 16
Loss = 6.7658e-01, PNorm = 42.9593, GNorm = 3.9114, lr_0 = 2.4709e-04
Loss = 6.2914e-01, PNorm = 42.9632, GNorm = 4.1965, lr_0 = 2.3073e-04
Validation rmse = 0.587026
Epoch 17
Loss = 6.1386e-01, PNorm = 42.9664, GNorm = 1.0943, lr_0 = 2.1544e-04
Validation rmse = 0.570642
Epoch 18
Loss = 5.7743e-01, PNorm = 42.9704, GNorm = 2.9941, lr_0 = 1.9844e-04
Validation rmse = 0.603230
Epoch 19
Loss = 6.5491e-01, PNorm = 42.9730, GNorm = 1.2436, lr_0 = 1.8529e-04
Loss = 6.0316e-01, PNorm = 42.9763, GNorm = 0.8511, lr_0 = 1.7302e-04
Loss = 4.8995e-01, PNorm = 42.9768, GNorm = 1.2689, lr_0 = 1.7066e-04
Validation rmse = 0.553563
Epoch 20
Loss = 6.2179e-01, PNorm = 42.9787, GNorm = 0.8571, lr_0 = 1.5936e-04
Validation rmse = 0.598982
Epoch 21
Loss = 6.4572e-01, PNorm = 42.9809, GNorm = 4.5459, lr_0 = 1.4881e-04
Validation rmse = 0.567650
Epoch 22
Loss = 5.4236e-01, PNorm = 42.9836, GNorm = 0.9194, lr_0 = 1.3706e-04
Loss = 5.8949e-01, PNorm = 42.9856, GNorm = 1.7218, lr_0 = 1.2798e-04
Validation rmse = 0.577125
Epoch 23
Loss = 5.4694e-01, PNorm = 42.9875, GNorm = 1.4612, lr_0 = 1.1950e-04
Validation rmse = 0.570667
Epoch 24
Loss = 5.4388e-01, PNorm = 42.9899, GNorm = 0.8843, lr_0 = 1.1007e-04
Validation rmse = 0.566004
Epoch 25
Loss = 5.7132e-01, PNorm = 42.9915, GNorm = 1.3957, lr_0 = 1.0278e-04
Loss = 5.8223e-01, PNorm = 42.9930, GNorm = 1.3698, lr_0 = 1.0000e-04
Validation rmse = 0.590476
Epoch 26
Loss = 5.7345e-01, PNorm = 42.9946, GNorm = 1.1480, lr_0 = 1.0000e-04
Validation rmse = 0.563667
Epoch 27
Loss = 5.9223e-01, PNorm = 42.9967, GNorm = 1.3229, lr_0 = 1.0000e-04
Validation rmse = 0.571173
Epoch 28
Loss = 6.0937e-01, PNorm = 42.9983, GNorm = 2.8622, lr_0 = 1.0000e-04
Validation rmse = 0.578253
Epoch 29
Loss = 5.4590e-01, PNorm = 43.0001, GNorm = 1.3352, lr_0 = 1.0000e-04
Loss = 5.4714e-01, PNorm = 43.0018, GNorm = 2.7380, lr_0 = 1.0000e-04
Validation rmse = 0.567166
Model 0 best validation rmse = 0.553563 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.509092
Ensemble test rmse = 0.509092
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.6854e+00, PNorm = 42.6832, GNorm = 6.5055, lr_0 = 7.5000e-04
Validation rmse = 0.779950
Epoch 1
Loss = 1.0715e+00, PNorm = 42.7188, GNorm = 1.6002, lr_0 = 1.0000e-03
Validation rmse = 0.764579
Epoch 2
Loss = 9.2654e-01, PNorm = 42.7530, GNorm = 0.9732, lr_0 = 9.3377e-04
Validation rmse = 0.742976
Epoch 3
Loss = 9.2375e-01, PNorm = 42.7852, GNorm = 0.7881, lr_0 = 8.6005e-04
Loss = 9.7017e-01, PNorm = 42.8061, GNorm = 0.7445, lr_0 = 8.0309e-04
Validation rmse = 0.740080
Epoch 4
Loss = 9.0769e-01, PNorm = 42.8242, GNorm = 0.8472, lr_0 = 7.4989e-04
Validation rmse = 0.691824
Epoch 5
Loss = 9.4401e-01, PNorm = 42.8445, GNorm = 1.8134, lr_0 = 6.9069e-04
Validation rmse = 0.761126
Epoch 6
Loss = 8.1456e-01, PNorm = 42.8585, GNorm = 3.7963, lr_0 = 6.4495e-04
Loss = 8.2173e-01, PNorm = 42.8709, GNorm = 1.2023, lr_0 = 6.0223e-04
Loss = 9.0238e-01, PNorm = 42.8731, GNorm = 2.9814, lr_0 = 5.9403e-04
Validation rmse = 0.669339
Epoch 7
Loss = 7.9231e-01, PNorm = 42.8841, GNorm = 2.8026, lr_0 = 5.5469e-04
Validation rmse = 0.674879
Epoch 8
Loss = 7.5719e-01, PNorm = 42.8941, GNorm = 1.7403, lr_0 = 5.1795e-04
Validation rmse = 0.600533
Epoch 9
Loss = 6.8314e-01, PNorm = 42.9044, GNorm = 0.7767, lr_0 = 4.7706e-04
Loss = 7.4529e-01, PNorm = 42.9125, GNorm = 1.1521, lr_0 = 4.4546e-04
Validation rmse = 0.596390
Epoch 10
Loss = 7.0681e-01, PNorm = 42.9193, GNorm = 0.8526, lr_0 = 4.1596e-04
Validation rmse = 0.610619
Epoch 11
Loss = 6.7377e-01, PNorm = 42.9282, GNorm = 2.0053, lr_0 = 3.8312e-04
Validation rmse = 0.612908
Epoch 12
Loss = 5.6888e-01, PNorm = 42.9349, GNorm = 0.6088, lr_0 = 3.5774e-04
Loss = 7.0610e-01, PNorm = 42.9407, GNorm = 1.6145, lr_0 = 3.3405e-04
Validation rmse = 0.625737
Epoch 13
Loss = 6.3175e-01, PNorm = 42.9462, GNorm = 1.8825, lr_0 = 3.1192e-04
Validation rmse = 0.563181
Epoch 14
Loss = 7.0096e-01, PNorm = 42.9512, GNorm = 1.0218, lr_0 = 2.8730e-04
Validation rmse = 0.584562
Epoch 15
Loss = 6.8360e-01, PNorm = 42.9563, GNorm = 1.2391, lr_0 = 2.6827e-04
Validation rmse = 0.611963
Epoch 16
Loss = 6.2911e-01, PNorm = 42.9607, GNorm = 2.5036, lr_0 = 2.4709e-04
Loss = 6.2543e-01, PNorm = 42.9642, GNorm = 1.6521, lr_0 = 2.3073e-04
Validation rmse = 0.580209
Epoch 17
Loss = 5.8802e-01, PNorm = 42.9673, GNorm = 3.4584, lr_0 = 2.1544e-04
Validation rmse = 0.585811
Epoch 18
Loss = 6.1483e-01, PNorm = 42.9712, GNorm = 3.1527, lr_0 = 1.9844e-04
Validation rmse = 0.613035
Epoch 19
Loss = 6.8221e-01, PNorm = 42.9739, GNorm = 0.9879, lr_0 = 1.8529e-04
Loss = 5.9303e-01, PNorm = 42.9770, GNorm = 1.9863, lr_0 = 1.7302e-04
Loss = 5.8525e-01, PNorm = 42.9775, GNorm = 2.1712, lr_0 = 1.7066e-04
Validation rmse = 0.570227
Epoch 20
Loss = 6.3022e-01, PNorm = 42.9798, GNorm = 1.9853, lr_0 = 1.5936e-04
Validation rmse = 0.581600
Epoch 21
Loss = 5.8953e-01, PNorm = 42.9827, GNorm = 0.7531, lr_0 = 1.4881e-04
Validation rmse = 0.578079
Epoch 22
Loss = 5.4615e-01, PNorm = 42.9857, GNorm = 0.7035, lr_0 = 1.3706e-04
Loss = 6.1001e-01, PNorm = 42.9881, GNorm = 1.2397, lr_0 = 1.2798e-04
Validation rmse = 0.584981
Epoch 23
Loss = 6.0172e-01, PNorm = 42.9902, GNorm = 2.0141, lr_0 = 1.1950e-04
Validation rmse = 0.572697
Epoch 24
Loss = 5.9022e-01, PNorm = 42.9921, GNorm = 1.0733, lr_0 = 1.1007e-04
Validation rmse = 0.588081
Epoch 25
Loss = 5.8080e-01, PNorm = 42.9937, GNorm = 0.6415, lr_0 = 1.0278e-04
Loss = 5.7565e-01, PNorm = 42.9951, GNorm = 0.9107, lr_0 = 1.0000e-04
Validation rmse = 0.580123
Epoch 26
Loss = 5.7992e-01, PNorm = 42.9966, GNorm = 1.6194, lr_0 = 1.0000e-04
Validation rmse = 0.578048
Epoch 27
Loss = 5.6540e-01, PNorm = 42.9986, GNorm = 2.4857, lr_0 = 1.0000e-04
Validation rmse = 0.572529
Epoch 28
Loss = 6.1825e-01, PNorm = 43.0002, GNorm = 2.3043, lr_0 = 1.0000e-04
Validation rmse = 0.588287
Epoch 29
Loss = 5.5521e-01, PNorm = 43.0021, GNorm = 2.0182, lr_0 = 1.0000e-04
Loss = 5.7663e-01, PNorm = 43.0038, GNorm = 1.2371, lr_0 = 1.0000e-04
Validation rmse = 0.570823
Model 0 best validation rmse = 0.563181 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.626215
Ensemble test rmse = 0.626215
5-fold cross validation
	Seed 0 ==> test rmse = 0.558738
	Seed 1 ==> test rmse = 0.615220
	Seed 2 ==> test rmse = 0.540600
	Seed 3 ==> test rmse = 0.509092
	Seed 4 ==> test rmse = 0.626215
Overall test rmse = 0.569973 +/- 0.044511
Elapsed time = 0:28:32
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-ae47c90f-ab99-4077-88bb-db5c1df6cec6.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.0558e+01, PNorm = 43.1054, GNorm = 3.5787, lr_0 = 5.5000e-03
Validation rmse = 0.727148
Epoch 1
Loss = 1.0159e+00, PNorm = 45.4048, GNorm = 0.4294, lr_0 = 1.0000e-02
Validation rmse = 0.715011
Epoch 2
Loss = 8.1595e-01, PNorm = 47.7536, GNorm = 0.7059, lr_0 = 8.7192e-03
Validation rmse = 0.689715
Epoch 3
Loss = 8.1519e-01, PNorm = 49.5247, GNorm = 1.2472, lr_0 = 7.3969e-03
Loss = 8.9003e-01, PNorm = 50.3906, GNorm = 0.7040, lr_0 = 6.4495e-03
Validation rmse = 0.636144
Epoch 4
Loss = 9.9620e-01, PNorm = 50.8881, GNorm = 5.0738, lr_0 = 5.6234e-03
Validation rmse = 0.708008
Epoch 5
Loss = 8.4951e-01, PNorm = 51.2202, GNorm = 1.6759, lr_0 = 4.7706e-03
Validation rmse = 0.669654
Epoch 6
Loss = 8.0021e-01, PNorm = 51.3840, GNorm = 0.8104, lr_0 = 4.1596e-03
Loss = 8.5873e-01, PNorm = 51.4982, GNorm = 0.9167, lr_0 = 3.6268e-03
Loss = 7.9479e-01, PNorm = 51.5167, GNorm = 0.6034, lr_0 = 3.5287e-03
Validation rmse = 0.648571
Epoch 7
Loss = 7.9035e-01, PNorm = 51.5918, GNorm = 1.9311, lr_0 = 3.0768e-03
Validation rmse = 0.620241
Epoch 8
Loss = 7.0333e-01, PNorm = 51.6398, GNorm = 0.6762, lr_0 = 2.6827e-03
Validation rmse = 0.617467
Epoch 9
Loss = 6.9336e-01, PNorm = 51.6816, GNorm = 1.0702, lr_0 = 2.2758e-03
Loss = 7.2758e-01, PNorm = 51.7005, GNorm = 2.5951, lr_0 = 1.9844e-03
Validation rmse = 0.599498
Epoch 10
Loss = 7.3391e-01, PNorm = 51.7161, GNorm = 2.5147, lr_0 = 1.7302e-03
Validation rmse = 0.607116
Epoch 11
Loss = 7.2926e-01, PNorm = 51.7343, GNorm = 2.1236, lr_0 = 1.4678e-03
Validation rmse = 0.601011
Epoch 12
Loss = 7.1996e-01, PNorm = 51.7440, GNorm = 0.4543, lr_0 = 1.2798e-03
Loss = 6.9043e-01, PNorm = 51.7546, GNorm = 1.1323, lr_0 = 1.1159e-03
Validation rmse = 0.590645
Epoch 13
Loss = 6.8132e-01, PNorm = 51.7674, GNorm = 0.3364, lr_0 = 9.7296e-04
Validation rmse = 0.602014
Epoch 14
Loss = 7.0825e-01, PNorm = 51.7772, GNorm = 1.2075, lr_0 = 8.2540e-04
Validation rmse = 0.586343
Epoch 15
Loss = 6.1475e-01, PNorm = 51.7829, GNorm = 1.5195, lr_0 = 7.1969e-04
Validation rmse = 0.585199
Epoch 16
Loss = 6.9804e-01, PNorm = 51.7896, GNorm = 1.0636, lr_0 = 6.1054e-04
Loss = 6.5225e-01, PNorm = 51.7944, GNorm = 0.6989, lr_0 = 5.3234e-04
Validation rmse = 0.586811
Epoch 17
Loss = 6.1597e-01, PNorm = 51.7981, GNorm = 0.5040, lr_0 = 4.6416e-04
Validation rmse = 0.583729
Epoch 18
Loss = 5.4842e-01, PNorm = 51.8018, GNorm = 0.4066, lr_0 = 3.9377e-04
Validation rmse = 0.578623
Epoch 19
Loss = 6.4509e-01, PNorm = 51.8046, GNorm = 0.5515, lr_0 = 3.4333e-04
Loss = 6.3444e-01, PNorm = 51.8076, GNorm = 0.8283, lr_0 = 2.9936e-04
Loss = 7.7682e-01, PNorm = 51.8080, GNorm = 1.4716, lr_0 = 2.9126e-04
Validation rmse = 0.578283
Epoch 20
Loss = 6.5460e-01, PNorm = 51.8099, GNorm = 0.9374, lr_0 = 2.5396e-04
Validation rmse = 0.577893
Epoch 21
Loss = 6.2218e-01, PNorm = 51.8118, GNorm = 1.1405, lr_0 = 2.2143e-04
Validation rmse = 0.578353
Epoch 22
Loss = 6.9323e-01, PNorm = 51.8138, GNorm = 0.8912, lr_0 = 1.8785e-04
Loss = 6.1527e-01, PNorm = 51.8152, GNorm = 0.4489, lr_0 = 1.6379e-04
Validation rmse = 0.577973
Epoch 23
Loss = 6.3657e-01, PNorm = 51.8164, GNorm = 0.6545, lr_0 = 1.4281e-04
Validation rmse = 0.577428
Epoch 24
Loss = 6.5346e-01, PNorm = 51.8176, GNorm = 0.9597, lr_0 = 1.2115e-04
Validation rmse = 0.576555
Epoch 25
Loss = 6.9032e-01, PNorm = 51.8186, GNorm = 0.6119, lr_0 = 1.0564e-04
Loss = 6.3721e-01, PNorm = 51.8194, GNorm = 1.1047, lr_0 = 1.0000e-04
Validation rmse = 0.576943
Epoch 26
Loss = 6.1913e-01, PNorm = 51.8202, GNorm = 0.4293, lr_0 = 1.0000e-04
Validation rmse = 0.576019
Epoch 27
Loss = 6.7856e-01, PNorm = 51.8212, GNorm = 0.8852, lr_0 = 1.0000e-04
Validation rmse = 0.576353
Epoch 28
Loss = 6.0630e-01, PNorm = 51.8220, GNorm = 0.9293, lr_0 = 1.0000e-04
Validation rmse = 0.574880
Epoch 29
Loss = 5.3097e-01, PNorm = 51.8228, GNorm = 0.5291, lr_0 = 1.0000e-04
Loss = 6.5409e-01, PNorm = 51.8234, GNorm = 0.4795, lr_0 = 1.0000e-04
Validation rmse = 0.573868
Model 0 best validation rmse = 0.573868 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.584408
Ensemble test rmse = 0.584408
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.1126e+01, PNorm = 43.1098, GNorm = 3.6634, lr_0 = 5.5000e-03
Validation rmse = 0.707290
Epoch 1
Loss = 1.1103e+00, PNorm = 45.4117, GNorm = 2.4044, lr_0 = 1.0000e-02
Validation rmse = 0.704047
Epoch 2
Loss = 1.0389e+00, PNorm = 47.7674, GNorm = 0.2644, lr_0 = 8.7192e-03
Validation rmse = 0.696317
Epoch 3
Loss = 8.5461e-01, PNorm = 49.5264, GNorm = 0.5274, lr_0 = 7.3969e-03
Loss = 1.0449e+00, PNorm = 50.3495, GNorm = 0.4496, lr_0 = 6.4495e-03
Validation rmse = 0.696189
Epoch 4
Loss = 1.0024e+00, PNorm = 50.8289, GNorm = 0.3419, lr_0 = 5.6234e-03
Validation rmse = 0.686831
Epoch 5
Loss = 8.2621e-01, PNorm = 51.1529, GNorm = 0.7046, lr_0 = 4.7706e-03
Validation rmse = 0.663469
Epoch 6
Loss = 1.0134e+00, PNorm = 51.3124, GNorm = 2.7689, lr_0 = 4.1596e-03
Loss = 8.5792e-01, PNorm = 51.4184, GNorm = 0.6098, lr_0 = 3.6268e-03
Loss = 8.3152e-01, PNorm = 51.4358, GNorm = 0.6372, lr_0 = 3.5287e-03
Validation rmse = 0.664923
Epoch 7
Loss = 8.2047e-01, PNorm = 51.5050, GNorm = 1.0399, lr_0 = 3.0768e-03
Validation rmse = 0.608906
Epoch 8
Loss = 8.4194e-01, PNorm = 51.5499, GNorm = 2.5067, lr_0 = 2.6827e-03
Validation rmse = 0.602319
Epoch 9
Loss = 7.2828e-01, PNorm = 51.5869, GNorm = 1.2114, lr_0 = 2.2758e-03
Loss = 7.8110e-01, PNorm = 51.6118, GNorm = 1.4947, lr_0 = 1.9844e-03
Validation rmse = 0.592055
Epoch 10
Loss = 7.1069e-01, PNorm = 51.6327, GNorm = 0.8551, lr_0 = 1.7302e-03
Validation rmse = 0.584363
Epoch 11
Loss = 7.2734e-01, PNorm = 51.6508, GNorm = 1.9484, lr_0 = 1.4678e-03
Validation rmse = 0.578322
Epoch 12
Loss = 7.0015e-01, PNorm = 51.6600, GNorm = 0.6020, lr_0 = 1.2798e-03
Loss = 7.5905e-01, PNorm = 51.6673, GNorm = 0.7494, lr_0 = 1.1159e-03
Validation rmse = 0.571062
Epoch 13
Loss = 7.0773e-01, PNorm = 51.6759, GNorm = 0.4363, lr_0 = 9.7296e-04
Validation rmse = 0.566695
Epoch 14
Loss = 6.6529e-01, PNorm = 51.6838, GNorm = 3.1525, lr_0 = 8.2540e-04
Validation rmse = 0.564256
Epoch 15
Loss = 6.0973e-01, PNorm = 51.6894, GNorm = 0.9057, lr_0 = 7.1969e-04
Validation rmse = 0.562677
Epoch 16
Loss = 7.3168e-01, PNorm = 51.6951, GNorm = 1.4639, lr_0 = 6.1054e-04
Loss = 6.4799e-01, PNorm = 51.6991, GNorm = 0.6482, lr_0 = 5.3234e-04
Validation rmse = 0.561804
Epoch 17
Loss = 6.6462e-01, PNorm = 51.7030, GNorm = 1.9630, lr_0 = 4.6416e-04
Validation rmse = 0.559582
Epoch 18
Loss = 6.2640e-01, PNorm = 51.7068, GNorm = 0.5343, lr_0 = 3.9377e-04
Validation rmse = 0.557210
Epoch 19
Loss = 7.1401e-01, PNorm = 51.7095, GNorm = 1.1693, lr_0 = 3.4333e-04
Loss = 6.6901e-01, PNorm = 51.7121, GNorm = 2.0132, lr_0 = 2.9936e-04
Loss = 6.6074e-01, PNorm = 51.7125, GNorm = 1.0807, lr_0 = 2.9126e-04
Validation rmse = 0.555660
Epoch 20
Loss = 6.8143e-01, PNorm = 51.7146, GNorm = 0.5719, lr_0 = 2.5396e-04
Validation rmse = 0.554992
Epoch 21
Loss = 6.1103e-01, PNorm = 51.7162, GNorm = 0.9348, lr_0 = 2.2143e-04
Validation rmse = 0.553938
Epoch 22
Loss = 7.3822e-01, PNorm = 51.7181, GNorm = 1.3654, lr_0 = 1.8785e-04
Loss = 6.1780e-01, PNorm = 51.7195, GNorm = 0.5443, lr_0 = 1.6379e-04
Validation rmse = 0.553252
Epoch 23
Loss = 6.8673e-01, PNorm = 51.7207, GNorm = 0.6637, lr_0 = 1.4281e-04
Validation rmse = 0.552655
Epoch 24
Loss = 6.7763e-01, PNorm = 51.7219, GNorm = 0.9304, lr_0 = 1.2115e-04
Validation rmse = 0.552590
Epoch 25
Loss = 6.0289e-01, PNorm = 51.7227, GNorm = 1.3625, lr_0 = 1.0564e-04
Loss = 6.6424e-01, PNorm = 51.7235, GNorm = 0.7860, lr_0 = 1.0000e-04
Validation rmse = 0.551809
Epoch 26
Loss = 6.5044e-01, PNorm = 51.7242, GNorm = 1.2211, lr_0 = 1.0000e-04
Validation rmse = 0.551492
Epoch 27
Loss = 6.5280e-01, PNorm = 51.7251, GNorm = 0.4649, lr_0 = 1.0000e-04
Validation rmse = 0.551227
Epoch 28
Loss = 7.2566e-01, PNorm = 51.7259, GNorm = 1.4246, lr_0 = 1.0000e-04
Validation rmse = 0.551148
Epoch 29
Loss = 8.1283e-01, PNorm = 51.7269, GNorm = 0.6549, lr_0 = 1.0000e-04
Loss = 6.4045e-01, PNorm = 51.7276, GNorm = 1.7434, lr_0 = 1.0000e-04
Validation rmse = 0.550855
Model 0 best validation rmse = 0.550855 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.621738
Ensemble test rmse = 0.621738
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.0315e+01, PNorm = 43.1190, GNorm = 4.9136, lr_0 = 5.5000e-03
Validation rmse = 0.762047
Epoch 1
Loss = 1.1242e+00, PNorm = 45.4571, GNorm = 0.4757, lr_0 = 1.0000e-02
Validation rmse = 0.736206
Epoch 2
Loss = 8.7263e-01, PNorm = 47.8397, GNorm = 0.6845, lr_0 = 8.7192e-03
Validation rmse = 0.720932
Epoch 3
Loss = 8.9477e-01, PNorm = 49.6374, GNorm = 1.6164, lr_0 = 7.3969e-03
Loss = 8.8977e-01, PNorm = 50.5101, GNorm = 1.0186, lr_0 = 6.4495e-03
Validation rmse = 0.693960
Epoch 4
Loss = 8.2867e-01, PNorm = 51.0176, GNorm = 1.3648, lr_0 = 5.6234e-03
Validation rmse = 0.695880
Epoch 5
Loss = 7.5407e-01, PNorm = 51.3785, GNorm = 0.5946, lr_0 = 4.7706e-03
Validation rmse = 0.642873
Epoch 6
Loss = 9.1246e-01, PNorm = 51.5532, GNorm = 1.5150, lr_0 = 4.1596e-03
Loss = 7.0329e-01, PNorm = 51.6555, GNorm = 1.4482, lr_0 = 3.6268e-03
Loss = 5.3668e-01, PNorm = 51.6698, GNorm = 0.5819, lr_0 = 3.5287e-03
Validation rmse = 0.631377
Epoch 7
Loss = 6.5137e-01, PNorm = 51.7306, GNorm = 1.2240, lr_0 = 3.0768e-03
Validation rmse = 0.629032
Epoch 8
Loss = 7.1412e-01, PNorm = 51.7748, GNorm = 1.1716, lr_0 = 2.6827e-03
Validation rmse = 0.622232
Epoch 9
Loss = 6.4519e-01, PNorm = 51.8162, GNorm = 3.0818, lr_0 = 2.2758e-03
Loss = 7.0952e-01, PNorm = 51.8385, GNorm = 2.5063, lr_0 = 1.9844e-03
Validation rmse = 0.655851
Epoch 10
Loss = 6.1207e-01, PNorm = 51.8611, GNorm = 0.4222, lr_0 = 1.7302e-03
Validation rmse = 0.613690
Epoch 11
Loss = 6.4704e-01, PNorm = 51.8797, GNorm = 0.5254, lr_0 = 1.4678e-03
Validation rmse = 0.617391
Epoch 12
Loss = 5.6059e-01, PNorm = 51.8907, GNorm = 0.3408, lr_0 = 1.2798e-03
Loss = 6.6957e-01, PNorm = 51.8992, GNorm = 0.8756, lr_0 = 1.1159e-03
Validation rmse = 0.609759
Epoch 13
Loss = 6.1056e-01, PNorm = 51.9067, GNorm = 1.0287, lr_0 = 9.7296e-04
Validation rmse = 0.614130
Epoch 14
Loss = 6.2194e-01, PNorm = 51.9190, GNorm = 1.1213, lr_0 = 8.2540e-04
Validation rmse = 0.603103
Epoch 15
Loss = 6.8727e-01, PNorm = 51.9261, GNorm = 0.7017, lr_0 = 7.1969e-04
Validation rmse = 0.614624
Epoch 16
Loss = 6.9882e-01, PNorm = 51.9324, GNorm = 0.9700, lr_0 = 6.1054e-04
Loss = 6.0873e-01, PNorm = 51.9373, GNorm = 1.1611, lr_0 = 5.3234e-04
Validation rmse = 0.606073
Epoch 17
Loss = 6.0396e-01, PNorm = 51.9423, GNorm = 0.6214, lr_0 = 4.6416e-04
Validation rmse = 0.601956
Epoch 18
Loss = 6.0008e-01, PNorm = 51.9466, GNorm = 1.8003, lr_0 = 3.9377e-04
Validation rmse = 0.609207
Epoch 19
Loss = 6.3599e-01, PNorm = 51.9497, GNorm = 0.3522, lr_0 = 3.4333e-04
Loss = 6.0470e-01, PNorm = 51.9532, GNorm = 0.6122, lr_0 = 2.9936e-04
Loss = 7.3084e-01, PNorm = 51.9538, GNorm = 0.6055, lr_0 = 2.9126e-04
Validation rmse = 0.604011
Epoch 20
Loss = 6.1327e-01, PNorm = 51.9566, GNorm = 1.1188, lr_0 = 2.5396e-04
Validation rmse = 0.600302
Epoch 21
Loss = 6.0549e-01, PNorm = 51.9586, GNorm = 0.7694, lr_0 = 2.2143e-04
Validation rmse = 0.603173
Epoch 22
Loss = 6.1069e-01, PNorm = 51.9607, GNorm = 0.8441, lr_0 = 1.8785e-04
Loss = 6.3827e-01, PNorm = 51.9622, GNorm = 2.1946, lr_0 = 1.6379e-04
Validation rmse = 0.605990
Epoch 23
Loss = 6.1359e-01, PNorm = 51.9638, GNorm = 0.4331, lr_0 = 1.4281e-04
Validation rmse = 0.598461
Epoch 24
Loss = 5.8535e-01, PNorm = 51.9656, GNorm = 1.4139, lr_0 = 1.2115e-04
Validation rmse = 0.598298
Epoch 25
Loss = 6.7158e-01, PNorm = 51.9668, GNorm = 1.0597, lr_0 = 1.0564e-04
Loss = 5.7819e-01, PNorm = 51.9677, GNorm = 1.0254, lr_0 = 1.0000e-04
Validation rmse = 0.598505
Epoch 26
Loss = 5.9230e-01, PNorm = 51.9685, GNorm = 2.0517, lr_0 = 1.0000e-04
Validation rmse = 0.603231
Epoch 27
Loss = 5.6957e-01, PNorm = 51.9697, GNorm = 0.7065, lr_0 = 1.0000e-04
Validation rmse = 0.603351
Epoch 28
Loss = 5.3673e-01, PNorm = 51.9707, GNorm = 1.0252, lr_0 = 1.0000e-04
Validation rmse = 0.601209
Epoch 29
Loss = 6.0167e-01, PNorm = 51.9720, GNorm = 1.2209, lr_0 = 1.0000e-04
Loss = 5.9611e-01, PNorm = 51.9729, GNorm = 1.1568, lr_0 = 1.0000e-04
Validation rmse = 0.599786
Model 0 best validation rmse = 0.598298 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.539892
Ensemble test rmse = 0.539892
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 8.7004e+00, PNorm = 43.1082, GNorm = 2.4809, lr_0 = 5.5000e-03
Validation rmse = 0.742495
Epoch 1
Loss = 1.0202e+00, PNorm = 45.4002, GNorm = 0.5841, lr_0 = 1.0000e-02
Validation rmse = 0.768613
Epoch 2
Loss = 1.1178e+00, PNorm = 47.7491, GNorm = 1.2576, lr_0 = 8.7192e-03
Validation rmse = 0.721177
Epoch 3
Loss = 9.7467e-01, PNorm = 49.5248, GNorm = 0.6734, lr_0 = 7.3969e-03
Loss = 8.8460e-01, PNorm = 50.3843, GNorm = 0.5675, lr_0 = 6.4495e-03
Validation rmse = 0.671395
Epoch 4
Loss = 7.7417e-01, PNorm = 50.9042, GNorm = 0.5616, lr_0 = 5.6234e-03
Validation rmse = 0.628412
Epoch 5
Loss = 8.3497e-01, PNorm = 51.2380, GNorm = 0.7746, lr_0 = 4.7706e-03
Validation rmse = 0.626977
Epoch 6
Loss = 7.1934e-01, PNorm = 51.4055, GNorm = 1.9592, lr_0 = 4.1596e-03
Loss = 7.3668e-01, PNorm = 51.5154, GNorm = 0.5644, lr_0 = 3.6268e-03
Loss = 8.0629e-01, PNorm = 51.5320, GNorm = 2.1986, lr_0 = 3.5287e-03
Validation rmse = 0.610286
Epoch 7
Loss = 6.8611e-01, PNorm = 51.5989, GNorm = 0.4578, lr_0 = 3.0768e-03
Validation rmse = 0.598981
Epoch 8
Loss = 6.2681e-01, PNorm = 51.6430, GNorm = 0.4267, lr_0 = 2.6827e-03
Validation rmse = 0.598727
Epoch 9
Loss = 7.0897e-01, PNorm = 51.6792, GNorm = 3.2828, lr_0 = 2.2758e-03
Loss = 6.9702e-01, PNorm = 51.6999, GNorm = 1.9791, lr_0 = 1.9844e-03
Validation rmse = 0.608570
Epoch 10
Loss = 6.6614e-01, PNorm = 51.7210, GNorm = 0.5084, lr_0 = 1.7302e-03
Validation rmse = 0.594467
Epoch 11
Loss = 6.7800e-01, PNorm = 51.7358, GNorm = 3.0573, lr_0 = 1.4678e-03
Validation rmse = 0.592792
Epoch 12
Loss = 6.7564e-01, PNorm = 51.7480, GNorm = 1.5904, lr_0 = 1.2798e-03
Loss = 6.5072e-01, PNorm = 51.7563, GNorm = 1.7503, lr_0 = 1.1159e-03
Validation rmse = 0.598946
Epoch 13
Loss = 6.5004e-01, PNorm = 51.7653, GNorm = 0.8159, lr_0 = 9.7296e-04
Validation rmse = 0.585942
Epoch 14
Loss = 6.4329e-01, PNorm = 51.7741, GNorm = 0.8966, lr_0 = 8.2540e-04
Validation rmse = 0.589095
Epoch 15
Loss = 6.6566e-01, PNorm = 51.7809, GNorm = 0.5109, lr_0 = 7.1969e-04
Validation rmse = 0.585155
Epoch 16
Loss = 6.4214e-01, PNorm = 51.7882, GNorm = 1.3127, lr_0 = 6.1054e-04
Loss = 6.2053e-01, PNorm = 51.7929, GNorm = 1.5203, lr_0 = 5.3234e-04
Validation rmse = 0.580895
Epoch 17
Loss = 6.2215e-01, PNorm = 51.7971, GNorm = 0.4923, lr_0 = 4.6416e-04
Validation rmse = 0.581490
Epoch 18
Loss = 6.1224e-01, PNorm = 51.8013, GNorm = 0.7551, lr_0 = 3.9377e-04
Validation rmse = 0.578194
Epoch 19
Loss = 6.5902e-01, PNorm = 51.8042, GNorm = 0.6877, lr_0 = 3.4333e-04
Loss = 6.0222e-01, PNorm = 51.8067, GNorm = 0.6604, lr_0 = 2.9936e-04
Loss = 5.2759e-01, PNorm = 51.8072, GNorm = 2.1773, lr_0 = 2.9126e-04
Validation rmse = 0.581730
Epoch 20
Loss = 6.2876e-01, PNorm = 51.8096, GNorm = 0.6786, lr_0 = 2.5396e-04
Validation rmse = 0.576191
Epoch 21
Loss = 6.3209e-01, PNorm = 51.8117, GNorm = 1.0489, lr_0 = 2.2143e-04
Validation rmse = 0.576535
Epoch 22
Loss = 5.8272e-01, PNorm = 51.8134, GNorm = 0.4339, lr_0 = 1.8785e-04
Loss = 6.3011e-01, PNorm = 51.8147, GNorm = 0.9106, lr_0 = 1.6379e-04
Validation rmse = 0.578566
Epoch 23
Loss = 5.6967e-01, PNorm = 51.8159, GNorm = 0.4904, lr_0 = 1.4281e-04
Validation rmse = 0.578300
Epoch 24
Loss = 5.6247e-01, PNorm = 51.8175, GNorm = 0.8167, lr_0 = 1.2115e-04
Validation rmse = 0.575568
Epoch 25
Loss = 5.9382e-01, PNorm = 51.8186, GNorm = 0.5263, lr_0 = 1.0564e-04
Loss = 6.0073e-01, PNorm = 51.8194, GNorm = 0.9533, lr_0 = 1.0000e-04
Validation rmse = 0.575523
Epoch 26
Loss = 5.9677e-01, PNorm = 51.8202, GNorm = 0.7125, lr_0 = 1.0000e-04
Validation rmse = 0.576711
Epoch 27
Loss = 6.2143e-01, PNorm = 51.8213, GNorm = 1.4389, lr_0 = 1.0000e-04
Validation rmse = 0.576129
Epoch 28
Loss = 6.4395e-01, PNorm = 51.8223, GNorm = 1.5965, lr_0 = 1.0000e-04
Validation rmse = 0.574537
Epoch 29
Loss = 5.6866e-01, PNorm = 51.8233, GNorm = 1.2069, lr_0 = 1.0000e-04
Loss = 5.9821e-01, PNorm = 51.8240, GNorm = 1.2400, lr_0 = 1.0000e-04
Validation rmse = 0.575326
Model 0 best validation rmse = 0.574537 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.501035
Ensemble test rmse = 0.501035
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.0249e+01, PNorm = 43.1112, GNorm = 3.0952, lr_0 = 5.5000e-03
Validation rmse = 0.809064
Epoch 1
Loss = 1.0834e+00, PNorm = 45.4497, GNorm = 0.5599, lr_0 = 1.0000e-02
Validation rmse = 0.751960
Epoch 2
Loss = 9.5038e-01, PNorm = 47.8390, GNorm = 1.4184, lr_0 = 8.7192e-03
Validation rmse = 0.748155
Epoch 3
Loss = 9.3801e-01, PNorm = 49.6277, GNorm = 0.5086, lr_0 = 7.3969e-03
Loss = 9.8091e-01, PNorm = 50.4752, GNorm = 0.9430, lr_0 = 6.4495e-03
Validation rmse = 0.712933
Epoch 4
Loss = 9.0098e-01, PNorm = 50.9827, GNorm = 1.6385, lr_0 = 5.6234e-03
Validation rmse = 0.661199
Epoch 5
Loss = 9.1308e-01, PNorm = 51.3328, GNorm = 1.3677, lr_0 = 4.7706e-03
Validation rmse = 0.669275
Epoch 6
Loss = 6.7757e-01, PNorm = 51.5072, GNorm = 1.4917, lr_0 = 4.1596e-03
Loss = 8.2024e-01, PNorm = 51.6142, GNorm = 2.9598, lr_0 = 3.6268e-03
Loss = 9.7599e-01, PNorm = 51.6304, GNorm = 3.0472, lr_0 = 3.5287e-03
Validation rmse = 0.623037
Epoch 7
Loss = 7.7067e-01, PNorm = 51.6941, GNorm = 2.1111, lr_0 = 3.0768e-03
Validation rmse = 0.672167
Epoch 8
Loss = 8.0501e-01, PNorm = 51.7407, GNorm = 1.8593, lr_0 = 2.6827e-03
Validation rmse = 0.605107
Epoch 9
Loss = 7.2163e-01, PNorm = 51.7842, GNorm = 1.5803, lr_0 = 2.2758e-03
Loss = 7.3715e-01, PNorm = 51.8120, GNorm = 0.8409, lr_0 = 1.9844e-03
Validation rmse = 0.628766
Epoch 10
Loss = 7.0508e-01, PNorm = 51.8352, GNorm = 0.5205, lr_0 = 1.7302e-03
Validation rmse = 0.579823
Epoch 11
Loss = 6.4328e-01, PNorm = 51.8565, GNorm = 0.7516, lr_0 = 1.4678e-03
Validation rmse = 0.598059
Epoch 12
Loss = 5.9418e-01, PNorm = 51.8712, GNorm = 0.3645, lr_0 = 1.2798e-03
Loss = 7.2405e-01, PNorm = 51.8815, GNorm = 1.1041, lr_0 = 1.1159e-03
Validation rmse = 0.581760
Epoch 13
Loss = 6.3446e-01, PNorm = 51.8898, GNorm = 1.7838, lr_0 = 9.7296e-04
Validation rmse = 0.587807
Epoch 14
Loss = 7.0630e-01, PNorm = 51.8998, GNorm = 1.5169, lr_0 = 8.2540e-04
Validation rmse = 0.576296
Epoch 15
Loss = 6.8772e-01, PNorm = 51.9069, GNorm = 0.7327, lr_0 = 7.1969e-04
Validation rmse = 0.582368
Epoch 16
Loss = 6.6514e-01, PNorm = 51.9141, GNorm = 1.5210, lr_0 = 6.1054e-04
Loss = 6.3189e-01, PNorm = 51.9187, GNorm = 0.7804, lr_0 = 5.3234e-04
Validation rmse = 0.574275
Epoch 17
Loss = 5.9073e-01, PNorm = 51.9231, GNorm = 1.4019, lr_0 = 4.6416e-04
Validation rmse = 0.571240
Epoch 18
Loss = 6.4208e-01, PNorm = 51.9275, GNorm = 0.8521, lr_0 = 3.9377e-04
Validation rmse = 0.571153
Epoch 19
Loss = 6.3859e-01, PNorm = 51.9302, GNorm = 0.5873, lr_0 = 3.4333e-04
Loss = 6.2906e-01, PNorm = 51.9325, GNorm = 0.7079, lr_0 = 2.9936e-04
Loss = 5.2437e-01, PNorm = 51.9329, GNorm = 0.5635, lr_0 = 2.9126e-04
Validation rmse = 0.573584
Epoch 20
Loss = 6.7290e-01, PNorm = 51.9348, GNorm = 0.8916, lr_0 = 2.5396e-04
Validation rmse = 0.574851
Epoch 21
Loss = 6.2747e-01, PNorm = 51.9367, GNorm = 0.5416, lr_0 = 2.2143e-04
Validation rmse = 0.570378
Epoch 22
Loss = 5.5257e-01, PNorm = 51.9386, GNorm = 0.5528, lr_0 = 1.8785e-04
Loss = 6.5188e-01, PNorm = 51.9399, GNorm = 0.5719, lr_0 = 1.6379e-04
Validation rmse = 0.570578
Epoch 23
Loss = 6.4126e-01, PNorm = 51.9411, GNorm = 1.5317, lr_0 = 1.4281e-04
Validation rmse = 0.572038
Epoch 24
Loss = 6.3587e-01, PNorm = 51.9424, GNorm = 0.6943, lr_0 = 1.2115e-04
Validation rmse = 0.571984
Epoch 25
Loss = 6.1212e-01, PNorm = 51.9434, GNorm = 0.3970, lr_0 = 1.0564e-04
Loss = 6.0207e-01, PNorm = 51.9442, GNorm = 0.6260, lr_0 = 1.0000e-04
Validation rmse = 0.570167
Epoch 26
Loss = 6.2707e-01, PNorm = 51.9449, GNorm = 0.9829, lr_0 = 1.0000e-04
Validation rmse = 0.570114
Epoch 27
Loss = 6.1153e-01, PNorm = 51.9458, GNorm = 1.1448, lr_0 = 1.0000e-04
Validation rmse = 0.570568
Epoch 28
Loss = 6.8491e-01, PNorm = 51.9466, GNorm = 0.8971, lr_0 = 1.0000e-04
Validation rmse = 0.569642
Epoch 29
Loss = 6.3154e-01, PNorm = 51.9476, GNorm = 0.7252, lr_0 = 1.0000e-04
Loss = 6.2462e-01, PNorm = 51.9483, GNorm = 0.5769, lr_0 = 1.0000e-04
Validation rmse = 0.569633
Model 0 best validation rmse = 0.569633 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.606953
Ensemble test rmse = 0.606953
5-fold cross validation
	Seed 0 ==> test rmse = 0.584408
	Seed 1 ==> test rmse = 0.621738
	Seed 2 ==> test rmse = 0.539892
	Seed 3 ==> test rmse = 0.501035
	Seed 4 ==> test rmse = 0.606953
Overall test rmse = 0.570805 +/- 0.044518
Elapsed time = 0:28:07
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-e30316e7-233b-4683-9fc2-a9f75abac04f.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.5583e+00, PNorm = 42.7051, GNorm = 4.5689, lr_0 = 1.0000e-03
Validation rmse = 0.765591
Epoch 1
Loss = 1.0221e+00, PNorm = 42.7736, GNorm = 0.6422, lr_0 = 1.0000e-03
Validation rmse = 0.717877
Epoch 2
Loss = 8.2527e-01, PNorm = 42.8228, GNorm = 0.5747, lr_0 = 9.3377e-04
Validation rmse = 0.708456
Epoch 3
Loss = 8.5208e-01, PNorm = 42.8645, GNorm = 1.0132, lr_0 = 8.6005e-04
Loss = 9.9162e-01, PNorm = 42.8903, GNorm = 1.3690, lr_0 = 8.0309e-04
Validation rmse = 0.690005
Epoch 4
Loss = 9.4043e-01, PNorm = 42.9118, GNorm = 0.7637, lr_0 = 7.4989e-04
Validation rmse = 0.656430
Epoch 5
Loss = 8.2563e-01, PNorm = 42.9337, GNorm = 0.7707, lr_0 = 6.9069e-04
Validation rmse = 0.630951
Epoch 6
Loss = 7.7378e-01, PNorm = 42.9517, GNorm = 0.9287, lr_0 = 6.4495e-04
Loss = 7.6918e-01, PNorm = 42.9684, GNorm = 4.2682, lr_0 = 6.0223e-04
Loss = 8.2596e-01, PNorm = 42.9708, GNorm = 2.5290, lr_0 = 5.9403e-04
Validation rmse = 0.643495
Epoch 7
Loss = 7.7376e-01, PNorm = 42.9797, GNorm = 6.1367, lr_0 = 5.5469e-04
Validation rmse = 0.610680
Epoch 8
Loss = 6.7755e-01, PNorm = 42.9878, GNorm = 1.0014, lr_0 = 5.1795e-04
Validation rmse = 0.613745
Epoch 9
Loss = 6.5628e-01, PNorm = 42.9972, GNorm = 1.3477, lr_0 = 4.7706e-04
Loss = 6.9437e-01, PNorm = 43.0041, GNorm = 7.4381, lr_0 = 4.4546e-04
Validation rmse = 0.630227
Epoch 10
Loss = 6.8111e-01, PNorm = 43.0106, GNorm = 6.6319, lr_0 = 4.1596e-04
Validation rmse = 0.606610
Epoch 11
Loss = 6.9165e-01, PNorm = 43.0143, GNorm = 2.9561, lr_0 = 3.8312e-04
Validation rmse = 0.607488
Epoch 12
Loss = 6.8833e-01, PNorm = 43.0189, GNorm = 3.9424, lr_0 = 3.5774e-04
Loss = 6.6043e-01, PNorm = 43.0236, GNorm = 3.1837, lr_0 = 3.3405e-04
Validation rmse = 0.594934
Epoch 13
Loss = 6.5825e-01, PNorm = 43.0289, GNorm = 1.7714, lr_0 = 3.1192e-04
Validation rmse = 0.600126
Epoch 14
Loss = 6.6264e-01, PNorm = 43.0341, GNorm = 1.4001, lr_0 = 2.8730e-04
Validation rmse = 0.594777
Epoch 15
Loss = 6.0276e-01, PNorm = 43.0377, GNorm = 4.2058, lr_0 = 2.6827e-04
Validation rmse = 0.595114
Epoch 16
Loss = 6.0552e-01, PNorm = 43.0415, GNorm = 1.7485, lr_0 = 2.4709e-04
Loss = 6.2333e-01, PNorm = 43.0444, GNorm = 2.5477, lr_0 = 2.3073e-04
Validation rmse = 0.595020
Epoch 17
Loss = 5.7924e-01, PNorm = 43.0471, GNorm = 0.7597, lr_0 = 2.1544e-04
Validation rmse = 0.594002
Epoch 18
Loss = 5.1650e-01, PNorm = 43.0505, GNorm = 2.0663, lr_0 = 1.9844e-04
Validation rmse = 0.586843
Epoch 19
Loss = 6.1514e-01, PNorm = 43.0532, GNorm = 2.8348, lr_0 = 1.8529e-04
Loss = 6.0572e-01, PNorm = 43.0559, GNorm = 3.5940, lr_0 = 1.7302e-04
Loss = 7.9322e-01, PNorm = 43.0564, GNorm = 5.7741, lr_0 = 1.7066e-04
Validation rmse = 0.598430
Epoch 20
Loss = 6.1612e-01, PNorm = 43.0583, GNorm = 1.6483, lr_0 = 1.5936e-04
Validation rmse = 0.593167
Epoch 21
Loss = 5.6742e-01, PNorm = 43.0605, GNorm = 3.6662, lr_0 = 1.4881e-04
Validation rmse = 0.583146
Epoch 22
Loss = 6.3528e-01, PNorm = 43.0629, GNorm = 2.8799, lr_0 = 1.3706e-04
Loss = 5.7446e-01, PNorm = 43.0647, GNorm = 2.3818, lr_0 = 1.2798e-04
Validation rmse = 0.583738
Epoch 23
Loss = 6.1437e-01, PNorm = 43.0665, GNorm = 2.6050, lr_0 = 1.1950e-04
Validation rmse = 0.584794
Epoch 24
Loss = 5.9176e-01, PNorm = 43.0684, GNorm = 1.4613, lr_0 = 1.1007e-04
Validation rmse = 0.585440
Epoch 25
Loss = 6.0021e-01, PNorm = 43.0703, GNorm = 1.3139, lr_0 = 1.0278e-04
Loss = 6.0443e-01, PNorm = 43.0717, GNorm = 3.4114, lr_0 = 1.0000e-04
Validation rmse = 0.587748
Epoch 26
Loss = 5.8236e-01, PNorm = 43.0733, GNorm = 3.9806, lr_0 = 1.0000e-04
Validation rmse = 0.584730
Epoch 27
Loss = 6.1526e-01, PNorm = 43.0753, GNorm = 2.0056, lr_0 = 1.0000e-04
Validation rmse = 0.587851
Epoch 28
Loss = 5.5763e-01, PNorm = 43.0764, GNorm = 7.7233, lr_0 = 1.0000e-04
Validation rmse = 0.583312
Epoch 29
Loss = 5.3651e-01, PNorm = 43.0782, GNorm = 2.8326, lr_0 = 1.0000e-04
Loss = 5.9274e-01, PNorm = 43.0796, GNorm = 3.5381, lr_0 = 1.0000e-04
Validation rmse = 0.582147
Model 0 best validation rmse = 0.582147 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.571357
Ensemble test rmse = 0.571357
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.8485e+00, PNorm = 42.7066, GNorm = 4.6704, lr_0 = 1.0000e-03
Validation rmse = 0.737665
Epoch 1
Loss = 1.0160e+00, PNorm = 42.7774, GNorm = 1.7086, lr_0 = 1.0000e-03
Validation rmse = 0.694917
Epoch 2
Loss = 1.0256e+00, PNorm = 42.8265, GNorm = 0.7498, lr_0 = 9.3377e-04
Validation rmse = 0.685118
Epoch 3
Loss = 8.5614e-01, PNorm = 42.8676, GNorm = 1.1996, lr_0 = 8.6005e-04
Loss = 1.0327e+00, PNorm = 42.8913, GNorm = 1.1351, lr_0 = 8.0309e-04
Validation rmse = 0.682027
Epoch 4
Loss = 9.8253e-01, PNorm = 42.9091, GNorm = 0.6411, lr_0 = 7.4989e-04
Validation rmse = 0.682497
Epoch 5
Loss = 8.2337e-01, PNorm = 42.9258, GNorm = 1.5594, lr_0 = 6.9069e-04
Validation rmse = 0.653621
Epoch 6
Loss = 9.2659e-01, PNorm = 42.9387, GNorm = 0.8739, lr_0 = 6.4495e-04
Loss = 8.7058e-01, PNorm = 42.9527, GNorm = 1.2788, lr_0 = 6.0223e-04
Loss = 8.1740e-01, PNorm = 42.9557, GNorm = 1.0364, lr_0 = 5.9403e-04
Validation rmse = 0.628028
Epoch 7
Loss = 8.1664e-01, PNorm = 42.9695, GNorm = 0.6839, lr_0 = 5.5469e-04
Validation rmse = 0.589511
Epoch 8
Loss = 8.1143e-01, PNorm = 42.9825, GNorm = 2.9964, lr_0 = 5.1795e-04
Validation rmse = 0.587746
Epoch 9
Loss = 7.1503e-01, PNorm = 42.9945, GNorm = 4.7628, lr_0 = 4.7706e-04
Loss = 7.7683e-01, PNorm = 43.0022, GNorm = 5.4613, lr_0 = 4.4546e-04
Validation rmse = 0.586271
Epoch 10
Loss = 6.8961e-01, PNorm = 43.0099, GNorm = 2.5193, lr_0 = 4.1596e-04
Validation rmse = 0.577418
Epoch 11
Loss = 6.9919e-01, PNorm = 43.0188, GNorm = 2.4992, lr_0 = 3.8312e-04
Validation rmse = 0.574427
Epoch 12
Loss = 6.6079e-01, PNorm = 43.0249, GNorm = 1.0582, lr_0 = 3.5774e-04
Loss = 7.4267e-01, PNorm = 43.0298, GNorm = 1.9831, lr_0 = 3.3405e-04
Validation rmse = 0.575310
Epoch 13
Loss = 6.7795e-01, PNorm = 43.0356, GNorm = 3.0624, lr_0 = 3.1192e-04
Validation rmse = 0.572663
Epoch 14
Loss = 6.7931e-01, PNorm = 43.0403, GNorm = 6.9716, lr_0 = 2.8730e-04
Validation rmse = 0.581768
Epoch 15
Loss = 6.8207e-01, PNorm = 43.0445, GNorm = 5.3385, lr_0 = 2.6827e-04
Validation rmse = 0.582047
Epoch 16
Loss = 6.9079e-01, PNorm = 43.0483, GNorm = 2.2838, lr_0 = 2.4709e-04
Loss = 6.5362e-01, PNorm = 43.0526, GNorm = 1.4873, lr_0 = 2.3073e-04
Validation rmse = 0.554919
Epoch 17
Loss = 6.5919e-01, PNorm = 43.0565, GNorm = 2.0655, lr_0 = 2.1544e-04
Validation rmse = 0.555780
Epoch 18
Loss = 5.8272e-01, PNorm = 43.0612, GNorm = 1.5281, lr_0 = 1.9844e-04
Validation rmse = 0.547622
Epoch 19
Loss = 6.6588e-01, PNorm = 43.0651, GNorm = 0.7233, lr_0 = 1.8529e-04
Loss = 6.3301e-01, PNorm = 43.0682, GNorm = 2.6959, lr_0 = 1.7302e-04
Loss = 6.1774e-01, PNorm = 43.0688, GNorm = 1.1425, lr_0 = 1.7066e-04
Validation rmse = 0.558617
Epoch 20
Loss = 6.3849e-01, PNorm = 43.0718, GNorm = 2.1839, lr_0 = 1.5936e-04
Validation rmse = 0.546509
Epoch 21
Loss = 5.7734e-01, PNorm = 43.0743, GNorm = 0.6867, lr_0 = 1.4881e-04
Validation rmse = 0.546716
Epoch 22
Loss = 6.5154e-01, PNorm = 43.0773, GNorm = 2.2837, lr_0 = 1.3706e-04
Loss = 5.8376e-01, PNorm = 43.0796, GNorm = 1.0647, lr_0 = 1.2798e-04
Validation rmse = 0.548321
Epoch 23
Loss = 6.2499e-01, PNorm = 43.0819, GNorm = 0.6231, lr_0 = 1.1950e-04
Validation rmse = 0.545894
Epoch 24
Loss = 6.4257e-01, PNorm = 43.0844, GNorm = 1.4835, lr_0 = 1.1007e-04
Validation rmse = 0.542826
Epoch 25
Loss = 5.5343e-01, PNorm = 43.0863, GNorm = 3.9282, lr_0 = 1.0278e-04
Loss = 6.0762e-01, PNorm = 43.0879, GNorm = 1.4456, lr_0 = 1.0000e-04
Validation rmse = 0.543739
Epoch 26
Loss = 6.2031e-01, PNorm = 43.0897, GNorm = 1.1362, lr_0 = 1.0000e-04
Validation rmse = 0.543442
Epoch 27
Loss = 6.0069e-01, PNorm = 43.0919, GNorm = 0.6731, lr_0 = 1.0000e-04
Validation rmse = 0.543514
Epoch 28
Loss = 6.4674e-01, PNorm = 43.0938, GNorm = 2.2994, lr_0 = 1.0000e-04
Validation rmse = 0.544532
Epoch 29
Loss = 6.3653e-01, PNorm = 43.0962, GNorm = 1.6558, lr_0 = 1.0000e-04
Loss = 5.7239e-01, PNorm = 43.0982, GNorm = 2.9918, lr_0 = 1.0000e-04
Validation rmse = 0.543513
Model 0 best validation rmse = 0.542826 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.612690
Ensemble test rmse = 0.612690
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.6031e+00, PNorm = 42.7075, GNorm = 6.1307, lr_0 = 1.0000e-03
Validation rmse = 0.743983
Epoch 1
Loss = 1.0863e+00, PNorm = 42.7792, GNorm = 0.7100, lr_0 = 1.0000e-03
Validation rmse = 0.751241
Epoch 2
Loss = 8.5375e-01, PNorm = 42.8301, GNorm = 0.6866, lr_0 = 9.3377e-04
Validation rmse = 0.744113
Epoch 3
Loss = 9.3462e-01, PNorm = 42.8731, GNorm = 1.0901, lr_0 = 8.6005e-04
Loss = 9.8784e-01, PNorm = 42.8992, GNorm = 1.3133, lr_0 = 8.0309e-04
Validation rmse = 0.733508
Epoch 4
Loss = 9.3317e-01, PNorm = 42.9205, GNorm = 1.9830, lr_0 = 7.4989e-04
Validation rmse = 0.758948
Epoch 5
Loss = 8.5818e-01, PNorm = 42.9424, GNorm = 1.7465, lr_0 = 6.9069e-04
Validation rmse = 0.714117
Epoch 6
Loss = 9.5405e-01, PNorm = 42.9556, GNorm = 1.4879, lr_0 = 6.4495e-04
Loss = 7.8093e-01, PNorm = 42.9690, GNorm = 1.4557, lr_0 = 6.0223e-04
Loss = 6.0949e-01, PNorm = 42.9715, GNorm = 1.6656, lr_0 = 5.9403e-04
Validation rmse = 0.683479
Epoch 7
Loss = 7.2401e-01, PNorm = 42.9838, GNorm = 1.6304, lr_0 = 5.5469e-04
Validation rmse = 0.652815
Epoch 8
Loss = 7.2982e-01, PNorm = 42.9936, GNorm = 1.3956, lr_0 = 5.1795e-04
Validation rmse = 0.643614
Epoch 9
Loss = 6.8602e-01, PNorm = 43.0026, GNorm = 4.7559, lr_0 = 4.7706e-04
Loss = 7.5035e-01, PNorm = 43.0089, GNorm = 3.1553, lr_0 = 4.4546e-04
Validation rmse = 0.639880
Epoch 10
Loss = 6.4092e-01, PNorm = 43.0159, GNorm = 1.4472, lr_0 = 4.1596e-04
Validation rmse = 0.637673
Epoch 11
Loss = 6.6198e-01, PNorm = 43.0243, GNorm = 0.8152, lr_0 = 3.8312e-04
Validation rmse = 0.625605
Epoch 12
Loss = 5.8906e-01, PNorm = 43.0301, GNorm = 2.3932, lr_0 = 3.5774e-04
Loss = 6.8333e-01, PNorm = 43.0348, GNorm = 1.6122, lr_0 = 3.3405e-04
Validation rmse = 0.655190
Epoch 13
Loss = 6.2313e-01, PNorm = 43.0391, GNorm = 1.1154, lr_0 = 3.1192e-04
Validation rmse = 0.616181
Epoch 14
Loss = 6.4043e-01, PNorm = 43.0449, GNorm = 1.2220, lr_0 = 2.8730e-04
Validation rmse = 0.612098
Epoch 15
Loss = 6.9318e-01, PNorm = 43.0489, GNorm = 1.8083, lr_0 = 2.6827e-04
Validation rmse = 0.637896
Epoch 16
Loss = 6.9808e-01, PNorm = 43.0529, GNorm = 3.1853, lr_0 = 2.4709e-04
Loss = 6.1318e-01, PNorm = 43.0564, GNorm = 0.6905, lr_0 = 2.3073e-04
Validation rmse = 0.615904
Epoch 17
Loss = 6.2141e-01, PNorm = 43.0606, GNorm = 0.6330, lr_0 = 2.1544e-04
Validation rmse = 0.621818
Epoch 18
Loss = 6.0279e-01, PNorm = 43.0643, GNorm = 5.5016, lr_0 = 1.9844e-04
Validation rmse = 0.623911
Epoch 19
Loss = 6.5807e-01, PNorm = 43.0670, GNorm = 1.2575, lr_0 = 1.8529e-04
Loss = 5.7936e-01, PNorm = 43.0704, GNorm = 1.5054, lr_0 = 1.7302e-04
Loss = 7.0139e-01, PNorm = 43.0709, GNorm = 2.4604, lr_0 = 1.7066e-04
Validation rmse = 0.596182
Epoch 20
Loss = 6.1256e-01, PNorm = 43.0736, GNorm = 1.6805, lr_0 = 1.5936e-04
Validation rmse = 0.611512
Epoch 21
Loss = 6.0398e-01, PNorm = 43.0763, GNorm = 1.6329, lr_0 = 1.4881e-04
Validation rmse = 0.621628
Epoch 22
Loss = 5.9473e-01, PNorm = 43.0791, GNorm = 0.9630, lr_0 = 1.3706e-04
Loss = 6.1751e-01, PNorm = 43.0816, GNorm = 3.5334, lr_0 = 1.2798e-04
Validation rmse = 0.585195
Epoch 23
Loss = 6.3329e-01, PNorm = 43.0830, GNorm = 1.6838, lr_0 = 1.1950e-04
Validation rmse = 0.659437
Epoch 24
Loss = 5.8245e-01, PNorm = 43.0855, GNorm = 2.2848, lr_0 = 1.1007e-04
Validation rmse = 0.586333
Epoch 25
Loss = 6.4069e-01, PNorm = 43.0875, GNorm = 1.5225, lr_0 = 1.0278e-04
Loss = 5.7424e-01, PNorm = 43.0889, GNorm = 1.3436, lr_0 = 1.0000e-04
Validation rmse = 0.641882
Epoch 26
Loss = 6.0302e-01, PNorm = 43.0906, GNorm = 9.7963, lr_0 = 1.0000e-04
Validation rmse = 0.585365
Epoch 27
Loss = 5.9419e-01, PNorm = 43.0929, GNorm = 6.2607, lr_0 = 1.0000e-04
Validation rmse = 0.616377
Epoch 28
Loss = 4.9487e-01, PNorm = 43.0944, GNorm = 0.6845, lr_0 = 1.0000e-04
Validation rmse = 0.598900
Epoch 29
Loss = 5.4715e-01, PNorm = 43.0969, GNorm = 3.8113, lr_0 = 1.0000e-04
Loss = 5.7607e-01, PNorm = 43.0987, GNorm = 1.9933, lr_0 = 1.0000e-04
Validation rmse = 0.602971
Model 0 best validation rmse = 0.585195 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.550695
Ensemble test rmse = 0.550695
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.2397e+00, PNorm = 42.7051, GNorm = 4.3451, lr_0 = 1.0000e-03
Validation rmse = 0.739987
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7732, GNorm = 2.2271, lr_0 = 1.0000e-03
Validation rmse = 0.731943
Epoch 2
Loss = 1.0877e+00, PNorm = 42.8218, GNorm = 0.9670, lr_0 = 9.3377e-04
Validation rmse = 0.734894
Epoch 3
Loss = 9.9266e-01, PNorm = 42.8641, GNorm = 0.7978, lr_0 = 8.6005e-04
Loss = 9.5256e-01, PNorm = 42.8904, GNorm = 0.8127, lr_0 = 8.0309e-04
Validation rmse = 0.712731
Epoch 4
Loss = 9.2066e-01, PNorm = 42.9123, GNorm = 0.8539, lr_0 = 7.4989e-04
Validation rmse = 0.709142
Epoch 5
Loss = 8.8406e-01, PNorm = 42.9353, GNorm = 1.1416, lr_0 = 6.9069e-04
Validation rmse = 0.680690
Epoch 6
Loss = 7.4925e-01, PNorm = 42.9535, GNorm = 1.5808, lr_0 = 6.4495e-04
Loss = 7.6052e-01, PNorm = 42.9681, GNorm = 2.1514, lr_0 = 6.0223e-04
Loss = 8.0949e-01, PNorm = 42.9702, GNorm = 3.8591, lr_0 = 5.9403e-04
Validation rmse = 0.647774
Epoch 7
Loss = 7.6187e-01, PNorm = 42.9801, GNorm = 6.1965, lr_0 = 5.5469e-04
Validation rmse = 0.672715
Epoch 8
Loss = 6.9160e-01, PNorm = 42.9885, GNorm = 0.7782, lr_0 = 5.1795e-04
Validation rmse = 0.610000
Epoch 9
Loss = 6.5049e-01, PNorm = 42.9999, GNorm = 2.1849, lr_0 = 4.7706e-04
Loss = 7.0258e-01, PNorm = 43.0089, GNorm = 2.3798, lr_0 = 4.4546e-04
Validation rmse = 0.587560
Epoch 10
Loss = 6.8335e-01, PNorm = 43.0167, GNorm = 5.4311, lr_0 = 4.1596e-04
Validation rmse = 0.603770
Epoch 11
Loss = 6.7317e-01, PNorm = 43.0229, GNorm = 4.6251, lr_0 = 3.8312e-04
Validation rmse = 0.578627
Epoch 12
Loss = 6.7931e-01, PNorm = 43.0273, GNorm = 1.3787, lr_0 = 3.5774e-04
Loss = 6.9245e-01, PNorm = 43.0323, GNorm = 3.1756, lr_0 = 3.3405e-04
Validation rmse = 0.585299
Epoch 13
Loss = 6.7693e-01, PNorm = 43.0372, GNorm = 3.4536, lr_0 = 3.1192e-04
Validation rmse = 0.615999
Epoch 14
Loss = 6.4988e-01, PNorm = 43.0428, GNorm = 1.0190, lr_0 = 2.8730e-04
Validation rmse = 0.574774
Epoch 15
Loss = 7.1097e-01, PNorm = 43.0481, GNorm = 3.3495, lr_0 = 2.6827e-04
Validation rmse = 0.612132
Epoch 16
Loss = 6.7364e-01, PNorm = 43.0532, GNorm = 4.4836, lr_0 = 2.4709e-04
Loss = 6.3049e-01, PNorm = 43.0574, GNorm = 4.7566, lr_0 = 2.3073e-04
Validation rmse = 0.584084
Epoch 17
Loss = 6.1509e-01, PNorm = 43.0611, GNorm = 1.4510, lr_0 = 2.1544e-04
Validation rmse = 0.573517
Epoch 18
Loss = 5.9461e-01, PNorm = 43.0655, GNorm = 3.0653, lr_0 = 1.9844e-04
Validation rmse = 0.599204
Epoch 19
Loss = 6.9756e-01, PNorm = 43.0687, GNorm = 1.0250, lr_0 = 1.8529e-04
Loss = 6.0571e-01, PNorm = 43.0724, GNorm = 0.9513, lr_0 = 1.7302e-04
Loss = 5.0116e-01, PNorm = 43.0731, GNorm = 2.1925, lr_0 = 1.7066e-04
Validation rmse = 0.562443
Epoch 20
Loss = 6.3437e-01, PNorm = 43.0757, GNorm = 0.6706, lr_0 = 1.5936e-04
Validation rmse = 0.595566
Epoch 21
Loss = 6.4383e-01, PNorm = 43.0783, GNorm = 4.3520, lr_0 = 1.4881e-04
Validation rmse = 0.577388
Epoch 22
Loss = 5.4336e-01, PNorm = 43.0814, GNorm = 0.7071, lr_0 = 1.3706e-04
Loss = 6.0871e-01, PNorm = 43.0838, GNorm = 2.6225, lr_0 = 1.2798e-04
Validation rmse = 0.571578
Epoch 23
Loss = 5.4982e-01, PNorm = 43.0859, GNorm = 1.5660, lr_0 = 1.1950e-04
Validation rmse = 0.575936
Epoch 24
Loss = 5.4719e-01, PNorm = 43.0887, GNorm = 1.2960, lr_0 = 1.1007e-04
Validation rmse = 0.563594
Epoch 25
Loss = 5.7686e-01, PNorm = 43.0907, GNorm = 0.8714, lr_0 = 1.0278e-04
Loss = 5.8000e-01, PNorm = 43.0926, GNorm = 1.2714, lr_0 = 1.0000e-04
Validation rmse = 0.592739
Epoch 26
Loss = 5.7426e-01, PNorm = 43.0946, GNorm = 1.0706, lr_0 = 1.0000e-04
Validation rmse = 0.562046
Epoch 27
Loss = 6.0018e-01, PNorm = 43.0970, GNorm = 1.5731, lr_0 = 1.0000e-04
Validation rmse = 0.572451
Epoch 28
Loss = 6.1981e-01, PNorm = 43.0990, GNorm = 3.8816, lr_0 = 1.0000e-04
Validation rmse = 0.576829
Epoch 29
Loss = 5.5745e-01, PNorm = 43.1014, GNorm = 1.0159, lr_0 = 1.0000e-04
Loss = 5.5445e-01, PNorm = 43.1036, GNorm = 3.4273, lr_0 = 1.0000e-04
Validation rmse = 0.568013
Model 0 best validation rmse = 0.562046 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.508137
Ensemble test rmse = 0.508137
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 3.3774e+00, PNorm = 42.7061, GNorm = 5.8343, lr_0 = 1.0000e-03
Validation rmse = 0.763242
Epoch 1
Loss = 1.0431e+00, PNorm = 42.7790, GNorm = 1.1057, lr_0 = 1.0000e-03
Validation rmse = 0.756883
Epoch 2
Loss = 9.3458e-01, PNorm = 42.8307, GNorm = 2.0843, lr_0 = 9.3377e-04
Validation rmse = 0.756478
Epoch 3
Loss = 9.0390e-01, PNorm = 42.8733, GNorm = 0.6147, lr_0 = 8.6005e-04
Loss = 9.8708e-01, PNorm = 42.8990, GNorm = 0.6160, lr_0 = 8.0309e-04
Validation rmse = 0.725295
Epoch 4
Loss = 9.2760e-01, PNorm = 42.9189, GNorm = 1.1890, lr_0 = 7.4989e-04
Validation rmse = 0.694345
Epoch 5
Loss = 9.7693e-01, PNorm = 42.9403, GNorm = 4.6737, lr_0 = 6.9069e-04
Validation rmse = 0.788144
Epoch 6
Loss = 8.7397e-01, PNorm = 42.9529, GNorm = 4.7125, lr_0 = 6.4495e-04
Loss = 8.6255e-01, PNorm = 42.9645, GNorm = 0.8467, lr_0 = 6.0223e-04
Loss = 8.6784e-01, PNorm = 42.9665, GNorm = 1.5072, lr_0 = 5.9403e-04
Validation rmse = 0.668027
Epoch 7
Loss = 8.0313e-01, PNorm = 42.9774, GNorm = 1.3361, lr_0 = 5.5469e-04
Validation rmse = 0.660040
Epoch 8
Loss = 7.8535e-01, PNorm = 42.9888, GNorm = 0.6453, lr_0 = 5.1795e-04
Validation rmse = 0.626498
Epoch 9
Loss = 7.0203e-01, PNorm = 43.0021, GNorm = 0.8828, lr_0 = 4.7706e-04
Loss = 7.4251e-01, PNorm = 43.0121, GNorm = 1.1411, lr_0 = 4.4546e-04
Validation rmse = 0.624301
Epoch 10
Loss = 7.0593e-01, PNorm = 43.0207, GNorm = 1.1050, lr_0 = 4.1596e-04
Validation rmse = 0.598134
Epoch 11
Loss = 6.6086e-01, PNorm = 43.0303, GNorm = 0.8967, lr_0 = 3.8312e-04
Validation rmse = 0.588431
Epoch 12
Loss = 5.9163e-01, PNorm = 43.0383, GNorm = 2.5735, lr_0 = 3.5774e-04
Loss = 6.9856e-01, PNorm = 43.0444, GNorm = 4.6835, lr_0 = 3.3405e-04
Validation rmse = 0.656113
Epoch 13
Loss = 6.3540e-01, PNorm = 43.0499, GNorm = 0.6523, lr_0 = 3.1192e-04
Validation rmse = 0.594733
Epoch 14
Loss = 6.8809e-01, PNorm = 43.0556, GNorm = 0.9671, lr_0 = 2.8730e-04
Validation rmse = 0.571263
Epoch 15
Loss = 6.8450e-01, PNorm = 43.0608, GNorm = 1.1000, lr_0 = 2.6827e-04
Validation rmse = 0.583436
Epoch 16
Loss = 6.3063e-01, PNorm = 43.0668, GNorm = 0.8301, lr_0 = 2.4709e-04
Loss = 6.4849e-01, PNorm = 43.0701, GNorm = 4.3707, lr_0 = 2.3073e-04
Validation rmse = 0.615713
Epoch 17
Loss = 5.8072e-01, PNorm = 43.0739, GNorm = 6.3678, lr_0 = 2.1544e-04
Validation rmse = 0.587150
Epoch 18
Loss = 6.1959e-01, PNorm = 43.0778, GNorm = 1.4447, lr_0 = 1.9844e-04
Validation rmse = 0.598975
Epoch 19
Loss = 6.9792e-01, PNorm = 43.0809, GNorm = 0.7804, lr_0 = 1.8529e-04
Loss = 5.9287e-01, PNorm = 43.0835, GNorm = 2.3978, lr_0 = 1.7302e-04
Loss = 5.9395e-01, PNorm = 43.0839, GNorm = 1.2613, lr_0 = 1.7066e-04
Validation rmse = 0.595790
Epoch 20
Loss = 6.3523e-01, PNorm = 43.0865, GNorm = 1.4953, lr_0 = 1.5936e-04
Validation rmse = 0.569106
Epoch 21
Loss = 5.9203e-01, PNorm = 43.0892, GNorm = 0.6730, lr_0 = 1.4881e-04
Validation rmse = 0.585219
Epoch 22
Loss = 5.3178e-01, PNorm = 43.0924, GNorm = 0.7010, lr_0 = 1.3706e-04
Loss = 6.1324e-01, PNorm = 43.0948, GNorm = 2.2216, lr_0 = 1.2798e-04
Validation rmse = 0.587245
Epoch 23
Loss = 6.1809e-01, PNorm = 43.0970, GNorm = 2.4488, lr_0 = 1.1950e-04
Validation rmse = 0.577685
Epoch 24
Loss = 5.9394e-01, PNorm = 43.0990, GNorm = 1.8833, lr_0 = 1.1007e-04
Validation rmse = 0.586700
Epoch 25
Loss = 5.6485e-01, PNorm = 43.1008, GNorm = 1.0313, lr_0 = 1.0278e-04
Loss = 5.7979e-01, PNorm = 43.1022, GNorm = 0.7895, lr_0 = 1.0000e-04
Validation rmse = 0.590766
Epoch 26
Loss = 5.9586e-01, PNorm = 43.1039, GNorm = 1.7561, lr_0 = 1.0000e-04
Validation rmse = 0.573226
Epoch 27
Loss = 5.7204e-01, PNorm = 43.1060, GNorm = 3.2475, lr_0 = 1.0000e-04
Validation rmse = 0.584301
Epoch 28
Loss = 6.3896e-01, PNorm = 43.1077, GNorm = 2.2298, lr_0 = 1.0000e-04
Validation rmse = 0.589364
Epoch 29
Loss = 5.3518e-01, PNorm = 43.1097, GNorm = 1.0869, lr_0 = 1.0000e-04
Loss = 5.7799e-01, PNorm = 43.1116, GNorm = 2.1961, lr_0 = 1.0000e-04
Validation rmse = 0.577583
Model 0 best validation rmse = 0.569106 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.611982
Ensemble test rmse = 0.611982
5-fold cross validation
	Seed 0 ==> test rmse = 0.571357
	Seed 1 ==> test rmse = 0.612690
	Seed 2 ==> test rmse = 0.550695
	Seed 3 ==> test rmse = 0.508137
	Seed 4 ==> test rmse = 0.611982
Overall test rmse = 0.570972 +/- 0.039451
Elapsed time = 0:29:50
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-e30316e7-233b-4683-9fc2-a9f75abac04f.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0005,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7578e+00, PNorm = 42.6820, GNorm = 7.6537, lr_0 = 7.5000e-04
Validation rmse = 0.738794
Epoch 1
Loss = 1.0081e+00, PNorm = 42.7169, GNorm = 0.9495, lr_0 = 1.0000e-03
Validation rmse = 0.715447
Epoch 2
Loss = 8.0487e-01, PNorm = 42.7507, GNorm = 0.7394, lr_0 = 9.3377e-04
Validation rmse = 0.708588
Epoch 3
Loss = 8.5113e-01, PNorm = 42.7825, GNorm = 0.8180, lr_0 = 8.6005e-04
Loss = 9.8843e-01, PNorm = 42.8032, GNorm = 1.0666, lr_0 = 8.0309e-04
Validation rmse = 0.684489
Epoch 4
Loss = 9.4407e-01, PNorm = 42.8219, GNorm = 0.7002, lr_0 = 7.4989e-04
Validation rmse = 0.651962
Epoch 5
Loss = 7.9518e-01, PNorm = 42.8430, GNorm = 0.8147, lr_0 = 6.9069e-04
Validation rmse = 0.623145
Epoch 6
Loss = 7.4120e-01, PNorm = 42.8602, GNorm = 1.0412, lr_0 = 6.4495e-04
Loss = 7.8074e-01, PNorm = 42.8755, GNorm = 2.7053, lr_0 = 6.0223e-04
Loss = 8.3489e-01, PNorm = 42.8777, GNorm = 1.9338, lr_0 = 5.9403e-04
Validation rmse = 0.616748
Epoch 7
Loss = 7.4086e-01, PNorm = 42.8864, GNorm = 4.4054, lr_0 = 5.5469e-04
Validation rmse = 0.602573
Epoch 8
Loss = 7.0457e-01, PNorm = 42.8946, GNorm = 2.1754, lr_0 = 5.1795e-04
Validation rmse = 0.601231
Epoch 9
Loss = 6.6914e-01, PNorm = 42.9046, GNorm = 1.0762, lr_0 = 4.7706e-04
Loss = 6.6757e-01, PNorm = 42.9126, GNorm = 4.3875, lr_0 = 4.4546e-04
Validation rmse = 0.624125
Epoch 10
Loss = 6.3684e-01, PNorm = 42.9194, GNorm = 5.9240, lr_0 = 4.1596e-04
Validation rmse = 0.601339
Epoch 11
Loss = 6.8493e-01, PNorm = 42.9232, GNorm = 2.0348, lr_0 = 3.8312e-04
Validation rmse = 0.585315
Epoch 12
Loss = 6.8623e-01, PNorm = 42.9273, GNorm = 1.7222, lr_0 = 3.5774e-04
Loss = 6.7039e-01, PNorm = 42.9324, GNorm = 1.8731, lr_0 = 3.3405e-04
Validation rmse = 0.582237
Epoch 13
Loss = 6.6420e-01, PNorm = 42.9377, GNorm = 1.2057, lr_0 = 3.1192e-04
Validation rmse = 0.595454
Epoch 14
Loss = 6.8159e-01, PNorm = 42.9433, GNorm = 0.9846, lr_0 = 2.8730e-04
Validation rmse = 0.579271
Epoch 15
Loss = 5.5480e-01, PNorm = 42.9469, GNorm = 3.1158, lr_0 = 2.6827e-04
Validation rmse = 0.577980
Epoch 16
Loss = 6.2479e-01, PNorm = 42.9504, GNorm = 1.3285, lr_0 = 2.4709e-04
Loss = 6.1518e-01, PNorm = 42.9527, GNorm = 1.5005, lr_0 = 2.3073e-04
Validation rmse = 0.575709
Epoch 17
Loss = 5.7437e-01, PNorm = 42.9552, GNorm = 0.8858, lr_0 = 2.1544e-04
Validation rmse = 0.578661
Epoch 18
Loss = 5.0416e-01, PNorm = 42.9579, GNorm = 1.7992, lr_0 = 1.9844e-04
Validation rmse = 0.570862
Epoch 19
Loss = 6.3821e-01, PNorm = 42.9605, GNorm = 3.0865, lr_0 = 1.8529e-04
Loss = 5.9297e-01, PNorm = 42.9632, GNorm = 4.3740, lr_0 = 1.7302e-04
Loss = 7.2890e-01, PNorm = 42.9637, GNorm = 3.0891, lr_0 = 1.7066e-04
Validation rmse = 0.574181
Epoch 20
Loss = 5.8448e-01, PNorm = 42.9655, GNorm = 1.2306, lr_0 = 1.5936e-04
Validation rmse = 0.579921
Epoch 21
Loss = 5.5304e-01, PNorm = 42.9675, GNorm = 3.2840, lr_0 = 1.4881e-04
Validation rmse = 0.570589
Epoch 22
Loss = 6.0437e-01, PNorm = 42.9698, GNorm = 3.2927, lr_0 = 1.3706e-04
Loss = 5.5397e-01, PNorm = 42.9714, GNorm = 1.1944, lr_0 = 1.2798e-04
Validation rmse = 0.574282
Epoch 23
Loss = 6.0504e-01, PNorm = 42.9730, GNorm = 2.1663, lr_0 = 1.1950e-04
Validation rmse = 0.576067
Epoch 24
Loss = 5.7027e-01, PNorm = 42.9747, GNorm = 1.1007, lr_0 = 1.1007e-04
Validation rmse = 0.574619
Epoch 25
Loss = 6.1276e-01, PNorm = 42.9764, GNorm = 0.9364, lr_0 = 1.0278e-04
Loss = 5.7233e-01, PNorm = 42.9776, GNorm = 2.4917, lr_0 = 1.0000e-04
Validation rmse = 0.577679
Epoch 26
Loss = 5.7895e-01, PNorm = 42.9788, GNorm = 2.7188, lr_0 = 1.0000e-04
Validation rmse = 0.569597
Epoch 27
Loss = 6.1566e-01, PNorm = 42.9805, GNorm = 1.4070, lr_0 = 1.0000e-04
Validation rmse = 0.573767
Epoch 28
Loss = 5.3009e-01, PNorm = 42.9813, GNorm = 6.0147, lr_0 = 1.0000e-04
Validation rmse = 0.568470
Epoch 29
Loss = 5.1411e-01, PNorm = 42.9829, GNorm = 2.1339, lr_0 = 1.0000e-04
Loss = 6.0269e-01, PNorm = 42.9841, GNorm = 2.9299, lr_0 = 1.0000e-04
Validation rmse = 0.568607
Model 0 best validation rmse = 0.568470 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.558738
Ensemble test rmse = 0.558738
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.9110e+00, PNorm = 42.6812, GNorm = 7.7417, lr_0 = 7.5000e-04
Validation rmse = 0.725965
Epoch 1
Loss = 1.0170e+00, PNorm = 42.7155, GNorm = 1.8037, lr_0 = 1.0000e-03
Validation rmse = 0.697055
Epoch 2
Loss = 1.0452e+00, PNorm = 42.7495, GNorm = 1.2479, lr_0 = 9.3377e-04
Validation rmse = 0.693144
Epoch 3
Loss = 8.9572e-01, PNorm = 42.7809, GNorm = 1.6347, lr_0 = 8.6005e-04
Loss = 9.9188e-01, PNorm = 42.8000, GNorm = 0.7933, lr_0 = 8.0309e-04
Validation rmse = 0.675681
Epoch 4
Loss = 9.8065e-01, PNorm = 42.8156, GNorm = 0.8143, lr_0 = 7.4989e-04
Validation rmse = 0.664044
Epoch 5
Loss = 7.9354e-01, PNorm = 42.8318, GNorm = 1.5595, lr_0 = 6.9069e-04
Validation rmse = 0.629157
Epoch 6
Loss = 8.8346e-01, PNorm = 42.8456, GNorm = 1.4928, lr_0 = 6.4495e-04
Loss = 8.1587e-01, PNorm = 42.8603, GNorm = 1.2781, lr_0 = 6.0223e-04
Loss = 7.6936e-01, PNorm = 42.8633, GNorm = 2.0556, lr_0 = 5.9403e-04
Validation rmse = 0.595276
Epoch 7
Loss = 7.7725e-01, PNorm = 42.8760, GNorm = 1.0913, lr_0 = 5.5469e-04
Validation rmse = 0.588194
Epoch 8
Loss = 7.8536e-01, PNorm = 42.8851, GNorm = 3.2896, lr_0 = 5.1795e-04
Validation rmse = 0.586777
Epoch 9
Loss = 6.9878e-01, PNorm = 42.8925, GNorm = 3.6494, lr_0 = 4.7706e-04
Loss = 7.5277e-01, PNorm = 42.8980, GNorm = 4.0819, lr_0 = 4.4546e-04
Validation rmse = 0.579362
Epoch 10
Loss = 6.6476e-01, PNorm = 42.9052, GNorm = 1.6136, lr_0 = 4.1596e-04
Validation rmse = 0.564571
Epoch 11
Loss = 6.8695e-01, PNorm = 42.9134, GNorm = 1.9792, lr_0 = 3.8312e-04
Validation rmse = 0.570716
Epoch 12
Loss = 6.5224e-01, PNorm = 42.9194, GNorm = 0.9267, lr_0 = 3.5774e-04
Loss = 7.2791e-01, PNorm = 42.9230, GNorm = 2.6806, lr_0 = 3.3405e-04
Validation rmse = 0.580236
Epoch 13
Loss = 6.6983e-01, PNorm = 42.9281, GNorm = 2.8828, lr_0 = 3.1192e-04
Validation rmse = 0.562129
Epoch 14
Loss = 6.7631e-01, PNorm = 42.9315, GNorm = 6.9046, lr_0 = 2.8730e-04
Validation rmse = 0.559640
Epoch 15
Loss = 6.4654e-01, PNorm = 42.9356, GNorm = 4.9788, lr_0 = 2.6827e-04
Validation rmse = 0.570588
Epoch 16
Loss = 6.9040e-01, PNorm = 42.9386, GNorm = 1.4570, lr_0 = 2.4709e-04
Loss = 6.4366e-01, PNorm = 42.9427, GNorm = 0.7145, lr_0 = 2.3073e-04
Validation rmse = 0.541543
Epoch 17
Loss = 6.4980e-01, PNorm = 42.9460, GNorm = 1.1029, lr_0 = 2.1544e-04
Validation rmse = 0.548159
Epoch 18
Loss = 5.8314e-01, PNorm = 42.9494, GNorm = 2.1729, lr_0 = 1.9844e-04
Validation rmse = 0.541053
Epoch 19
Loss = 6.9420e-01, PNorm = 42.9526, GNorm = 0.8432, lr_0 = 1.8529e-04
Loss = 6.2855e-01, PNorm = 42.9550, GNorm = 2.9874, lr_0 = 1.7302e-04
Loss = 5.8369e-01, PNorm = 42.9554, GNorm = 1.3358, lr_0 = 1.7066e-04
Validation rmse = 0.548293
Epoch 20
Loss = 6.3278e-01, PNorm = 42.9576, GNorm = 2.2793, lr_0 = 1.5936e-04
Validation rmse = 0.544885
Epoch 21
Loss = 5.6064e-01, PNorm = 42.9598, GNorm = 1.0006, lr_0 = 1.4881e-04
Validation rmse = 0.538562
Epoch 22
Loss = 6.4052e-01, PNorm = 42.9623, GNorm = 2.2828, lr_0 = 1.3706e-04
Loss = 5.7620e-01, PNorm = 42.9641, GNorm = 1.1120, lr_0 = 1.2798e-04
Validation rmse = 0.547499
Epoch 23
Loss = 6.2489e-01, PNorm = 42.9660, GNorm = 0.6796, lr_0 = 1.1950e-04
Validation rmse = 0.541677
Epoch 24
Loss = 6.3415e-01, PNorm = 42.9679, GNorm = 1.4635, lr_0 = 1.1007e-04
Validation rmse = 0.539578
Epoch 25
Loss = 5.4053e-01, PNorm = 42.9695, GNorm = 3.3444, lr_0 = 1.0278e-04
Loss = 6.0679e-01, PNorm = 42.9708, GNorm = 1.2789, lr_0 = 1.0000e-04
Validation rmse = 0.540755
Epoch 26
Loss = 6.1915e-01, PNorm = 42.9721, GNorm = 1.1925, lr_0 = 1.0000e-04
Validation rmse = 0.542182
Epoch 27
Loss = 6.1016e-01, PNorm = 42.9736, GNorm = 0.8586, lr_0 = 1.0000e-04
Validation rmse = 0.541266
Epoch 28
Loss = 6.2205e-01, PNorm = 42.9751, GNorm = 1.6679, lr_0 = 1.0000e-04
Validation rmse = 0.542742
Epoch 29
Loss = 6.6923e-01, PNorm = 42.9769, GNorm = 1.4430, lr_0 = 1.0000e-04
Loss = 5.7500e-01, PNorm = 42.9784, GNorm = 2.4009, lr_0 = 1.0000e-04
Validation rmse = 0.546111
Model 0 best validation rmse = 0.538562 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.615220
Ensemble test rmse = 0.615220
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.8579e+00, PNorm = 42.6815, GNorm = 9.5793, lr_0 = 7.5000e-04
Validation rmse = 0.738059
Epoch 1
Loss = 1.0838e+00, PNorm = 42.7178, GNorm = 1.2363, lr_0 = 1.0000e-03
Validation rmse = 0.745014
Epoch 2
Loss = 8.6480e-01, PNorm = 42.7541, GNorm = 0.6907, lr_0 = 9.3377e-04
Validation rmse = 0.732480
Epoch 3
Loss = 9.2699e-01, PNorm = 42.7882, GNorm = 0.6241, lr_0 = 8.6005e-04
Loss = 9.7685e-01, PNorm = 42.8099, GNorm = 0.7089, lr_0 = 8.0309e-04
Validation rmse = 0.727688
Epoch 4
Loss = 9.3093e-01, PNorm = 42.8297, GNorm = 1.4995, lr_0 = 7.4989e-04
Validation rmse = 0.754503
Epoch 5
Loss = 8.4557e-01, PNorm = 42.8504, GNorm = 2.4476, lr_0 = 6.9069e-04
Validation rmse = 0.712809
Epoch 6
Loss = 9.2734e-01, PNorm = 42.8635, GNorm = 1.3516, lr_0 = 6.4495e-04
Loss = 7.5516e-01, PNorm = 42.8767, GNorm = 1.6220, lr_0 = 6.0223e-04
Loss = 6.3021e-01, PNorm = 42.8787, GNorm = 1.0692, lr_0 = 5.9403e-04
Validation rmse = 0.681059
Epoch 7
Loss = 7.0157e-01, PNorm = 42.8888, GNorm = 1.0523, lr_0 = 5.5469e-04
Validation rmse = 0.652395
Epoch 8
Loss = 7.1081e-01, PNorm = 42.8976, GNorm = 1.1103, lr_0 = 5.1795e-04
Validation rmse = 0.634330
Epoch 9
Loss = 6.7770e-01, PNorm = 42.9071, GNorm = 4.3400, lr_0 = 4.7706e-04
Loss = 7.3622e-01, PNorm = 42.9134, GNorm = 3.9563, lr_0 = 4.4546e-04
Validation rmse = 0.650625
Epoch 10
Loss = 6.2309e-01, PNorm = 42.9208, GNorm = 0.8798, lr_0 = 4.1596e-04
Validation rmse = 0.637108
Epoch 11
Loss = 6.3913e-01, PNorm = 42.9297, GNorm = 1.2827, lr_0 = 3.8312e-04
Validation rmse = 0.620600
Epoch 12
Loss = 5.6220e-01, PNorm = 42.9355, GNorm = 1.8147, lr_0 = 3.5774e-04
Loss = 6.6391e-01, PNorm = 42.9402, GNorm = 1.2362, lr_0 = 3.3405e-04
Validation rmse = 0.648329
Epoch 13
Loss = 6.0462e-01, PNorm = 42.9443, GNorm = 1.1426, lr_0 = 3.1192e-04
Validation rmse = 0.615714
Epoch 14
Loss = 6.1554e-01, PNorm = 42.9498, GNorm = 0.8260, lr_0 = 2.8730e-04
Validation rmse = 0.615097
Epoch 15
Loss = 6.8301e-01, PNorm = 42.9541, GNorm = 1.6553, lr_0 = 2.6827e-04
Validation rmse = 0.654201
Epoch 16
Loss = 6.7847e-01, PNorm = 42.9577, GNorm = 2.7978, lr_0 = 2.4709e-04
Loss = 5.9677e-01, PNorm = 42.9607, GNorm = 0.8036, lr_0 = 2.3073e-04
Validation rmse = 0.624268
Epoch 17
Loss = 6.0603e-01, PNorm = 42.9647, GNorm = 0.7444, lr_0 = 2.1544e-04
Validation rmse = 0.641255
Epoch 18
Loss = 5.8953e-01, PNorm = 42.9681, GNorm = 5.5179, lr_0 = 1.9844e-04
Validation rmse = 0.645475
Epoch 19
Loss = 6.5256e-01, PNorm = 42.9703, GNorm = 2.1616, lr_0 = 1.8529e-04
Loss = 5.7974e-01, PNorm = 42.9734, GNorm = 2.0146, lr_0 = 1.7302e-04
Loss = 7.1703e-01, PNorm = 42.9738, GNorm = 1.9822, lr_0 = 1.7066e-04
Validation rmse = 0.599997
Epoch 20
Loss = 5.9001e-01, PNorm = 42.9756, GNorm = 0.9041, lr_0 = 1.5936e-04
Validation rmse = 0.620606
Epoch 21
Loss = 5.7376e-01, PNorm = 42.9779, GNorm = 1.8346, lr_0 = 1.4881e-04
Validation rmse = 0.659861
Epoch 22
Loss = 5.8563e-01, PNorm = 42.9799, GNorm = 1.8335, lr_0 = 1.3706e-04
Loss = 6.1153e-01, PNorm = 42.9823, GNorm = 2.7638, lr_0 = 1.2798e-04
Validation rmse = 0.579832
Epoch 23
Loss = 6.1080e-01, PNorm = 42.9831, GNorm = 1.6801, lr_0 = 1.1950e-04
Validation rmse = 0.692404
Epoch 24
Loss = 5.8252e-01, PNorm = 42.9852, GNorm = 1.6802, lr_0 = 1.1007e-04
Validation rmse = 0.587816
Epoch 25
Loss = 6.4176e-01, PNorm = 42.9869, GNorm = 1.6123, lr_0 = 1.0278e-04
Loss = 5.7966e-01, PNorm = 42.9877, GNorm = 1.2270, lr_0 = 1.0000e-04
Validation rmse = 0.659771
Epoch 26
Loss = 5.7840e-01, PNorm = 42.9890, GNorm = 7.9568, lr_0 = 1.0000e-04
Validation rmse = 0.593303
Epoch 27
Loss = 5.8145e-01, PNorm = 42.9909, GNorm = 5.3887, lr_0 = 1.0000e-04
Validation rmse = 0.627146
Epoch 28
Loss = 4.7976e-01, PNorm = 42.9918, GNorm = 0.7777, lr_0 = 1.0000e-04
Validation rmse = 0.617427
Epoch 29
Loss = 5.3644e-01, PNorm = 42.9938, GNorm = 3.2924, lr_0 = 1.0000e-04
Loss = 5.4825e-01, PNorm = 42.9953, GNorm = 1.6108, lr_0 = 1.0000e-04
Validation rmse = 0.615616
Model 0 best validation rmse = 0.579832 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.540600
Ensemble test rmse = 0.540600
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.7268e+00, PNorm = 42.6818, GNorm = 6.3162, lr_0 = 7.5000e-04
Validation rmse = 0.737441
Epoch 1
Loss = 1.0097e+00, PNorm = 42.7167, GNorm = 2.5069, lr_0 = 1.0000e-03
Validation rmse = 0.732287
Epoch 2
Loss = 1.0784e+00, PNorm = 42.7516, GNorm = 0.8283, lr_0 = 9.3377e-04
Validation rmse = 0.724968
Epoch 3
Loss = 9.6774e-01, PNorm = 42.7852, GNorm = 0.8058, lr_0 = 8.6005e-04
Loss = 9.3914e-01, PNorm = 42.8083, GNorm = 0.9354, lr_0 = 8.0309e-04
Validation rmse = 0.692859
Epoch 4
Loss = 9.0352e-01, PNorm = 42.8275, GNorm = 0.9715, lr_0 = 7.4989e-04
Validation rmse = 0.676653
Epoch 5
Loss = 8.7032e-01, PNorm = 42.8492, GNorm = 1.1377, lr_0 = 6.9069e-04
Validation rmse = 0.650986
Epoch 6
Loss = 7.4644e-01, PNorm = 42.8654, GNorm = 1.0085, lr_0 = 6.4495e-04
Loss = 7.5113e-01, PNorm = 42.8778, GNorm = 3.0592, lr_0 = 6.0223e-04
Loss = 7.9329e-01, PNorm = 42.8795, GNorm = 2.8613, lr_0 = 5.9403e-04
Validation rmse = 0.647570
Epoch 7
Loss = 7.6479e-01, PNorm = 42.8892, GNorm = 4.2655, lr_0 = 5.5469e-04
Validation rmse = 0.649186
Epoch 8
Loss = 6.5220e-01, PNorm = 42.8978, GNorm = 1.2345, lr_0 = 5.1795e-04
Validation rmse = 0.590833
Epoch 9
Loss = 6.6616e-01, PNorm = 42.9091, GNorm = 3.3266, lr_0 = 4.7706e-04
Loss = 6.9083e-01, PNorm = 42.9167, GNorm = 1.5630, lr_0 = 4.4546e-04
Validation rmse = 0.574987
Epoch 10
Loss = 6.8607e-01, PNorm = 42.9227, GNorm = 5.0904, lr_0 = 4.1596e-04
Validation rmse = 0.593418
Epoch 11
Loss = 6.5940e-01, PNorm = 42.9286, GNorm = 3.0436, lr_0 = 3.8312e-04
Validation rmse = 0.573596
Epoch 12
Loss = 6.7135e-01, PNorm = 42.9337, GNorm = 1.8743, lr_0 = 3.5774e-04
Loss = 6.6665e-01, PNorm = 42.9390, GNorm = 3.2668, lr_0 = 3.3405e-04
Validation rmse = 0.583987
Epoch 13
Loss = 6.5664e-01, PNorm = 42.9438, GNorm = 3.7455, lr_0 = 3.1192e-04
Validation rmse = 0.626113
Epoch 14
Loss = 6.4508e-01, PNorm = 42.9492, GNorm = 0.7264, lr_0 = 2.8730e-04
Validation rmse = 0.562780
Epoch 15
Loss = 7.0182e-01, PNorm = 42.9543, GNorm = 2.5945, lr_0 = 2.6827e-04
Validation rmse = 0.605249
Epoch 16
Loss = 6.7658e-01, PNorm = 42.9593, GNorm = 3.9114, lr_0 = 2.4709e-04
Loss = 6.2914e-01, PNorm = 42.9632, GNorm = 4.1965, lr_0 = 2.3073e-04
Validation rmse = 0.587026
Epoch 17
Loss = 6.1386e-01, PNorm = 42.9664, GNorm = 1.0943, lr_0 = 2.1544e-04
Validation rmse = 0.570642
Epoch 18
Loss = 5.7743e-01, PNorm = 42.9704, GNorm = 2.9941, lr_0 = 1.9844e-04
Validation rmse = 0.603230
Epoch 19
Loss = 6.5491e-01, PNorm = 42.9730, GNorm = 1.2436, lr_0 = 1.8529e-04
Loss = 6.0316e-01, PNorm = 42.9763, GNorm = 0.8511, lr_0 = 1.7302e-04
Loss = 4.8995e-01, PNorm = 42.9768, GNorm = 1.2689, lr_0 = 1.7066e-04
Validation rmse = 0.553563
Epoch 20
Loss = 6.2179e-01, PNorm = 42.9787, GNorm = 0.8571, lr_0 = 1.5936e-04
Validation rmse = 0.598982
Epoch 21
Loss = 6.4572e-01, PNorm = 42.9809, GNorm = 4.5459, lr_0 = 1.4881e-04
Validation rmse = 0.567650
Epoch 22
Loss = 5.4236e-01, PNorm = 42.9836, GNorm = 0.9194, lr_0 = 1.3706e-04
Loss = 5.8949e-01, PNorm = 42.9856, GNorm = 1.7218, lr_0 = 1.2798e-04
Validation rmse = 0.577125
Epoch 23
Loss = 5.4694e-01, PNorm = 42.9875, GNorm = 1.4612, lr_0 = 1.1950e-04
Validation rmse = 0.570667
Epoch 24
Loss = 5.4388e-01, PNorm = 42.9899, GNorm = 0.8843, lr_0 = 1.1007e-04
Validation rmse = 0.566004
Epoch 25
Loss = 5.7132e-01, PNorm = 42.9915, GNorm = 1.3957, lr_0 = 1.0278e-04
Loss = 5.8223e-01, PNorm = 42.9930, GNorm = 1.3698, lr_0 = 1.0000e-04
Validation rmse = 0.590476
Epoch 26
Loss = 5.7345e-01, PNorm = 42.9946, GNorm = 1.1480, lr_0 = 1.0000e-04
Validation rmse = 0.563667
Epoch 27
Loss = 5.9223e-01, PNorm = 42.9967, GNorm = 1.3229, lr_0 = 1.0000e-04
Validation rmse = 0.571173
Epoch 28
Loss = 6.0937e-01, PNorm = 42.9983, GNorm = 2.8622, lr_0 = 1.0000e-04
Validation rmse = 0.578253
Epoch 29
Loss = 5.4590e-01, PNorm = 43.0001, GNorm = 1.3352, lr_0 = 1.0000e-04
Loss = 5.4714e-01, PNorm = 43.0018, GNorm = 2.7380, lr_0 = 1.0000e-04
Validation rmse = 0.567166
Model 0 best validation rmse = 0.553563 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.509092
Ensemble test rmse = 0.509092
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.6854e+00, PNorm = 42.6832, GNorm = 6.5055, lr_0 = 7.5000e-04
Validation rmse = 0.779950
Epoch 1
Loss = 1.0715e+00, PNorm = 42.7188, GNorm = 1.6002, lr_0 = 1.0000e-03
Validation rmse = 0.764579
Epoch 2
Loss = 9.2654e-01, PNorm = 42.7530, GNorm = 0.9732, lr_0 = 9.3377e-04
Validation rmse = 0.742976
Epoch 3
Loss = 9.2375e-01, PNorm = 42.7852, GNorm = 0.7881, lr_0 = 8.6005e-04
Loss = 9.7017e-01, PNorm = 42.8061, GNorm = 0.7445, lr_0 = 8.0309e-04
Validation rmse = 0.740080
Epoch 4
Loss = 9.0769e-01, PNorm = 42.8242, GNorm = 0.8472, lr_0 = 7.4989e-04
Validation rmse = 0.691824
Epoch 5
Loss = 9.4401e-01, PNorm = 42.8445, GNorm = 1.8134, lr_0 = 6.9069e-04
Validation rmse = 0.761126
Epoch 6
Loss = 8.1456e-01, PNorm = 42.8585, GNorm = 3.7963, lr_0 = 6.4495e-04
Loss = 8.2173e-01, PNorm = 42.8709, GNorm = 1.2023, lr_0 = 6.0223e-04
Loss = 9.0238e-01, PNorm = 42.8731, GNorm = 2.9814, lr_0 = 5.9403e-04
Validation rmse = 0.669339
Epoch 7
Loss = 7.9231e-01, PNorm = 42.8841, GNorm = 2.8026, lr_0 = 5.5469e-04
Validation rmse = 0.674879
Epoch 8
Loss = 7.5719e-01, PNorm = 42.8941, GNorm = 1.7403, lr_0 = 5.1795e-04
Validation rmse = 0.600533
Epoch 9
Loss = 6.8314e-01, PNorm = 42.9044, GNorm = 0.7767, lr_0 = 4.7706e-04
Loss = 7.4529e-01, PNorm = 42.9125, GNorm = 1.1521, lr_0 = 4.4546e-04
Validation rmse = 0.596390
Epoch 10
Loss = 7.0681e-01, PNorm = 42.9193, GNorm = 0.8526, lr_0 = 4.1596e-04
Validation rmse = 0.610619
Epoch 11
Loss = 6.7377e-01, PNorm = 42.9282, GNorm = 2.0053, lr_0 = 3.8312e-04
Validation rmse = 0.612908
Epoch 12
Loss = 5.6888e-01, PNorm = 42.9349, GNorm = 0.6088, lr_0 = 3.5774e-04
Loss = 7.0610e-01, PNorm = 42.9407, GNorm = 1.6145, lr_0 = 3.3405e-04
Validation rmse = 0.625737
Epoch 13
Loss = 6.3175e-01, PNorm = 42.9462, GNorm = 1.8825, lr_0 = 3.1192e-04
Validation rmse = 0.563181
Epoch 14
Loss = 7.0096e-01, PNorm = 42.9512, GNorm = 1.0218, lr_0 = 2.8730e-04
Validation rmse = 0.584562
Epoch 15
Loss = 6.8360e-01, PNorm = 42.9563, GNorm = 1.2391, lr_0 = 2.6827e-04
Validation rmse = 0.611963
Epoch 16
Loss = 6.2911e-01, PNorm = 42.9607, GNorm = 2.5036, lr_0 = 2.4709e-04
Loss = 6.2543e-01, PNorm = 42.9642, GNorm = 1.6521, lr_0 = 2.3073e-04
Validation rmse = 0.580209
Epoch 17
Loss = 5.8802e-01, PNorm = 42.9673, GNorm = 3.4584, lr_0 = 2.1544e-04
Validation rmse = 0.585811
Epoch 18
Loss = 6.1483e-01, PNorm = 42.9712, GNorm = 3.1527, lr_0 = 1.9844e-04
Validation rmse = 0.613035
Epoch 19
Loss = 6.8221e-01, PNorm = 42.9739, GNorm = 0.9879, lr_0 = 1.8529e-04
Loss = 5.9303e-01, PNorm = 42.9770, GNorm = 1.9863, lr_0 = 1.7302e-04
Loss = 5.8525e-01, PNorm = 42.9775, GNorm = 2.1712, lr_0 = 1.7066e-04
Validation rmse = 0.570227
Epoch 20
Loss = 6.3022e-01, PNorm = 42.9798, GNorm = 1.9853, lr_0 = 1.5936e-04
Validation rmse = 0.581600
Epoch 21
Loss = 5.8953e-01, PNorm = 42.9827, GNorm = 0.7531, lr_0 = 1.4881e-04
Validation rmse = 0.578079
Epoch 22
Loss = 5.4615e-01, PNorm = 42.9857, GNorm = 0.7035, lr_0 = 1.3706e-04
Loss = 6.1001e-01, PNorm = 42.9881, GNorm = 1.2397, lr_0 = 1.2798e-04
Validation rmse = 0.584981
Epoch 23
Loss = 6.0172e-01, PNorm = 42.9902, GNorm = 2.0141, lr_0 = 1.1950e-04
Validation rmse = 0.572697
Epoch 24
Loss = 5.9022e-01, PNorm = 42.9921, GNorm = 1.0733, lr_0 = 1.1007e-04
Validation rmse = 0.588081
Epoch 25
Loss = 5.8080e-01, PNorm = 42.9937, GNorm = 0.6415, lr_0 = 1.0278e-04
Loss = 5.7565e-01, PNorm = 42.9951, GNorm = 0.9107, lr_0 = 1.0000e-04
Validation rmse = 0.580123
Epoch 26
Loss = 5.7992e-01, PNorm = 42.9966, GNorm = 1.6194, lr_0 = 1.0000e-04
Validation rmse = 0.578048
Epoch 27
Loss = 5.6540e-01, PNorm = 42.9986, GNorm = 2.4857, lr_0 = 1.0000e-04
Validation rmse = 0.572529
Epoch 28
Loss = 6.1825e-01, PNorm = 43.0002, GNorm = 2.3043, lr_0 = 1.0000e-04
Validation rmse = 0.588287
Epoch 29
Loss = 5.5521e-01, PNorm = 43.0021, GNorm = 2.0182, lr_0 = 1.0000e-04
Loss = 5.7663e-01, PNorm = 43.0038, GNorm = 1.2371, lr_0 = 1.0000e-04
Validation rmse = 0.570823
Model 0 best validation rmse = 0.563181 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.626215
Ensemble test rmse = 0.626215
5-fold cross validation
	Seed 0 ==> test rmse = 0.558738
	Seed 1 ==> test rmse = 0.615220
	Seed 2 ==> test rmse = 0.540600
	Seed 3 ==> test rmse = 0.509092
	Seed 4 ==> test rmse = 0.626215
Overall test rmse = 0.569973 +/- 0.044511
Elapsed time = 0:30:05
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-e30316e7-233b-4683-9fc2-a9f75abac04f.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 512,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 512,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.0558e+01, PNorm = 43.1054, GNorm = 3.5787, lr_0 = 5.5000e-03
Validation rmse = 0.727148
Epoch 1
Loss = 1.0159e+00, PNorm = 45.4048, GNorm = 0.4294, lr_0 = 1.0000e-02
Validation rmse = 0.715011
Epoch 2
Loss = 8.1595e-01, PNorm = 47.7536, GNorm = 0.7059, lr_0 = 8.7192e-03
Validation rmse = 0.689715
Epoch 3
Loss = 8.1519e-01, PNorm = 49.5247, GNorm = 1.2472, lr_0 = 7.3969e-03
Loss = 8.9003e-01, PNorm = 50.3906, GNorm = 0.7040, lr_0 = 6.4495e-03
Validation rmse = 0.636144
Epoch 4
Loss = 9.9620e-01, PNorm = 50.8881, GNorm = 5.0738, lr_0 = 5.6234e-03
Validation rmse = 0.708008
Epoch 5
Loss = 8.4951e-01, PNorm = 51.2202, GNorm = 1.6759, lr_0 = 4.7706e-03
Validation rmse = 0.669654
Epoch 6
Loss = 8.0021e-01, PNorm = 51.3840, GNorm = 0.8104, lr_0 = 4.1596e-03
Loss = 8.5873e-01, PNorm = 51.4982, GNorm = 0.9167, lr_0 = 3.6268e-03
Loss = 7.9479e-01, PNorm = 51.5167, GNorm = 0.6034, lr_0 = 3.5287e-03
Validation rmse = 0.648571
Epoch 7
Loss = 7.9035e-01, PNorm = 51.5918, GNorm = 1.9311, lr_0 = 3.0768e-03
Validation rmse = 0.620241
Epoch 8
Loss = 7.0333e-01, PNorm = 51.6398, GNorm = 0.6762, lr_0 = 2.6827e-03
Validation rmse = 0.617467
Epoch 9
Loss = 6.9336e-01, PNorm = 51.6816, GNorm = 1.0702, lr_0 = 2.2758e-03
Loss = 7.2758e-01, PNorm = 51.7005, GNorm = 2.5951, lr_0 = 1.9844e-03
Validation rmse = 0.599498
Epoch 10
Loss = 7.3391e-01, PNorm = 51.7161, GNorm = 2.5147, lr_0 = 1.7302e-03
Validation rmse = 0.607116
Epoch 11
Loss = 7.2926e-01, PNorm = 51.7343, GNorm = 2.1236, lr_0 = 1.4678e-03
Validation rmse = 0.601011
Epoch 12
Loss = 7.1996e-01, PNorm = 51.7440, GNorm = 0.4543, lr_0 = 1.2798e-03
Loss = 6.9043e-01, PNorm = 51.7546, GNorm = 1.1323, lr_0 = 1.1159e-03
Validation rmse = 0.590645
Epoch 13
Loss = 6.8132e-01, PNorm = 51.7674, GNorm = 0.3364, lr_0 = 9.7296e-04
Validation rmse = 0.602014
Epoch 14
Loss = 7.0825e-01, PNorm = 51.7772, GNorm = 1.2075, lr_0 = 8.2540e-04
Validation rmse = 0.586343
Epoch 15
Loss = 6.1475e-01, PNorm = 51.7829, GNorm = 1.5195, lr_0 = 7.1969e-04
Validation rmse = 0.585199
Epoch 16
Loss = 6.9804e-01, PNorm = 51.7896, GNorm = 1.0636, lr_0 = 6.1054e-04
Loss = 6.5225e-01, PNorm = 51.7944, GNorm = 0.6989, lr_0 = 5.3234e-04
Validation rmse = 0.586811
Epoch 17
Loss = 6.1597e-01, PNorm = 51.7981, GNorm = 0.5040, lr_0 = 4.6416e-04
Validation rmse = 0.583729
Epoch 18
Loss = 5.4842e-01, PNorm = 51.8018, GNorm = 0.4066, lr_0 = 3.9377e-04
Validation rmse = 0.578623
Epoch 19
Loss = 6.4509e-01, PNorm = 51.8046, GNorm = 0.5515, lr_0 = 3.4333e-04
Loss = 6.3444e-01, PNorm = 51.8076, GNorm = 0.8283, lr_0 = 2.9936e-04
Loss = 7.7682e-01, PNorm = 51.8080, GNorm = 1.4716, lr_0 = 2.9126e-04
Validation rmse = 0.578283
Epoch 20
Loss = 6.5460e-01, PNorm = 51.8099, GNorm = 0.9374, lr_0 = 2.5396e-04
Validation rmse = 0.577893
Epoch 21
Loss = 6.2218e-01, PNorm = 51.8118, GNorm = 1.1405, lr_0 = 2.2143e-04
Validation rmse = 0.578353
Epoch 22
Loss = 6.9323e-01, PNorm = 51.8138, GNorm = 0.8912, lr_0 = 1.8785e-04
Loss = 6.1527e-01, PNorm = 51.8152, GNorm = 0.4489, lr_0 = 1.6379e-04
Validation rmse = 0.577973
Epoch 23
Loss = 6.3657e-01, PNorm = 51.8164, GNorm = 0.6545, lr_0 = 1.4281e-04
Validation rmse = 0.577428
Epoch 24
Loss = 6.5346e-01, PNorm = 51.8176, GNorm = 0.9597, lr_0 = 1.2115e-04
Validation rmse = 0.576555
Epoch 25
Loss = 6.9032e-01, PNorm = 51.8186, GNorm = 0.6119, lr_0 = 1.0564e-04
Loss = 6.3721e-01, PNorm = 51.8194, GNorm = 1.1047, lr_0 = 1.0000e-04
Validation rmse = 0.576943
Epoch 26
Loss = 6.1913e-01, PNorm = 51.8202, GNorm = 0.4293, lr_0 = 1.0000e-04
Validation rmse = 0.576019
Epoch 27
Loss = 6.7856e-01, PNorm = 51.8212, GNorm = 0.8852, lr_0 = 1.0000e-04
Validation rmse = 0.576353
Epoch 28
Loss = 6.0630e-01, PNorm = 51.8220, GNorm = 0.9293, lr_0 = 1.0000e-04
Validation rmse = 0.574880
Epoch 29
Loss = 5.3097e-01, PNorm = 51.8228, GNorm = 0.5291, lr_0 = 1.0000e-04
Loss = 6.5409e-01, PNorm = 51.8234, GNorm = 0.4795, lr_0 = 1.0000e-04
Validation rmse = 0.573868
Model 0 best validation rmse = 0.573868 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.584408
Ensemble test rmse = 0.584408
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.1126e+01, PNorm = 43.1098, GNorm = 3.6634, lr_0 = 5.5000e-03
Validation rmse = 0.707290
Epoch 1
Loss = 1.1103e+00, PNorm = 45.4117, GNorm = 2.4044, lr_0 = 1.0000e-02
Validation rmse = 0.704047
Epoch 2
Loss = 1.0389e+00, PNorm = 47.7674, GNorm = 0.2644, lr_0 = 8.7192e-03
Validation rmse = 0.696317
Epoch 3
Loss = 8.5461e-01, PNorm = 49.5264, GNorm = 0.5274, lr_0 = 7.3969e-03
Loss = 1.0449e+00, PNorm = 50.3495, GNorm = 0.4496, lr_0 = 6.4495e-03
Validation rmse = 0.696189
Epoch 4
Loss = 1.0024e+00, PNorm = 50.8289, GNorm = 0.3419, lr_0 = 5.6234e-03
Validation rmse = 0.686831
Epoch 5
Loss = 8.2621e-01, PNorm = 51.1529, GNorm = 0.7046, lr_0 = 4.7706e-03
Validation rmse = 0.663469
Epoch 6
Loss = 1.0134e+00, PNorm = 51.3124, GNorm = 2.7689, lr_0 = 4.1596e-03
Loss = 8.5792e-01, PNorm = 51.4184, GNorm = 0.6098, lr_0 = 3.6268e-03
Loss = 8.3152e-01, PNorm = 51.4358, GNorm = 0.6372, lr_0 = 3.5287e-03
Validation rmse = 0.664923
Epoch 7
Loss = 8.2047e-01, PNorm = 51.5050, GNorm = 1.0399, lr_0 = 3.0768e-03
Validation rmse = 0.608906
Epoch 8
Loss = 8.4194e-01, PNorm = 51.5499, GNorm = 2.5067, lr_0 = 2.6827e-03
Validation rmse = 0.602319
Epoch 9
Loss = 7.2828e-01, PNorm = 51.5869, GNorm = 1.2114, lr_0 = 2.2758e-03
Loss = 7.8110e-01, PNorm = 51.6118, GNorm = 1.4947, lr_0 = 1.9844e-03
Validation rmse = 0.592055
Epoch 10
Loss = 7.1069e-01, PNorm = 51.6327, GNorm = 0.8551, lr_0 = 1.7302e-03
Validation rmse = 0.584363
Epoch 11
Loss = 7.2734e-01, PNorm = 51.6508, GNorm = 1.9484, lr_0 = 1.4678e-03
Validation rmse = 0.578322
Epoch 12
Loss = 7.0015e-01, PNorm = 51.6600, GNorm = 0.6020, lr_0 = 1.2798e-03
Loss = 7.5905e-01, PNorm = 51.6673, GNorm = 0.7494, lr_0 = 1.1159e-03
Validation rmse = 0.571062
Epoch 13
Loss = 7.0773e-01, PNorm = 51.6759, GNorm = 0.4363, lr_0 = 9.7296e-04
Validation rmse = 0.566695
Epoch 14
Loss = 6.6529e-01, PNorm = 51.6838, GNorm = 3.1525, lr_0 = 8.2540e-04
Validation rmse = 0.564256
Epoch 15
Loss = 6.0973e-01, PNorm = 51.6894, GNorm = 0.9057, lr_0 = 7.1969e-04
Validation rmse = 0.562677
Epoch 16
Loss = 7.3168e-01, PNorm = 51.6951, GNorm = 1.4639, lr_0 = 6.1054e-04
Loss = 6.4799e-01, PNorm = 51.6991, GNorm = 0.6482, lr_0 = 5.3234e-04
Validation rmse = 0.561804
Epoch 17
Loss = 6.6462e-01, PNorm = 51.7030, GNorm = 1.9630, lr_0 = 4.6416e-04
Validation rmse = 0.559582
Epoch 18
Loss = 6.2640e-01, PNorm = 51.7068, GNorm = 0.5343, lr_0 = 3.9377e-04
Validation rmse = 0.557210
Epoch 19
Loss = 7.1401e-01, PNorm = 51.7095, GNorm = 1.1693, lr_0 = 3.4333e-04
Loss = 6.6901e-01, PNorm = 51.7121, GNorm = 2.0132, lr_0 = 2.9936e-04
Loss = 6.6074e-01, PNorm = 51.7125, GNorm = 1.0807, lr_0 = 2.9126e-04
Validation rmse = 0.555660
Epoch 20
Loss = 6.8143e-01, PNorm = 51.7146, GNorm = 0.5719, lr_0 = 2.5396e-04
Validation rmse = 0.554992
Epoch 21
Loss = 6.1103e-01, PNorm = 51.7162, GNorm = 0.9348, lr_0 = 2.2143e-04
Validation rmse = 0.553938
Epoch 22
Loss = 7.3822e-01, PNorm = 51.7181, GNorm = 1.3654, lr_0 = 1.8785e-04
Loss = 6.1780e-01, PNorm = 51.7195, GNorm = 0.5443, lr_0 = 1.6379e-04
Validation rmse = 0.553252
Epoch 23
Loss = 6.8673e-01, PNorm = 51.7207, GNorm = 0.6637, lr_0 = 1.4281e-04
Validation rmse = 0.552655
Epoch 24
Loss = 6.7763e-01, PNorm = 51.7219, GNorm = 0.9304, lr_0 = 1.2115e-04
Validation rmse = 0.552590
Epoch 25
Loss = 6.0289e-01, PNorm = 51.7227, GNorm = 1.3625, lr_0 = 1.0564e-04
Loss = 6.6424e-01, PNorm = 51.7235, GNorm = 0.7860, lr_0 = 1.0000e-04
Validation rmse = 0.551809
Epoch 26
Loss = 6.5044e-01, PNorm = 51.7242, GNorm = 1.2211, lr_0 = 1.0000e-04
Validation rmse = 0.551492
Epoch 27
Loss = 6.5280e-01, PNorm = 51.7251, GNorm = 0.4649, lr_0 = 1.0000e-04
Validation rmse = 0.551227
Epoch 28
Loss = 7.2566e-01, PNorm = 51.7259, GNorm = 1.4246, lr_0 = 1.0000e-04
Validation rmse = 0.551148
Epoch 29
Loss = 8.1283e-01, PNorm = 51.7269, GNorm = 0.6549, lr_0 = 1.0000e-04
Loss = 6.4045e-01, PNorm = 51.7276, GNorm = 1.7434, lr_0 = 1.0000e-04
Validation rmse = 0.550855
Model 0 best validation rmse = 0.550855 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.621738
Ensemble test rmse = 0.621738
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.0315e+01, PNorm = 43.1190, GNorm = 4.9136, lr_0 = 5.5000e-03
Validation rmse = 0.762047
Epoch 1
Loss = 1.1242e+00, PNorm = 45.4571, GNorm = 0.4757, lr_0 = 1.0000e-02
Validation rmse = 0.736206
Epoch 2
Loss = 8.7263e-01, PNorm = 47.8397, GNorm = 0.6845, lr_0 = 8.7192e-03
Validation rmse = 0.720932
Epoch 3
Loss = 8.9477e-01, PNorm = 49.6374, GNorm = 1.6164, lr_0 = 7.3969e-03
Loss = 8.8977e-01, PNorm = 50.5101, GNorm = 1.0186, lr_0 = 6.4495e-03
Validation rmse = 0.693960
Epoch 4
Loss = 8.2867e-01, PNorm = 51.0176, GNorm = 1.3648, lr_0 = 5.6234e-03
Validation rmse = 0.695880
Epoch 5
Loss = 7.5407e-01, PNorm = 51.3785, GNorm = 0.5946, lr_0 = 4.7706e-03
Validation rmse = 0.642873
Epoch 6
Loss = 9.1246e-01, PNorm = 51.5532, GNorm = 1.5150, lr_0 = 4.1596e-03
Loss = 7.0329e-01, PNorm = 51.6555, GNorm = 1.4482, lr_0 = 3.6268e-03
Loss = 5.3668e-01, PNorm = 51.6698, GNorm = 0.5819, lr_0 = 3.5287e-03
Validation rmse = 0.631377
Epoch 7
Loss = 6.5137e-01, PNorm = 51.7306, GNorm = 1.2240, lr_0 = 3.0768e-03
Validation rmse = 0.629032
Epoch 8
Loss = 7.1412e-01, PNorm = 51.7748, GNorm = 1.1716, lr_0 = 2.6827e-03
Validation rmse = 0.622232
Epoch 9
Loss = 6.4519e-01, PNorm = 51.8162, GNorm = 3.0818, lr_0 = 2.2758e-03
Loss = 7.0952e-01, PNorm = 51.8385, GNorm = 2.5063, lr_0 = 1.9844e-03
Validation rmse = 0.655851
Epoch 10
Loss = 6.1207e-01, PNorm = 51.8611, GNorm = 0.4222, lr_0 = 1.7302e-03
Validation rmse = 0.613690
Epoch 11
Loss = 6.4704e-01, PNorm = 51.8797, GNorm = 0.5254, lr_0 = 1.4678e-03
Validation rmse = 0.617391
Epoch 12
Loss = 5.6059e-01, PNorm = 51.8907, GNorm = 0.3408, lr_0 = 1.2798e-03
Loss = 6.6957e-01, PNorm = 51.8992, GNorm = 0.8756, lr_0 = 1.1159e-03
Validation rmse = 0.609759
Epoch 13
Loss = 6.1056e-01, PNorm = 51.9067, GNorm = 1.0287, lr_0 = 9.7296e-04
Validation rmse = 0.614130
Epoch 14
Loss = 6.2194e-01, PNorm = 51.9190, GNorm = 1.1213, lr_0 = 8.2540e-04
Validation rmse = 0.603103
Epoch 15
Loss = 6.8727e-01, PNorm = 51.9261, GNorm = 0.7017, lr_0 = 7.1969e-04
Validation rmse = 0.614624
Epoch 16
Loss = 6.9882e-01, PNorm = 51.9324, GNorm = 0.9700, lr_0 = 6.1054e-04
Loss = 6.0873e-01, PNorm = 51.9373, GNorm = 1.1611, lr_0 = 5.3234e-04
Validation rmse = 0.606073
Epoch 17
Loss = 6.0396e-01, PNorm = 51.9423, GNorm = 0.6214, lr_0 = 4.6416e-04
Validation rmse = 0.601956
Epoch 18
Loss = 6.0008e-01, PNorm = 51.9466, GNorm = 1.8003, lr_0 = 3.9377e-04
Validation rmse = 0.609207
Epoch 19
Loss = 6.3599e-01, PNorm = 51.9497, GNorm = 0.3522, lr_0 = 3.4333e-04
Loss = 6.0470e-01, PNorm = 51.9532, GNorm = 0.6122, lr_0 = 2.9936e-04
Loss = 7.3084e-01, PNorm = 51.9538, GNorm = 0.6055, lr_0 = 2.9126e-04
Validation rmse = 0.604011
Epoch 20
Loss = 6.1327e-01, PNorm = 51.9566, GNorm = 1.1188, lr_0 = 2.5396e-04
Validation rmse = 0.600302
Epoch 21
Loss = 6.0549e-01, PNorm = 51.9586, GNorm = 0.7694, lr_0 = 2.2143e-04
Validation rmse = 0.603173
Epoch 22
Loss = 6.1069e-01, PNorm = 51.9607, GNorm = 0.8441, lr_0 = 1.8785e-04
Loss = 6.3827e-01, PNorm = 51.9622, GNorm = 2.1946, lr_0 = 1.6379e-04
Validation rmse = 0.605990
Epoch 23
Loss = 6.1359e-01, PNorm = 51.9638, GNorm = 0.4331, lr_0 = 1.4281e-04
Validation rmse = 0.598461
Epoch 24
Loss = 5.8535e-01, PNorm = 51.9656, GNorm = 1.4139, lr_0 = 1.2115e-04
Validation rmse = 0.598298
Epoch 25
Loss = 6.7158e-01, PNorm = 51.9668, GNorm = 1.0597, lr_0 = 1.0564e-04
Loss = 5.7819e-01, PNorm = 51.9677, GNorm = 1.0254, lr_0 = 1.0000e-04
Validation rmse = 0.598505
Epoch 26
Loss = 5.9230e-01, PNorm = 51.9685, GNorm = 2.0517, lr_0 = 1.0000e-04
Validation rmse = 0.603231
Epoch 27
Loss = 5.6957e-01, PNorm = 51.9697, GNorm = 0.7065, lr_0 = 1.0000e-04
Validation rmse = 0.603351
Epoch 28
Loss = 5.3673e-01, PNorm = 51.9707, GNorm = 1.0252, lr_0 = 1.0000e-04
Validation rmse = 0.601209
Epoch 29
Loss = 6.0167e-01, PNorm = 51.9720, GNorm = 1.2209, lr_0 = 1.0000e-04
Loss = 5.9611e-01, PNorm = 51.9729, GNorm = 1.1568, lr_0 = 1.0000e-04
Validation rmse = 0.599786
Model 0 best validation rmse = 0.598298 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.539892
Ensemble test rmse = 0.539892
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 8.7004e+00, PNorm = 43.1082, GNorm = 2.4809, lr_0 = 5.5000e-03
Validation rmse = 0.742495
Epoch 1
Loss = 1.0202e+00, PNorm = 45.4002, GNorm = 0.5841, lr_0 = 1.0000e-02
Validation rmse = 0.768613
Epoch 2
Loss = 1.1178e+00, PNorm = 47.7491, GNorm = 1.2576, lr_0 = 8.7192e-03
Validation rmse = 0.721177
Epoch 3
Loss = 9.7467e-01, PNorm = 49.5248, GNorm = 0.6734, lr_0 = 7.3969e-03
Loss = 8.8460e-01, PNorm = 50.3843, GNorm = 0.5675, lr_0 = 6.4495e-03
Validation rmse = 0.671395
Epoch 4
Loss = 7.7417e-01, PNorm = 50.9042, GNorm = 0.5616, lr_0 = 5.6234e-03
Validation rmse = 0.628412
Epoch 5
Loss = 8.3497e-01, PNorm = 51.2380, GNorm = 0.7746, lr_0 = 4.7706e-03
Validation rmse = 0.626977
Epoch 6
Loss = 7.1934e-01, PNorm = 51.4055, GNorm = 1.9592, lr_0 = 4.1596e-03
Loss = 7.3668e-01, PNorm = 51.5154, GNorm = 0.5644, lr_0 = 3.6268e-03
Loss = 8.0629e-01, PNorm = 51.5320, GNorm = 2.1986, lr_0 = 3.5287e-03
Validation rmse = 0.610286
Epoch 7
Loss = 6.8611e-01, PNorm = 51.5989, GNorm = 0.4578, lr_0 = 3.0768e-03
Validation rmse = 0.598981
Epoch 8
Loss = 6.2681e-01, PNorm = 51.6430, GNorm = 0.4267, lr_0 = 2.6827e-03
Validation rmse = 0.598727
Epoch 9
Loss = 7.0897e-01, PNorm = 51.6792, GNorm = 3.2828, lr_0 = 2.2758e-03
Loss = 6.9702e-01, PNorm = 51.6999, GNorm = 1.9791, lr_0 = 1.9844e-03
Validation rmse = 0.608570
Epoch 10
Loss = 6.6614e-01, PNorm = 51.7210, GNorm = 0.5084, lr_0 = 1.7302e-03
Validation rmse = 0.594467
Epoch 11
Loss = 6.7800e-01, PNorm = 51.7358, GNorm = 3.0573, lr_0 = 1.4678e-03
Validation rmse = 0.592792
Epoch 12
Loss = 6.7564e-01, PNorm = 51.7480, GNorm = 1.5904, lr_0 = 1.2798e-03
Loss = 6.5072e-01, PNorm = 51.7563, GNorm = 1.7503, lr_0 = 1.1159e-03
Validation rmse = 0.598946
Epoch 13
Loss = 6.5004e-01, PNorm = 51.7653, GNorm = 0.8159, lr_0 = 9.7296e-04
Validation rmse = 0.585942
Epoch 14
Loss = 6.4329e-01, PNorm = 51.7741, GNorm = 0.8966, lr_0 = 8.2540e-04
Validation rmse = 0.589095
Epoch 15
Loss = 6.6566e-01, PNorm = 51.7809, GNorm = 0.5109, lr_0 = 7.1969e-04
Validation rmse = 0.585155
Epoch 16
Loss = 6.4214e-01, PNorm = 51.7882, GNorm = 1.3127, lr_0 = 6.1054e-04
Loss = 6.2053e-01, PNorm = 51.7929, GNorm = 1.5203, lr_0 = 5.3234e-04
Validation rmse = 0.580895
Epoch 17
Loss = 6.2215e-01, PNorm = 51.7971, GNorm = 0.4923, lr_0 = 4.6416e-04
Validation rmse = 0.581490
Epoch 18
Loss = 6.1224e-01, PNorm = 51.8013, GNorm = 0.7551, lr_0 = 3.9377e-04
Validation rmse = 0.578194
Epoch 19
Loss = 6.5902e-01, PNorm = 51.8042, GNorm = 0.6877, lr_0 = 3.4333e-04
Loss = 6.0222e-01, PNorm = 51.8067, GNorm = 0.6604, lr_0 = 2.9936e-04
Loss = 5.2759e-01, PNorm = 51.8072, GNorm = 2.1773, lr_0 = 2.9126e-04
Validation rmse = 0.581730
Epoch 20
Loss = 6.2876e-01, PNorm = 51.8096, GNorm = 0.6786, lr_0 = 2.5396e-04
Validation rmse = 0.576191
Epoch 21
Loss = 6.3209e-01, PNorm = 51.8117, GNorm = 1.0489, lr_0 = 2.2143e-04
Validation rmse = 0.576535
Epoch 22
Loss = 5.8272e-01, PNorm = 51.8134, GNorm = 0.4339, lr_0 = 1.8785e-04
Loss = 6.3011e-01, PNorm = 51.8147, GNorm = 0.9106, lr_0 = 1.6379e-04
Validation rmse = 0.578566
Epoch 23
Loss = 5.6967e-01, PNorm = 51.8159, GNorm = 0.4904, lr_0 = 1.4281e-04
Validation rmse = 0.578300
Epoch 24
Loss = 5.6247e-01, PNorm = 51.8175, GNorm = 0.8167, lr_0 = 1.2115e-04
Validation rmse = 0.575568
Epoch 25
Loss = 5.9382e-01, PNorm = 51.8186, GNorm = 0.5263, lr_0 = 1.0564e-04
Loss = 6.0073e-01, PNorm = 51.8194, GNorm = 0.9533, lr_0 = 1.0000e-04
Validation rmse = 0.575523
Epoch 26
Loss = 5.9677e-01, PNorm = 51.8202, GNorm = 0.7125, lr_0 = 1.0000e-04
Validation rmse = 0.576711
Epoch 27
Loss = 6.2143e-01, PNorm = 51.8213, GNorm = 1.4389, lr_0 = 1.0000e-04
Validation rmse = 0.576129
Epoch 28
Loss = 6.4395e-01, PNorm = 51.8223, GNorm = 1.5965, lr_0 = 1.0000e-04
Validation rmse = 0.574537
Epoch 29
Loss = 5.6866e-01, PNorm = 51.8233, GNorm = 1.2069, lr_0 = 1.0000e-04
Loss = 5.9821e-01, PNorm = 51.8240, GNorm = 1.2400, lr_0 = 1.0000e-04
Validation rmse = 0.575326
Model 0 best validation rmse = 0.574537 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.501035
Ensemble test rmse = 0.501035
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=512, bias=False)
        (W_h): Linear(in_features=512, out_features=512, bias=False)
        (W_o): Linear(in_features=645, out_features=512, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 931,841
Epoch 0
Loss = 1.0249e+01, PNorm = 43.1112, GNorm = 3.0952, lr_0 = 5.5000e-03
Validation rmse = 0.809064
Epoch 1
Loss = 1.0834e+00, PNorm = 45.4497, GNorm = 0.5599, lr_0 = 1.0000e-02
Validation rmse = 0.751960
Epoch 2
Loss = 9.5038e-01, PNorm = 47.8390, GNorm = 1.4184, lr_0 = 8.7192e-03
Validation rmse = 0.748155
Epoch 3
Loss = 9.3801e-01, PNorm = 49.6277, GNorm = 0.5086, lr_0 = 7.3969e-03
Loss = 9.8091e-01, PNorm = 50.4752, GNorm = 0.9430, lr_0 = 6.4495e-03
Validation rmse = 0.712933
Epoch 4
Loss = 9.0098e-01, PNorm = 50.9827, GNorm = 1.6385, lr_0 = 5.6234e-03
Validation rmse = 0.661199
Epoch 5
Loss = 9.1308e-01, PNorm = 51.3328, GNorm = 1.3677, lr_0 = 4.7706e-03
Validation rmse = 0.669275
Epoch 6
Loss = 6.7757e-01, PNorm = 51.5072, GNorm = 1.4917, lr_0 = 4.1596e-03
Loss = 8.2024e-01, PNorm = 51.6142, GNorm = 2.9598, lr_0 = 3.6268e-03
Loss = 9.7599e-01, PNorm = 51.6304, GNorm = 3.0472, lr_0 = 3.5287e-03
Validation rmse = 0.623037
Epoch 7
Loss = 7.7067e-01, PNorm = 51.6941, GNorm = 2.1111, lr_0 = 3.0768e-03
Validation rmse = 0.672167
Epoch 8
Loss = 8.0501e-01, PNorm = 51.7407, GNorm = 1.8593, lr_0 = 2.6827e-03
Validation rmse = 0.605107
Epoch 9
Loss = 7.2163e-01, PNorm = 51.7842, GNorm = 1.5803, lr_0 = 2.2758e-03
Loss = 7.3715e-01, PNorm = 51.8120, GNorm = 0.8409, lr_0 = 1.9844e-03
Validation rmse = 0.628766
Epoch 10
Loss = 7.0508e-01, PNorm = 51.8352, GNorm = 0.5205, lr_0 = 1.7302e-03
Validation rmse = 0.579823
Epoch 11
Loss = 6.4328e-01, PNorm = 51.8565, GNorm = 0.7516, lr_0 = 1.4678e-03
Validation rmse = 0.598059
Epoch 12
Loss = 5.9418e-01, PNorm = 51.8712, GNorm = 0.3645, lr_0 = 1.2798e-03
Loss = 7.2405e-01, PNorm = 51.8815, GNorm = 1.1041, lr_0 = 1.1159e-03
Validation rmse = 0.581760
Epoch 13
Loss = 6.3446e-01, PNorm = 51.8898, GNorm = 1.7838, lr_0 = 9.7296e-04
Validation rmse = 0.587807
Epoch 14
Loss = 7.0630e-01, PNorm = 51.8998, GNorm = 1.5169, lr_0 = 8.2540e-04
Validation rmse = 0.576296
Epoch 15
Loss = 6.8772e-01, PNorm = 51.9069, GNorm = 0.7327, lr_0 = 7.1969e-04
Validation rmse = 0.582368
Epoch 16
Loss = 6.6514e-01, PNorm = 51.9141, GNorm = 1.5210, lr_0 = 6.1054e-04
Loss = 6.3189e-01, PNorm = 51.9187, GNorm = 0.7804, lr_0 = 5.3234e-04
Validation rmse = 0.574275
Epoch 17
Loss = 5.9073e-01, PNorm = 51.9231, GNorm = 1.4019, lr_0 = 4.6416e-04
Validation rmse = 0.571240
Epoch 18
Loss = 6.4208e-01, PNorm = 51.9275, GNorm = 0.8521, lr_0 = 3.9377e-04
Validation rmse = 0.571153
Epoch 19
Loss = 6.3859e-01, PNorm = 51.9302, GNorm = 0.5873, lr_0 = 3.4333e-04
Loss = 6.2906e-01, PNorm = 51.9325, GNorm = 0.7079, lr_0 = 2.9936e-04
Loss = 5.2437e-01, PNorm = 51.9329, GNorm = 0.5635, lr_0 = 2.9126e-04
Validation rmse = 0.573584
Epoch 20
Loss = 6.7290e-01, PNorm = 51.9348, GNorm = 0.8916, lr_0 = 2.5396e-04
Validation rmse = 0.574851
Epoch 21
Loss = 6.2747e-01, PNorm = 51.9367, GNorm = 0.5416, lr_0 = 2.2143e-04
Validation rmse = 0.570378
Epoch 22
Loss = 5.5257e-01, PNorm = 51.9386, GNorm = 0.5528, lr_0 = 1.8785e-04
Loss = 6.5188e-01, PNorm = 51.9399, GNorm = 0.5719, lr_0 = 1.6379e-04
Validation rmse = 0.570578
Epoch 23
Loss = 6.4126e-01, PNorm = 51.9411, GNorm = 1.5317, lr_0 = 1.4281e-04
Validation rmse = 0.572038
Epoch 24
Loss = 6.3587e-01, PNorm = 51.9424, GNorm = 0.6943, lr_0 = 1.2115e-04
Validation rmse = 0.571984
Epoch 25
Loss = 6.1212e-01, PNorm = 51.9434, GNorm = 0.3970, lr_0 = 1.0564e-04
Loss = 6.0207e-01, PNorm = 51.9442, GNorm = 0.6260, lr_0 = 1.0000e-04
Validation rmse = 0.570167
Epoch 26
Loss = 6.2707e-01, PNorm = 51.9449, GNorm = 0.9829, lr_0 = 1.0000e-04
Validation rmse = 0.570114
Epoch 27
Loss = 6.1153e-01, PNorm = 51.9458, GNorm = 1.1448, lr_0 = 1.0000e-04
Validation rmse = 0.570568
Epoch 28
Loss = 6.8491e-01, PNorm = 51.9466, GNorm = 0.8971, lr_0 = 1.0000e-04
Validation rmse = 0.569642
Epoch 29
Loss = 6.3154e-01, PNorm = 51.9476, GNorm = 0.7252, lr_0 = 1.0000e-04
Loss = 6.2462e-01, PNorm = 51.9483, GNorm = 0.5769, lr_0 = 1.0000e-04
Validation rmse = 0.569633
Model 0 best validation rmse = 0.569633 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.606953
Ensemble test rmse = 0.606953
5-fold cross validation
	Seed 0 ==> test rmse = 0.584408
	Seed 1 ==> test rmse = 0.621738
	Seed 2 ==> test rmse = 0.539892
	Seed 3 ==> test rmse = 0.501035
	Seed 4 ==> test rmse = 0.606953
Overall test rmse = 0.570805 +/- 0.044518
Elapsed time = 0:30:00
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-e30316e7-233b-4683-9fc2-a9f75abac04f.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 64,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.4,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 256,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 256,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.5591e+00, PNorm = 31.8354, GNorm = 2.6028, lr_0 = 2.3846e-03
Loss = 1.0408e+00, PNorm = 31.9330, GNorm = 1.4758, lr_0 = 4.2885e-03
Validation rmse = 0.787564
Epoch 1
Loss = 1.1415e+00, PNorm = 32.1962, GNorm = 1.7886, lr_0 = 6.5731e-03
Loss = 1.0775e+00, PNorm = 32.5301, GNorm = 1.7369, lr_0 = 8.4769e-03
Loss = 8.6728e-01, PNorm = 32.9431, GNorm = 1.4014, lr_0 = 9.5669e-03
Validation rmse = 0.651108
Epoch 2
Loss = 7.1310e-01, PNorm = 33.3521, GNorm = 2.2902, lr_0 = 7.3347e-03
Loss = 9.5475e-01, PNorm = 33.5684, GNorm = 0.9174, lr_0 = 5.8780e-03
Validation rmse = 0.611245
Epoch 3
Loss = 7.3761e-01, PNorm = 33.7253, GNorm = 1.6819, lr_0 = 4.5066e-03
Loss = 8.0467e-01, PNorm = 33.8026, GNorm = 0.7128, lr_0 = 3.6115e-03
Loss = 7.0157e-01, PNorm = 33.8522, GNorm = 1.1662, lr_0 = 2.8943e-03
Validation rmse = 0.591748
Epoch 4
Loss = 7.8289e-01, PNorm = 33.8882, GNorm = 1.3575, lr_0 = 2.2190e-03
Loss = 7.4845e-01, PNorm = 33.9086, GNorm = 0.7181, lr_0 = 1.7783e-03
Loss = 7.0360e-01, PNorm = 33.9210, GNorm = 1.3177, lr_0 = 1.4251e-03
Loss = 7.0991e-01, PNorm = 33.9231, GNorm = 1.7594, lr_0 = 1.3634e-03
Validation rmse = 0.598165
Epoch 5
Loss = 6.7460e-01, PNorm = 33.9350, GNorm = 0.7484, lr_0 = 1.0926e-03
Loss = 6.9632e-01, PNorm = 33.9446, GNorm = 1.4218, lr_0 = 8.7560e-04
Validation rmse = 0.583790
Epoch 6
Loss = 6.5312e-01, PNorm = 33.9513, GNorm = 1.1997, lr_0 = 6.7131e-04
Loss = 7.3094e-01, PNorm = 33.9553, GNorm = 1.0882, lr_0 = 5.3798e-04
Loss = 6.2454e-01, PNorm = 33.9587, GNorm = 0.9989, lr_0 = 4.3114e-04
Validation rmse = 0.589326
Epoch 7
Loss = 6.9874e-01, PNorm = 33.9606, GNorm = 1.5541, lr_0 = 3.3055e-04
Loss = 6.6752e-01, PNorm = 33.9616, GNorm = 1.5881, lr_0 = 2.6490e-04
Validation rmse = 0.581870
Epoch 8
Loss = 7.5567e-01, PNorm = 33.9622, GNorm = 0.9053, lr_0 = 2.0309e-04
Loss = 6.2439e-01, PNorm = 33.9625, GNorm = 0.6069, lr_0 = 1.6276e-04
Loss = 6.5311e-01, PNorm = 33.9629, GNorm = 0.7277, lr_0 = 1.3043e-04
Validation rmse = 0.579732
Epoch 9
Loss = 6.1707e-01, PNorm = 33.9636, GNorm = 0.9071, lr_0 = 1.0000e-04
Loss = 6.9886e-01, PNorm = 33.9641, GNorm = 0.9063, lr_0 = 1.0000e-04
Loss = 6.0508e-01, PNorm = 33.9647, GNorm = 2.2758, lr_0 = 1.0000e-04
Loss = 5.3523e-01, PNorm = 33.9648, GNorm = 4.0263, lr_0 = 1.0000e-04
Validation rmse = 0.580216
Model 0 best validation rmse = 0.579732 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.585480
Ensemble test rmse = 0.585480
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.3119e+00, PNorm = 31.8364, GNorm = 4.1563, lr_0 = 2.3846e-03
Loss = 1.1853e+00, PNorm = 31.9451, GNorm = 1.1977, lr_0 = 4.2885e-03
Validation rmse = 0.759358
Epoch 1
Loss = 1.0694e+00, PNorm = 32.2482, GNorm = 3.5141, lr_0 = 6.5731e-03
Loss = 1.0110e+00, PNorm = 32.6090, GNorm = 1.1978, lr_0 = 8.4769e-03
Loss = 9.5456e-01, PNorm = 33.0173, GNorm = 0.6877, lr_0 = 9.5669e-03
Validation rmse = 0.692437
Epoch 2
Loss = 1.0189e+00, PNorm = 33.3961, GNorm = 0.9260, lr_0 = 7.3347e-03
Loss = 9.4367e-01, PNorm = 33.5958, GNorm = 0.9173, lr_0 = 5.8780e-03
Validation rmse = 0.615738
Epoch 3
Loss = 8.1233e-01, PNorm = 33.7518, GNorm = 1.1649, lr_0 = 4.5066e-03
Loss = 8.1084e-01, PNorm = 33.8364, GNorm = 0.8589, lr_0 = 3.6115e-03
Loss = 8.8630e-01, PNorm = 33.8711, GNorm = 1.6080, lr_0 = 2.8943e-03
Validation rmse = 0.617879
Epoch 4
Loss = 8.9275e-01, PNorm = 33.9095, GNorm = 1.6207, lr_0 = 2.2190e-03
Loss = 8.2422e-01, PNorm = 33.9353, GNorm = 0.6429, lr_0 = 1.7783e-03
Loss = 7.5844e-01, PNorm = 33.9535, GNorm = 1.0293, lr_0 = 1.4251e-03
Loss = 1.0358e+00, PNorm = 33.9561, GNorm = 2.1462, lr_0 = 1.3634e-03
Validation rmse = 0.600140
Epoch 5
Loss = 6.8347e-01, PNorm = 33.9659, GNorm = 0.7847, lr_0 = 1.0926e-03
Loss = 7.9366e-01, PNorm = 33.9735, GNorm = 1.7807, lr_0 = 8.7560e-04
Validation rmse = 0.565628
Epoch 6
Loss = 7.6718e-01, PNorm = 33.9815, GNorm = 0.7873, lr_0 = 6.7131e-04
Loss = 6.4116e-01, PNorm = 33.9855, GNorm = 0.9721, lr_0 = 5.3798e-04
Loss = 7.4089e-01, PNorm = 33.9891, GNorm = 1.0156, lr_0 = 4.3114e-04
Validation rmse = 0.556016
Epoch 7
Loss = 6.7220e-01, PNorm = 33.9932, GNorm = 0.8995, lr_0 = 3.3055e-04
Loss = 6.9675e-01, PNorm = 33.9952, GNorm = 2.1600, lr_0 = 2.6490e-04
Validation rmse = 0.555424
Epoch 8
Loss = 5.8362e-01, PNorm = 33.9965, GNorm = 0.6314, lr_0 = 2.0309e-04
Loss = 7.6074e-01, PNorm = 33.9973, GNorm = 1.2156, lr_0 = 1.6276e-04
Loss = 6.7479e-01, PNorm = 33.9977, GNorm = 1.5784, lr_0 = 1.3043e-04
Validation rmse = 0.553139
Epoch 9
Loss = 7.0066e-01, PNorm = 33.9979, GNorm = 1.2572, lr_0 = 1.0000e-04
Loss = 6.8942e-01, PNorm = 33.9980, GNorm = 0.7243, lr_0 = 1.0000e-04
Loss = 7.7909e-01, PNorm = 33.9981, GNorm = 1.4086, lr_0 = 1.0000e-04
Loss = 2.9142e-01, PNorm = 33.9981, GNorm = 1.4543, lr_0 = 1.0000e-04
Validation rmse = 0.552198
Model 0 best validation rmse = 0.552198 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.639619
Ensemble test rmse = 0.639619
Fold 2
Splitting data with seed 2
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.4419e+00, PNorm = 31.8357, GNorm = 3.4362, lr_0 = 2.3846e-03
Loss = 1.1439e+00, PNorm = 31.9327, GNorm = 1.7847, lr_0 = 4.2885e-03
Validation rmse = 0.733506
Epoch 1
Loss = 1.0280e+00, PNorm = 32.2057, GNorm = 1.7548, lr_0 = 6.5731e-03
Loss = 1.0934e+00, PNorm = 32.5360, GNorm = 0.7580, lr_0 = 8.4769e-03
Loss = 9.1493e-01, PNorm = 32.9403, GNorm = 0.9350, lr_0 = 9.5669e-03
Validation rmse = 0.700966
Epoch 2
Loss = 8.2920e-01, PNorm = 33.3300, GNorm = 1.1265, lr_0 = 7.3347e-03
Loss = 8.9246e-01, PNorm = 33.5366, GNorm = 2.5964, lr_0 = 5.8780e-03
Validation rmse = 0.703477
Epoch 3
Loss = 9.5198e-01, PNorm = 33.6842, GNorm = 1.5939, lr_0 = 4.5066e-03
Loss = 8.1169e-01, PNorm = 33.7707, GNorm = 1.0451, lr_0 = 3.6115e-03
Loss = 7.6498e-01, PNorm = 33.8294, GNorm = 0.7430, lr_0 = 2.8943e-03
Validation rmse = 0.662767
Epoch 4
Loss = 6.5091e-01, PNorm = 33.8687, GNorm = 1.4716, lr_0 = 2.2190e-03
Loss = 7.8666e-01, PNorm = 33.8923, GNorm = 0.8849, lr_0 = 1.7783e-03
Loss = 6.2487e-01, PNorm = 33.9008, GNorm = 1.9516, lr_0 = 1.4251e-03
Loss = 5.6808e-01, PNorm = 33.9010, GNorm = 4.1085, lr_0 = 1.3634e-03
Validation rmse = 0.675733
Epoch 5
Loss = 7.6551e-01, PNorm = 33.9080, GNorm = 1.6195, lr_0 = 1.0926e-03
Loss = 6.6966e-01, PNorm = 33.9181, GNorm = 0.9069, lr_0 = 8.7560e-04
Validation rmse = 0.633902
Epoch 6
Loss = 8.7018e-01, PNorm = 33.9307, GNorm = 1.9628, lr_0 = 6.7131e-04
Loss = 7.7463e-01, PNorm = 33.9347, GNorm = 1.3970, lr_0 = 5.3798e-04
Loss = 6.3994e-01, PNorm = 33.9358, GNorm = 0.7089, lr_0 = 4.3114e-04
Validation rmse = 0.631211
Epoch 7
Loss = 6.4340e-01, PNorm = 33.9376, GNorm = 1.0749, lr_0 = 3.3055e-04
Loss = 6.5427e-01, PNorm = 33.9393, GNorm = 1.3762, lr_0 = 2.6490e-04
Validation rmse = 0.637903
Epoch 8
Loss = 9.5651e-01, PNorm = 33.9410, GNorm = 1.0763, lr_0 = 2.0309e-04
Loss = 6.8525e-01, PNorm = 33.9417, GNorm = 1.0328, lr_0 = 1.6276e-04
Loss = 6.5825e-01, PNorm = 33.9427, GNorm = 1.1682, lr_0 = 1.3043e-04
Validation rmse = 0.633025
Epoch 9
Loss = 6.5441e-01, PNorm = 33.9437, GNorm = 0.6961, lr_0 = 1.0000e-04
Loss = 7.6728e-01, PNorm = 33.9443, GNorm = 0.9619, lr_0 = 1.0000e-04
Loss = 6.2614e-01, PNorm = 33.9447, GNorm = 1.4320, lr_0 = 1.0000e-04
Loss = 1.0820e+00, PNorm = 33.9449, GNorm = 4.8657, lr_0 = 1.0000e-04
Validation rmse = 0.628716
Model 0 best validation rmse = 0.628716 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.554740
Ensemble test rmse = 0.554740
Fold 3
Splitting data with seed 3
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.3307e+00, PNorm = 31.8372, GNorm = 2.8727, lr_0 = 2.3846e-03
Loss = 1.1321e+00, PNorm = 31.9345, GNorm = 1.6767, lr_0 = 4.2885e-03
Validation rmse = 0.749490
Epoch 1
Loss = 9.9823e-01, PNorm = 32.2066, GNorm = 2.3323, lr_0 = 6.5731e-03
Loss = 1.0270e+00, PNorm = 32.5508, GNorm = 0.9394, lr_0 = 8.4769e-03
Loss = 1.0206e+00, PNorm = 32.9637, GNorm = 1.7688, lr_0 = 9.5669e-03
Validation rmse = 0.704371
Epoch 2
Loss = 9.9427e-01, PNorm = 33.3767, GNorm = 1.1914, lr_0 = 7.3347e-03
Loss = 9.5645e-01, PNorm = 33.5864, GNorm = 1.4267, lr_0 = 5.8780e-03
Validation rmse = 0.679917
Epoch 3
Loss = 9.2746e-01, PNorm = 33.7492, GNorm = 0.6449, lr_0 = 4.5066e-03
Loss = 7.9246e-01, PNorm = 33.8452, GNorm = 0.5961, lr_0 = 3.6115e-03
Loss = 7.8842e-01, PNorm = 33.8972, GNorm = 0.8037, lr_0 = 2.8943e-03
Validation rmse = 0.634273
Epoch 4
Loss = 8.1956e-01, PNorm = 33.9362, GNorm = 0.6837, lr_0 = 2.2190e-03
Loss = 7.3346e-01, PNorm = 33.9558, GNorm = 1.1564, lr_0 = 1.7783e-03
Loss = 7.0674e-01, PNorm = 33.9674, GNorm = 0.6245, lr_0 = 1.4251e-03
Loss = 9.6778e-01, PNorm = 33.9709, GNorm = 3.0305, lr_0 = 1.3634e-03
Validation rmse = 0.624149
Epoch 5
Loss = 7.5863e-01, PNorm = 33.9848, GNorm = 1.0081, lr_0 = 1.0926e-03
Loss = 6.8337e-01, PNorm = 33.9943, GNorm = 0.9107, lr_0 = 8.7560e-04
Validation rmse = 0.606111
Epoch 6
Loss = 6.9936e-01, PNorm = 34.0004, GNorm = 0.6370, lr_0 = 6.7131e-04
Loss = 6.9670e-01, PNorm = 34.0028, GNorm = 0.6145, lr_0 = 5.3798e-04
Loss = 6.9997e-01, PNorm = 34.0057, GNorm = 1.0288, lr_0 = 4.3114e-04
Validation rmse = 0.606809
Epoch 7
Loss = 6.9311e-01, PNorm = 34.0073, GNorm = 0.9459, lr_0 = 3.3055e-04
Loss = 6.9184e-01, PNorm = 34.0089, GNorm = 0.8452, lr_0 = 2.6490e-04
Validation rmse = 0.601227
Epoch 8
Loss = 6.8775e-01, PNorm = 34.0096, GNorm = 0.9280, lr_0 = 2.0309e-04
Loss = 6.1547e-01, PNorm = 34.0097, GNorm = 0.6171, lr_0 = 1.6276e-04
Loss = 6.4983e-01, PNorm = 34.0100, GNorm = 2.0101, lr_0 = 1.3043e-04
Validation rmse = 0.607039
Epoch 9
Loss = 6.3625e-01, PNorm = 34.0108, GNorm = 0.5894, lr_0 = 1.0000e-04
Loss = 6.8320e-01, PNorm = 34.0114, GNorm = 0.7034, lr_0 = 1.0000e-04
Loss = 6.9348e-01, PNorm = 34.0121, GNorm = 1.0458, lr_0 = 1.0000e-04
Loss = 6.2804e-01, PNorm = 34.0121, GNorm = 4.4982, lr_0 = 1.0000e-04
Validation rmse = 0.602602
Model 0 best validation rmse = 0.601227 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.522037
Ensemble test rmse = 0.522037
Fold 4
Splitting data with seed 4
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.4, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.4, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.4722e+00, PNorm = 31.8372, GNorm = 2.7145, lr_0 = 2.3846e-03
Loss = 9.2209e-01, PNorm = 31.9345, GNorm = 2.7454, lr_0 = 4.2885e-03
Validation rmse = 0.906974
Epoch 1
Loss = 1.4191e+00, PNorm = 32.1842, GNorm = 3.2085, lr_0 = 6.5731e-03
Loss = 1.0079e+00, PNorm = 32.5176, GNorm = 1.1261, lr_0 = 8.4769e-03
Loss = 9.2915e-01, PNorm = 32.9290, GNorm = 0.9886, lr_0 = 9.5669e-03
Validation rmse = 0.674309
Epoch 2
Loss = 7.9234e-01, PNorm = 33.3478, GNorm = 0.7530, lr_0 = 7.3347e-03
Loss = 8.5517e-01, PNorm = 33.5653, GNorm = 1.5053, lr_0 = 5.8780e-03
Validation rmse = 0.635367
Epoch 3
Loss = 6.1950e-01, PNorm = 33.7150, GNorm = 1.3656, lr_0 = 4.5066e-03
Loss = 8.1817e-01, PNorm = 33.8019, GNorm = 0.7955, lr_0 = 3.6115e-03
Loss = 8.4663e-01, PNorm = 33.8592, GNorm = 0.9528, lr_0 = 2.8943e-03
Validation rmse = 0.596417
Epoch 4
Loss = 6.1563e-01, PNorm = 33.8968, GNorm = 0.9082, lr_0 = 2.2190e-03
Loss = 7.1482e-01, PNorm = 33.9184, GNorm = 0.7554, lr_0 = 1.7783e-03
Loss = 7.5691e-01, PNorm = 33.9330, GNorm = 2.0713, lr_0 = 1.4251e-03
Loss = 2.9140e-01, PNorm = 33.9342, GNorm = 2.2538, lr_0 = 1.3634e-03
Validation rmse = 0.589111
Epoch 5
Loss = 7.4893e-01, PNorm = 33.9432, GNorm = 0.7214, lr_0 = 1.0926e-03
Loss = 6.3576e-01, PNorm = 33.9478, GNorm = 1.2838, lr_0 = 8.7560e-04
Validation rmse = 0.635028
Epoch 6
Loss = 5.5614e-01, PNorm = 33.9535, GNorm = 1.8863, lr_0 = 6.7131e-04
Loss = 6.4375e-01, PNorm = 33.9596, GNorm = 0.9760, lr_0 = 5.3798e-04
Loss = 6.9012e-01, PNorm = 33.9622, GNorm = 1.6367, lr_0 = 4.3114e-04
Validation rmse = 0.586105
Epoch 7
Loss = 6.6209e-01, PNorm = 33.9650, GNorm = 2.8406, lr_0 = 3.3055e-04
Loss = 6.6603e-01, PNorm = 33.9665, GNorm = 0.9072, lr_0 = 2.6490e-04
Validation rmse = 0.591316
Epoch 8
Loss = 6.4207e-01, PNorm = 33.9669, GNorm = 0.9651, lr_0 = 2.0309e-04
Loss = 6.7141e-01, PNorm = 33.9671, GNorm = 1.5633, lr_0 = 1.6276e-04
Loss = 6.8590e-01, PNorm = 33.9674, GNorm = 0.9895, lr_0 = 1.3043e-04
Validation rmse = 0.596937
Epoch 9
Loss = 5.9907e-01, PNorm = 33.9680, GNorm = 0.7932, lr_0 = 1.0000e-04
Loss = 6.8718e-01, PNorm = 33.9686, GNorm = 0.8437, lr_0 = 1.0000e-04
Loss = 6.5735e-01, PNorm = 33.9690, GNorm = 0.9009, lr_0 = 1.0000e-04
Loss = 4.3816e-01, PNorm = 33.9690, GNorm = 3.1780, lr_0 = 1.0000e-04
Validation rmse = 0.589665
Model 0 best validation rmse = 0.586105 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.623263
Ensemble test rmse = 0.623263
5-fold cross validation
	Seed 0 ==> test rmse = 0.585480
	Seed 1 ==> test rmse = 0.639619
	Seed 2 ==> test rmse = 0.554740
	Seed 3 ==> test rmse = 0.522037
	Seed 4 ==> test rmse = 0.623263
Overall test rmse = 0.585028 +/- 0.043191
Elapsed time = 0:04:37
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-78fd4af4-b6f3-4e24-bb9a-462dab6ae056.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 64,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 256,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 256,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-78fd4af4-b6f3-4e24-bb9a-462dab6ae056.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 64,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 256,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 256,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.3714e+00, PNorm = 31.8383, GNorm = 2.5052, lr_0 = 2.3846e-03
Loss = 1.0465e+00, PNorm = 31.9358, GNorm = 2.5976, lr_0 = 4.2885e-03
Validation rmse = 0.695128
Epoch 1
Loss = 9.9511e-01, PNorm = 32.1953, GNorm = 2.8095, lr_0 = 6.5731e-03
Loss = 9.5075e-01, PNorm = 32.5458, GNorm = 1.0687, lr_0 = 8.4769e-03
Loss = 8.7324e-01, PNorm = 32.9406, GNorm = 0.9950, lr_0 = 9.8743e-03
Validation rmse = 0.661305
Epoch 2
Loss = 7.3718e-01, PNorm = 33.4057, GNorm = 2.4465, lr_0 = 9.1525e-03
Loss = 9.8085e-01, PNorm = 33.7230, GNorm = 2.5940, lr_0 = 8.5914e-03
Validation rmse = 0.634900
Epoch 3
Loss = 6.6491e-01, PNorm = 34.0309, GNorm = 1.3429, lr_0 = 7.9634e-03
Loss = 8.0213e-01, PNorm = 34.1892, GNorm = 1.8010, lr_0 = 7.4753e-03
Loss = 7.1959e-01, PNorm = 34.3302, GNorm = 0.9201, lr_0 = 7.0170e-03
Validation rmse = 0.580459
Epoch 4
Loss = 7.1493e-01, PNorm = 34.4849, GNorm = 0.9665, lr_0 = 6.5041e-03
Loss = 7.1146e-01, PNorm = 34.5838, GNorm = 1.5228, lr_0 = 6.1054e-03
Loss = 6.5400e-01, PNorm = 34.6748, GNorm = 1.7625, lr_0 = 5.7311e-03
Loss = 7.1673e-01, PNorm = 34.6876, GNorm = 2.0509, lr_0 = 5.6591e-03
Validation rmse = 0.585914
Epoch 5
Loss = 6.1298e-01, PNorm = 34.7547, GNorm = 0.5617, lr_0 = 5.3122e-03
Loss = 6.6301e-01, PNorm = 34.8148, GNorm = 0.7031, lr_0 = 4.9866e-03
Validation rmse = 0.586836
Epoch 6
Loss = 5.9926e-01, PNorm = 34.8759, GNorm = 0.6028, lr_0 = 4.6221e-03
Loss = 6.7633e-01, PNorm = 34.9252, GNorm = 1.0290, lr_0 = 4.3387e-03
Loss = 6.0991e-01, PNorm = 34.9944, GNorm = 0.9333, lr_0 = 4.0728e-03
Validation rmse = 0.564093
Epoch 7
Loss = 6.2385e-01, PNorm = 35.0596, GNorm = 1.2844, lr_0 = 3.7751e-03
Loss = 5.9512e-01, PNorm = 35.1112, GNorm = 0.7610, lr_0 = 3.5436e-03
Validation rmse = 0.588196
Epoch 8
Loss = 6.9884e-01, PNorm = 35.1675, GNorm = 0.9460, lr_0 = 3.2846e-03
Loss = 5.4660e-01, PNorm = 35.2038, GNorm = 0.6202, lr_0 = 3.0833e-03
Loss = 6.2293e-01, PNorm = 35.2482, GNorm = 1.0928, lr_0 = 2.8943e-03
Validation rmse = 0.576818
Epoch 9
Loss = 5.8790e-01, PNorm = 35.2868, GNorm = 1.4162, lr_0 = 2.6827e-03
Loss = 6.2864e-01, PNorm = 35.3211, GNorm = 1.0588, lr_0 = 2.5183e-03
Loss = 5.4060e-01, PNorm = 35.3482, GNorm = 1.0192, lr_0 = 2.3639e-03
Loss = 7.6979e-01, PNorm = 35.3540, GNorm = 2.9084, lr_0 = 2.3342e-03
Validation rmse = 0.574597
Epoch 10
Loss = 5.7723e-01, PNorm = 35.3920, GNorm = 1.8647, lr_0 = 2.1911e-03
Loss = 5.5152e-01, PNorm = 35.4312, GNorm = 2.2049, lr_0 = 2.0568e-03
Validation rmse = 0.571399
Epoch 11
Loss = 6.9007e-01, PNorm = 35.4501, GNorm = 3.2051, lr_0 = 1.9064e-03
Loss = 5.9484e-01, PNorm = 35.4759, GNorm = 0.6742, lr_0 = 1.7896e-03
Loss = 5.8176e-01, PNorm = 35.4992, GNorm = 1.4257, lr_0 = 1.6799e-03
Validation rmse = 0.566548
Epoch 12
Loss = 5.6274e-01, PNorm = 35.5279, GNorm = 1.1290, lr_0 = 1.5571e-03
Loss = 5.2950e-01, PNorm = 35.5515, GNorm = 0.8717, lr_0 = 1.4616e-03
Loss = 6.2668e-01, PNorm = 35.5668, GNorm = 8.6383, lr_0 = 1.3720e-03
Validation rmse = 0.581932
Epoch 13
Loss = 5.7957e-01, PNorm = 35.5754, GNorm = 0.8482, lr_0 = 1.2879e-03
Loss = 5.1401e-01, PNorm = 35.5910, GNorm = 0.8942, lr_0 = 1.2090e-03
Validation rmse = 0.547232
Epoch 14
Loss = 5.6357e-01, PNorm = 35.6100, GNorm = 0.9868, lr_0 = 1.1206e-03
Loss = 5.1621e-01, PNorm = 35.6249, GNorm = 0.9353, lr_0 = 1.0519e-03
Loss = 5.6034e-01, PNorm = 35.6365, GNorm = 0.7876, lr_0 = 9.8743e-04
Validation rmse = 0.561619
Epoch 15
Loss = 4.7577e-01, PNorm = 35.6538, GNorm = 0.7678, lr_0 = 9.1525e-04
Loss = 5.6289e-01, PNorm = 35.6644, GNorm = 1.6095, lr_0 = 8.5914e-04
Validation rmse = 0.570060
Epoch 16
Loss = 4.3750e-01, PNorm = 35.6732, GNorm = 1.0767, lr_0 = 7.9634e-04
Loss = 5.7611e-01, PNorm = 35.6818, GNorm = 0.6805, lr_0 = 7.4753e-04
Loss = 4.8086e-01, PNorm = 35.6900, GNorm = 0.8711, lr_0 = 7.0170e-04
Validation rmse = 0.570691
Epoch 17
Loss = 4.2304e-01, PNorm = 35.6968, GNorm = 0.8083, lr_0 = 6.5041e-04
Loss = 4.9446e-01, PNorm = 35.7027, GNorm = 1.1950, lr_0 = 6.1054e-04
Loss = 5.3275e-01, PNorm = 35.7097, GNorm = 1.1626, lr_0 = 5.7311e-04
Loss = 1.1737e+00, PNorm = 35.7109, GNorm = 2.5641, lr_0 = 5.6591e-04
Validation rmse = 0.566491
Epoch 18
Loss = 4.3100e-01, PNorm = 35.7163, GNorm = 0.7385, lr_0 = 5.3122e-04
Loss = 5.7359e-01, PNorm = 35.7216, GNorm = 0.8737, lr_0 = 4.9866e-04
Validation rmse = 0.568175
Epoch 19
Loss = 5.1363e-01, PNorm = 35.7284, GNorm = 1.3212, lr_0 = 4.6221e-04
Loss = 4.0193e-01, PNorm = 35.7332, GNorm = 1.5973, lr_0 = 4.3387e-04
Loss = 5.5714e-01, PNorm = 35.7379, GNorm = 1.0707, lr_0 = 4.0728e-04
Validation rmse = 0.567129
Epoch 20
Loss = 4.8022e-01, PNorm = 35.7430, GNorm = 2.3875, lr_0 = 3.7751e-04
Loss = 4.6931e-01, PNorm = 35.7467, GNorm = 1.0471, lr_0 = 3.5436e-04
Validation rmse = 0.561784
Epoch 21
Loss = 4.2716e-01, PNorm = 35.7515, GNorm = 0.7625, lr_0 = 3.2846e-04
Loss = 4.8486e-01, PNorm = 35.7546, GNorm = 1.4195, lr_0 = 3.0833e-04
Loss = 4.8150e-01, PNorm = 35.7576, GNorm = 0.8535, lr_0 = 2.8943e-04
Validation rmse = 0.563099
Epoch 22
Loss = 4.9121e-01, PNorm = 35.7606, GNorm = 2.1702, lr_0 = 2.6827e-04
Loss = 4.8921e-01, PNorm = 35.7632, GNorm = 1.4339, lr_0 = 2.5183e-04
Loss = 4.5850e-01, PNorm = 35.7655, GNorm = 0.6097, lr_0 = 2.3639e-04
Loss = 3.0418e-01, PNorm = 35.7662, GNorm = 2.4996, lr_0 = 2.3342e-04
Validation rmse = 0.559364
Epoch 23
Loss = 5.3241e-01, PNorm = 35.7692, GNorm = 0.6722, lr_0 = 2.1911e-04
Loss = 4.6165e-01, PNorm = 35.7711, GNorm = 0.8274, lr_0 = 2.0568e-04
Validation rmse = 0.563310
Epoch 24
Loss = 5.1472e-01, PNorm = 35.7735, GNorm = 0.8320, lr_0 = 1.9064e-04
Loss = 4.8385e-01, PNorm = 35.7754, GNorm = 1.3536, lr_0 = 1.7896e-04
Loss = 4.0622e-01, PNorm = 35.7768, GNorm = 0.6399, lr_0 = 1.6799e-04
Validation rmse = 0.564345
Epoch 25
Loss = 4.8959e-01, PNorm = 35.7790, GNorm = 0.7275, lr_0 = 1.5571e-04
Loss = 4.4864e-01, PNorm = 35.7807, GNorm = 0.9164, lr_0 = 1.4616e-04
Loss = 4.2351e-01, PNorm = 35.7821, GNorm = 1.4827, lr_0 = 1.3720e-04
Validation rmse = 0.563518
Epoch 26
Loss = 4.5628e-01, PNorm = 35.7837, GNorm = 1.1883, lr_0 = 1.2879e-04
Loss = 4.4967e-01, PNorm = 35.7850, GNorm = 0.6057, lr_0 = 1.2090e-04
Validation rmse = 0.560881
Epoch 27
Loss = 4.1688e-01, PNorm = 35.7865, GNorm = 0.9914, lr_0 = 1.1206e-04
Loss = 5.0545e-01, PNorm = 35.7878, GNorm = 1.7600, lr_0 = 1.0519e-04
Loss = 4.4084e-01, PNorm = 35.7890, GNorm = 0.7639, lr_0 = 1.0000e-04
Validation rmse = 0.560181
Epoch 28
Loss = 4.4048e-01, PNorm = 35.7900, GNorm = 0.9482, lr_0 = 1.0000e-04
Loss = 4.8134e-01, PNorm = 35.7908, GNorm = 0.9011, lr_0 = 1.0000e-04
Validation rmse = 0.557895
Epoch 29
Loss = 4.4319e-01, PNorm = 35.7920, GNorm = 0.8057, lr_0 = 1.0000e-04
Loss = 4.7904e-01, PNorm = 35.7930, GNorm = 1.8551, lr_0 = 1.0000e-04
Loss = 4.4551e-01, PNorm = 35.7939, GNorm = 1.0140, lr_0 = 1.0000e-04
Validation rmse = 0.560368
Model 0 best validation rmse = 0.547232 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.532458
Ensemble test rmse = 0.532458
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.1585e+00, PNorm = 31.8372, GNorm = 2.4589, lr_0 = 2.3846e-03
Loss = 1.1881e+00, PNorm = 31.9365, GNorm = 1.3925, lr_0 = 4.2885e-03
Validation rmse = 0.746332
Epoch 1
Loss = 9.9544e-01, PNorm = 32.2400, GNorm = 2.0573, lr_0 = 6.5731e-03
Loss = 1.0247e+00, PNorm = 32.6075, GNorm = 0.7575, lr_0 = 8.4769e-03
Loss = 8.5236e-01, PNorm = 33.0743, GNorm = 1.5029, lr_0 = 9.8743e-03
Validation rmse = 0.860720
Epoch 2
Loss = 1.1984e+00, PNorm = 33.5390, GNorm = 2.0761, lr_0 = 9.1525e-03
Loss = 1.0150e+00, PNorm = 33.8550, GNorm = 0.4908, lr_0 = 8.5914e-03
Validation rmse = 0.666307
Epoch 3
Loss = 8.6536e-01, PNorm = 34.1413, GNorm = 0.2990, lr_0 = 7.9634e-03
Loss = 9.7572e-01, PNorm = 34.3182, GNorm = 1.3901, lr_0 = 7.4753e-03
Loss = 8.9409e-01, PNorm = 34.4673, GNorm = 0.3007, lr_0 = 7.0170e-03
Validation rmse = 0.639482
Epoch 4
Loss = 8.6216e-01, PNorm = 34.5969, GNorm = 0.7450, lr_0 = 6.5041e-03
Loss = 8.5185e-01, PNorm = 34.7107, GNorm = 0.5507, lr_0 = 6.1054e-03
Loss = 7.3605e-01, PNorm = 34.8101, GNorm = 1.1979, lr_0 = 5.7311e-03
Loss = 8.1092e-01, PNorm = 34.8250, GNorm = 1.5434, lr_0 = 5.6591e-03
Validation rmse = 0.561945
Epoch 5
Loss = 6.9614e-01, PNorm = 34.9026, GNorm = 0.6028, lr_0 = 5.3122e-03
Loss = 6.9884e-01, PNorm = 34.9755, GNorm = 0.5081, lr_0 = 4.9866e-03
Validation rmse = 0.553777
Epoch 6
Loss = 7.4170e-01, PNorm = 35.0181, GNorm = 1.1167, lr_0 = 4.6221e-03
Loss = 7.4904e-01, PNorm = 35.0713, GNorm = 0.7265, lr_0 = 4.3387e-03
Loss = 8.0634e-01, PNorm = 35.1299, GNorm = 0.9117, lr_0 = 4.0728e-03
Validation rmse = 0.610656
Epoch 7
Loss = 7.3794e-01, PNorm = 35.1864, GNorm = 1.2093, lr_0 = 3.7751e-03
Loss = 6.3507e-01, PNorm = 35.2191, GNorm = 0.7780, lr_0 = 3.5436e-03
Validation rmse = 0.538753
Epoch 8
Loss = 5.8319e-01, PNorm = 35.2703, GNorm = 0.6479, lr_0 = 3.2846e-03
Loss = 7.0927e-01, PNorm = 35.3126, GNorm = 0.6245, lr_0 = 3.0833e-03
Loss = 6.7966e-01, PNorm = 35.3348, GNorm = 0.6141, lr_0 = 2.8943e-03
Validation rmse = 0.544417
Epoch 9
Loss = 6.5621e-01, PNorm = 35.3625, GNorm = 0.4155, lr_0 = 2.6827e-03
Loss = 6.4971e-01, PNorm = 35.3881, GNorm = 0.7502, lr_0 = 2.5183e-03
Loss = 6.8794e-01, PNorm = 35.4150, GNorm = 1.1314, lr_0 = 2.3639e-03
Loss = 2.1802e-01, PNorm = 35.4206, GNorm = 1.1579, lr_0 = 2.3342e-03
Validation rmse = 0.537450
Epoch 10
Loss = 6.7414e-01, PNorm = 35.4434, GNorm = 0.4818, lr_0 = 2.1911e-03
Loss = 5.9116e-01, PNorm = 35.4571, GNorm = 0.5666, lr_0 = 2.0568e-03
Validation rmse = 0.526284
Epoch 11
Loss = 5.5701e-01, PNorm = 35.4828, GNorm = 0.5961, lr_0 = 1.9064e-03
Loss = 6.4084e-01, PNorm = 35.5000, GNorm = 1.1707, lr_0 = 1.7896e-03
Loss = 6.0904e-01, PNorm = 35.5122, GNorm = 0.6681, lr_0 = 1.6799e-03
Validation rmse = 0.524220
Epoch 12
Loss = 5.6909e-01, PNorm = 35.5301, GNorm = 0.8588, lr_0 = 1.5571e-03
Loss = 6.1745e-01, PNorm = 35.5477, GNorm = 0.5517, lr_0 = 1.4616e-03
Loss = 5.8306e-01, PNorm = 35.5635, GNorm = 3.1100, lr_0 = 1.3720e-03
Validation rmse = 0.518625
Epoch 13
Loss = 6.4563e-01, PNorm = 35.5832, GNorm = 1.0809, lr_0 = 1.2879e-03
Loss = 5.4228e-01, PNorm = 35.6029, GNorm = 0.7280, lr_0 = 1.2090e-03
Validation rmse = 0.518564
Epoch 14
Loss = 6.3588e-01, PNorm = 35.6104, GNorm = 1.3360, lr_0 = 1.1206e-03
Loss = 5.9858e-01, PNorm = 35.6164, GNorm = 2.0836, lr_0 = 1.0519e-03
Loss = 6.4720e-01, PNorm = 35.6277, GNorm = 0.7287, lr_0 = 9.8743e-04
Validation rmse = 0.540226
Epoch 15
Loss = 5.5291e-01, PNorm = 35.6377, GNorm = 1.2337, lr_0 = 9.1525e-04
Loss = 5.8307e-01, PNorm = 35.6441, GNorm = 1.1121, lr_0 = 8.5914e-04
Validation rmse = 0.519111
Epoch 16
Loss = 4.3752e-01, PNorm = 35.6525, GNorm = 0.8296, lr_0 = 7.9634e-04
Loss = 6.5672e-01, PNorm = 35.6581, GNorm = 1.2031, lr_0 = 7.4753e-04
Loss = 5.1000e-01, PNorm = 35.6648, GNorm = 0.8656, lr_0 = 7.0170e-04
Validation rmse = 0.519220
Epoch 17
Loss = 6.2614e-01, PNorm = 35.6713, GNorm = 0.9630, lr_0 = 6.5041e-04
Loss = 5.1049e-01, PNorm = 35.6772, GNorm = 1.3107, lr_0 = 6.1054e-04
Loss = 5.6365e-01, PNorm = 35.6833, GNorm = 0.8153, lr_0 = 5.7311e-04
Loss = 6.4229e-01, PNorm = 35.6844, GNorm = 1.9104, lr_0 = 5.6591e-04
Validation rmse = 0.516363
Epoch 18
Loss = 5.0088e-01, PNorm = 35.6901, GNorm = 0.6111, lr_0 = 5.3122e-04
Loss = 5.9091e-01, PNorm = 35.6959, GNorm = 1.2679, lr_0 = 4.9866e-04
Validation rmse = 0.515984
Epoch 19
Loss = 6.2621e-01, PNorm = 35.7032, GNorm = 1.3194, lr_0 = 4.6221e-04
Loss = 5.7806e-01, PNorm = 35.7076, GNorm = 1.7369, lr_0 = 4.3387e-04
Loss = 5.7433e-01, PNorm = 35.7105, GNorm = 1.8159, lr_0 = 4.0728e-04
Validation rmse = 0.515703
Epoch 20
Loss = 5.5378e-01, PNorm = 35.7126, GNorm = 0.6427, lr_0 = 3.7751e-04
Loss = 6.3005e-01, PNorm = 35.7152, GNorm = 0.7985, lr_0 = 3.5436e-04
Validation rmse = 0.516953
Epoch 21
Loss = 4.6243e-01, PNorm = 35.7191, GNorm = 0.5429, lr_0 = 3.2846e-04
Loss = 4.8947e-01, PNorm = 35.7218, GNorm = 0.6320, lr_0 = 3.0833e-04
Loss = 5.8019e-01, PNorm = 35.7244, GNorm = 1.1695, lr_0 = 2.8943e-04
Validation rmse = 0.516262
Epoch 22
Loss = 5.2926e-01, PNorm = 35.7282, GNorm = 0.7099, lr_0 = 2.6827e-04
Loss = 6.0320e-01, PNorm = 35.7313, GNorm = 1.0914, lr_0 = 2.5183e-04
Loss = 5.1309e-01, PNorm = 35.7332, GNorm = 0.8545, lr_0 = 2.3639e-04
Loss = 7.3727e-01, PNorm = 35.7336, GNorm = 1.8260, lr_0 = 2.3342e-04
Validation rmse = 0.515791
Epoch 23
Loss = 5.5886e-01, PNorm = 35.7349, GNorm = 1.2766, lr_0 = 2.1911e-04
Loss = 5.6099e-01, PNorm = 35.7364, GNorm = 0.8937, lr_0 = 2.0568e-04
Validation rmse = 0.516043
Epoch 24
Loss = 5.6899e-01, PNorm = 35.7380, GNorm = 0.5467, lr_0 = 1.9064e-04
Loss = 5.3974e-01, PNorm = 35.7394, GNorm = 0.7761, lr_0 = 1.7896e-04
Loss = 4.9639e-01, PNorm = 35.7408, GNorm = 1.1635, lr_0 = 1.6799e-04
Validation rmse = 0.517046
Epoch 25
Loss = 4.8960e-01, PNorm = 35.7425, GNorm = 1.5361, lr_0 = 1.5571e-04
Loss = 5.5984e-01, PNorm = 35.7436, GNorm = 1.0373, lr_0 = 1.4616e-04
Loss = 5.7360e-01, PNorm = 35.7444, GNorm = 4.1299, lr_0 = 1.3720e-04
Validation rmse = 0.518108
Epoch 26
Loss = 5.6331e-01, PNorm = 35.7450, GNorm = 1.4703, lr_0 = 1.2879e-04
Loss = 5.3206e-01, PNorm = 35.7459, GNorm = 1.1990, lr_0 = 1.2090e-04
Validation rmse = 0.516391
Epoch 27
Loss = 5.4467e-01, PNorm = 35.7470, GNorm = 0.6688, lr_0 = 1.1206e-04
Loss = 5.0779e-01, PNorm = 35.7477, GNorm = 1.3426, lr_0 = 1.0519e-04
Loss = 5.6397e-01, PNorm = 35.7482, GNorm = 0.5723, lr_0 = 1.0000e-04
Validation rmse = 0.516139
Epoch 28
Loss = 5.8657e-01, PNorm = 35.7489, GNorm = 1.0502, lr_0 = 1.0000e-04
Loss = 4.9088e-01, PNorm = 35.7497, GNorm = 0.8425, lr_0 = 1.0000e-04
Validation rmse = 0.516688
Epoch 29
Loss = 5.7163e-01, PNorm = 35.7507, GNorm = 1.4614, lr_0 = 1.0000e-04
Loss = 5.6484e-01, PNorm = 35.7514, GNorm = 0.8667, lr_0 = 1.0000e-04
Loss = 4.9956e-01, PNorm = 35.7522, GNorm = 1.4137, lr_0 = 1.0000e-04
Validation rmse = 0.516776
Model 0 best validation rmse = 0.515703 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.601372
Ensemble test rmse = 0.601372
2-fold cross validation
	Seed 0 ==> test rmse = 0.532458
	Seed 1 ==> test rmse = 0.601372
Overall test rmse = 0.566915 +/- 0.034457
Elapsed time = 0:05:17
Command line
python /usr/local/lib/python3.10/dist-packages/colab_kernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-f5079352-4646-4998-be0a-58b60af46dc8.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 64,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/drive/MyDrive/BBB dataset/df.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 256,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 256,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 5,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.01,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/drive/MyDrive/BBB dataset/test_checkpoints_reg',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logBB'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.3714e+00, PNorm = 31.8383, GNorm = 2.5052, lr_0 = 2.3846e-03
Loss = 1.0465e+00, PNorm = 31.9358, GNorm = 2.5976, lr_0 = 4.2885e-03
Validation rmse = 0.695128
Epoch 1
Loss = 9.9511e-01, PNorm = 32.1953, GNorm = 2.8095, lr_0 = 6.5731e-03
Loss = 9.5075e-01, PNorm = 32.5458, GNorm = 1.0687, lr_0 = 8.4769e-03
Loss = 8.7324e-01, PNorm = 32.9406, GNorm = 0.9950, lr_0 = 9.8743e-03
Validation rmse = 0.661305
Epoch 2
Loss = 7.3718e-01, PNorm = 33.4057, GNorm = 2.4465, lr_0 = 9.1525e-03
Loss = 9.8085e-01, PNorm = 33.7230, GNorm = 2.5940, lr_0 = 8.5914e-03
Validation rmse = 0.634900
Epoch 3
Loss = 6.6491e-01, PNorm = 34.0309, GNorm = 1.3429, lr_0 = 7.9634e-03
Loss = 8.0213e-01, PNorm = 34.1892, GNorm = 1.8010, lr_0 = 7.4753e-03
Loss = 7.1959e-01, PNorm = 34.3302, GNorm = 0.9201, lr_0 = 7.0170e-03
Validation rmse = 0.580459
Epoch 4
Loss = 7.1493e-01, PNorm = 34.4849, GNorm = 0.9665, lr_0 = 6.5041e-03
Loss = 7.1146e-01, PNorm = 34.5838, GNorm = 1.5228, lr_0 = 6.1054e-03
Loss = 6.5400e-01, PNorm = 34.6748, GNorm = 1.7625, lr_0 = 5.7311e-03
Loss = 7.1673e-01, PNorm = 34.6876, GNorm = 2.0509, lr_0 = 5.6591e-03
Validation rmse = 0.585914
Epoch 5
Loss = 6.1298e-01, PNorm = 34.7547, GNorm = 0.5617, lr_0 = 5.3122e-03
Loss = 6.6301e-01, PNorm = 34.8148, GNorm = 0.7031, lr_0 = 4.9866e-03
Validation rmse = 0.586836
Epoch 6
Loss = 5.9926e-01, PNorm = 34.8759, GNorm = 0.6028, lr_0 = 4.6221e-03
Loss = 6.7633e-01, PNorm = 34.9252, GNorm = 1.0290, lr_0 = 4.3387e-03
Loss = 6.0991e-01, PNorm = 34.9944, GNorm = 0.9333, lr_0 = 4.0728e-03
Validation rmse = 0.564093
Epoch 7
Loss = 6.2385e-01, PNorm = 35.0596, GNorm = 1.2844, lr_0 = 3.7751e-03
Loss = 5.9512e-01, PNorm = 35.1112, GNorm = 0.7610, lr_0 = 3.5436e-03
Validation rmse = 0.588196
Epoch 8
Loss = 6.9884e-01, PNorm = 35.1675, GNorm = 0.9460, lr_0 = 3.2846e-03
Loss = 5.4660e-01, PNorm = 35.2038, GNorm = 0.6202, lr_0 = 3.0833e-03
Loss = 6.2293e-01, PNorm = 35.2482, GNorm = 1.0928, lr_0 = 2.8943e-03
Validation rmse = 0.576818
Epoch 9
Loss = 5.8790e-01, PNorm = 35.2868, GNorm = 1.4162, lr_0 = 2.6827e-03
Loss = 6.2864e-01, PNorm = 35.3211, GNorm = 1.0588, lr_0 = 2.5183e-03
Loss = 5.4060e-01, PNorm = 35.3482, GNorm = 1.0192, lr_0 = 2.3639e-03
Loss = 7.6979e-01, PNorm = 35.3540, GNorm = 2.9084, lr_0 = 2.3342e-03
Validation rmse = 0.574597
Epoch 10
Loss = 5.7723e-01, PNorm = 35.3920, GNorm = 1.8647, lr_0 = 2.1911e-03
Loss = 5.5152e-01, PNorm = 35.4312, GNorm = 2.2049, lr_0 = 2.0568e-03
Validation rmse = 0.571399
Epoch 11
Loss = 6.9007e-01, PNorm = 35.4501, GNorm = 3.2051, lr_0 = 1.9064e-03
Loss = 5.9484e-01, PNorm = 35.4759, GNorm = 0.6742, lr_0 = 1.7896e-03
Loss = 5.8176e-01, PNorm = 35.4992, GNorm = 1.4257, lr_0 = 1.6799e-03
Validation rmse = 0.566548
Epoch 12
Loss = 5.6274e-01, PNorm = 35.5279, GNorm = 1.1290, lr_0 = 1.5571e-03
Loss = 5.2950e-01, PNorm = 35.5515, GNorm = 0.8717, lr_0 = 1.4616e-03
Loss = 6.2668e-01, PNorm = 35.5668, GNorm = 8.6383, lr_0 = 1.3720e-03
Validation rmse = 0.581932
Epoch 13
Loss = 5.7957e-01, PNorm = 35.5754, GNorm = 0.8482, lr_0 = 1.2879e-03
Loss = 5.1401e-01, PNorm = 35.5910, GNorm = 0.8942, lr_0 = 1.2090e-03
Validation rmse = 0.547232
Epoch 14
Loss = 5.6357e-01, PNorm = 35.6100, GNorm = 0.9868, lr_0 = 1.1206e-03
Loss = 5.1621e-01, PNorm = 35.6249, GNorm = 0.9353, lr_0 = 1.0519e-03
Loss = 5.6034e-01, PNorm = 35.6365, GNorm = 0.7876, lr_0 = 9.8743e-04
Validation rmse = 0.561619
Epoch 15
Loss = 4.7577e-01, PNorm = 35.6538, GNorm = 0.7678, lr_0 = 9.1525e-04
Loss = 5.6289e-01, PNorm = 35.6644, GNorm = 1.6095, lr_0 = 8.5914e-04
Validation rmse = 0.570060
Epoch 16
Loss = 4.3750e-01, PNorm = 35.6732, GNorm = 1.0767, lr_0 = 7.9634e-04
Loss = 5.7611e-01, PNorm = 35.6818, GNorm = 0.6805, lr_0 = 7.4753e-04
Loss = 4.8086e-01, PNorm = 35.6900, GNorm = 0.8711, lr_0 = 7.0170e-04
Validation rmse = 0.570691
Epoch 17
Loss = 4.2304e-01, PNorm = 35.6968, GNorm = 0.8083, lr_0 = 6.5041e-04
Loss = 4.9446e-01, PNorm = 35.7027, GNorm = 1.1950, lr_0 = 6.1054e-04
Loss = 5.3275e-01, PNorm = 35.7097, GNorm = 1.1626, lr_0 = 5.7311e-04
Loss = 1.1737e+00, PNorm = 35.7109, GNorm = 2.5641, lr_0 = 5.6591e-04
Validation rmse = 0.566491
Epoch 18
Loss = 4.3100e-01, PNorm = 35.7163, GNorm = 0.7385, lr_0 = 5.3122e-04
Loss = 5.7359e-01, PNorm = 35.7216, GNorm = 0.8737, lr_0 = 4.9866e-04
Validation rmse = 0.568175
Epoch 19
Loss = 5.1363e-01, PNorm = 35.7284, GNorm = 1.3212, lr_0 = 4.6221e-04
Loss = 4.0193e-01, PNorm = 35.7332, GNorm = 1.5973, lr_0 = 4.3387e-04
Loss = 5.5714e-01, PNorm = 35.7379, GNorm = 1.0707, lr_0 = 4.0728e-04
Validation rmse = 0.567129
Epoch 20
Loss = 4.8022e-01, PNorm = 35.7430, GNorm = 2.3875, lr_0 = 3.7751e-04
Loss = 4.6931e-01, PNorm = 35.7467, GNorm = 1.0471, lr_0 = 3.5436e-04
Validation rmse = 0.561784
Epoch 21
Loss = 4.2716e-01, PNorm = 35.7515, GNorm = 0.7625, lr_0 = 3.2846e-04
Loss = 4.8486e-01, PNorm = 35.7546, GNorm = 1.4195, lr_0 = 3.0833e-04
Loss = 4.8150e-01, PNorm = 35.7576, GNorm = 0.8535, lr_0 = 2.8943e-04
Validation rmse = 0.563099
Epoch 22
Loss = 4.9121e-01, PNorm = 35.7606, GNorm = 2.1702, lr_0 = 2.6827e-04
Loss = 4.8921e-01, PNorm = 35.7632, GNorm = 1.4339, lr_0 = 2.5183e-04
Loss = 4.5850e-01, PNorm = 35.7655, GNorm = 0.6097, lr_0 = 2.3639e-04
Loss = 3.0418e-01, PNorm = 35.7662, GNorm = 2.4996, lr_0 = 2.3342e-04
Validation rmse = 0.559364
Epoch 23
Loss = 5.3241e-01, PNorm = 35.7692, GNorm = 0.6722, lr_0 = 2.1911e-04
Loss = 4.6165e-01, PNorm = 35.7711, GNorm = 0.8274, lr_0 = 2.0568e-04
Validation rmse = 0.563310
Epoch 24
Loss = 5.1472e-01, PNorm = 35.7735, GNorm = 0.8320, lr_0 = 1.9064e-04
Loss = 4.8385e-01, PNorm = 35.7754, GNorm = 1.3536, lr_0 = 1.7896e-04
Loss = 4.0622e-01, PNorm = 35.7768, GNorm = 0.6399, lr_0 = 1.6799e-04
Validation rmse = 0.564345
Epoch 25
Loss = 4.8959e-01, PNorm = 35.7790, GNorm = 0.7275, lr_0 = 1.5571e-04
Loss = 4.4864e-01, PNorm = 35.7807, GNorm = 0.9164, lr_0 = 1.4616e-04
Loss = 4.2351e-01, PNorm = 35.7821, GNorm = 1.4827, lr_0 = 1.3720e-04
Validation rmse = 0.563518
Epoch 26
Loss = 4.5628e-01, PNorm = 35.7837, GNorm = 1.1883, lr_0 = 1.2879e-04
Loss = 4.4967e-01, PNorm = 35.7850, GNorm = 0.6057, lr_0 = 1.2090e-04
Validation rmse = 0.560881
Epoch 27
Loss = 4.1688e-01, PNorm = 35.7865, GNorm = 0.9914, lr_0 = 1.1206e-04
Loss = 5.0545e-01, PNorm = 35.7878, GNorm = 1.7600, lr_0 = 1.0519e-04
Loss = 4.4084e-01, PNorm = 35.7890, GNorm = 0.7639, lr_0 = 1.0000e-04
Validation rmse = 0.560181
Epoch 28
Loss = 4.4048e-01, PNorm = 35.7900, GNorm = 0.9482, lr_0 = 1.0000e-04
Loss = 4.8134e-01, PNorm = 35.7908, GNorm = 0.9011, lr_0 = 1.0000e-04
Validation rmse = 0.557895
Epoch 29
Loss = 4.4319e-01, PNorm = 35.7920, GNorm = 0.8057, lr_0 = 1.0000e-04
Loss = 4.7904e-01, PNorm = 35.7930, GNorm = 1.8551, lr_0 = 1.0000e-04
Loss = 4.4551e-01, PNorm = 35.7939, GNorm = 1.0140, lr_0 = 1.0000e-04
Validation rmse = 0.560368
Model 0 best validation rmse = 0.547232 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.532458
Ensemble test rmse = 0.532458
Fold 1
Splitting data with seed 1
Total size = 1,047 | train size = 837 | val size = 105 | test size = 105
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=256, bias=False)
        (W_h): Linear(in_features=256, out_features=256, bias=False)
        (W_o): Linear(in_features=389, out_features=256, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=256, out_features=256, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Number of parameters = 269,313
Epoch 0
Loss = 1.1585e+00, PNorm = 31.8372, GNorm = 2.4589, lr_0 = 2.3846e-03
Loss = 1.1881e+00, PNorm = 31.9365, GNorm = 1.3925, lr_0 = 4.2885e-03
Validation rmse = 0.746332
Epoch 1
Loss = 9.9544e-01, PNorm = 32.2400, GNorm = 2.0573, lr_0 = 6.5731e-03
Loss = 1.0247e+00, PNorm = 32.6075, GNorm = 0.7575, lr_0 = 8.4769e-03
Loss = 8.5236e-01, PNorm = 33.0743, GNorm = 1.5029, lr_0 = 9.8743e-03
Validation rmse = 0.860720
Epoch 2
Loss = 1.1984e+00, PNorm = 33.5390, GNorm = 2.0761, lr_0 = 9.1525e-03
Loss = 1.0150e+00, PNorm = 33.8550, GNorm = 0.4908, lr_0 = 8.5914e-03
Validation rmse = 0.666307
Epoch 3
Loss = 8.6536e-01, PNorm = 34.1413, GNorm = 0.2990, lr_0 = 7.9634e-03
Loss = 9.7572e-01, PNorm = 34.3182, GNorm = 1.3901, lr_0 = 7.4753e-03
Loss = 8.9409e-01, PNorm = 34.4673, GNorm = 0.3007, lr_0 = 7.0170e-03
Validation rmse = 0.639482
Epoch 4
Loss = 8.6216e-01, PNorm = 34.5969, GNorm = 0.7450, lr_0 = 6.5041e-03
Loss = 8.5185e-01, PNorm = 34.7107, GNorm = 0.5507, lr_0 = 6.1054e-03
Loss = 7.3605e-01, PNorm = 34.8101, GNorm = 1.1979, lr_0 = 5.7311e-03
Loss = 8.1092e-01, PNorm = 34.8250, GNorm = 1.5434, lr_0 = 5.6591e-03
Validation rmse = 0.561945
Epoch 5
Loss = 6.9614e-01, PNorm = 34.9026, GNorm = 0.6028, lr_0 = 5.3122e-03
Loss = 6.9884e-01, PNorm = 34.9755, GNorm = 0.5081, lr_0 = 4.9866e-03
Validation rmse = 0.553777
Epoch 6
Loss = 7.4170e-01, PNorm = 35.0181, GNorm = 1.1167, lr_0 = 4.6221e-03
Loss = 7.4904e-01, PNorm = 35.0713, GNorm = 0.7265, lr_0 = 4.3387e-03
Loss = 8.0634e-01, PNorm = 35.1299, GNorm = 0.9117, lr_0 = 4.0728e-03
Validation rmse = 0.610656
Epoch 7
Loss = 7.3794e-01, PNorm = 35.1864, GNorm = 1.2093, lr_0 = 3.7751e-03
Loss = 6.3507e-01, PNorm = 35.2191, GNorm = 0.7780, lr_0 = 3.5436e-03
Validation rmse = 0.538753
Epoch 8
Loss = 5.8319e-01, PNorm = 35.2703, GNorm = 0.6479, lr_0 = 3.2846e-03
Loss = 7.0927e-01, PNorm = 35.3126, GNorm = 0.6245, lr_0 = 3.0833e-03
Loss = 6.7966e-01, PNorm = 35.3348, GNorm = 0.6141, lr_0 = 2.8943e-03
Validation rmse = 0.544417
Epoch 9
Loss = 6.5621e-01, PNorm = 35.3625, GNorm = 0.4155, lr_0 = 2.6827e-03
Loss = 6.4971e-01, PNorm = 35.3881, GNorm = 0.7502, lr_0 = 2.5183e-03
Loss = 6.8794e-01, PNorm = 35.4150, GNorm = 1.1314, lr_0 = 2.3639e-03
Loss = 2.1802e-01, PNorm = 35.4206, GNorm = 1.1579, lr_0 = 2.3342e-03
Validation rmse = 0.537450
Epoch 10
Loss = 6.7414e-01, PNorm = 35.4434, GNorm = 0.4818, lr_0 = 2.1911e-03
Loss = 5.9116e-01, PNorm = 35.4571, GNorm = 0.5666, lr_0 = 2.0568e-03
Validation rmse = 0.526284
Epoch 11
Loss = 5.5701e-01, PNorm = 35.4828, GNorm = 0.5961, lr_0 = 1.9064e-03
Loss = 6.4084e-01, PNorm = 35.5000, GNorm = 1.1707, lr_0 = 1.7896e-03
Loss = 6.0904e-01, PNorm = 35.5122, GNorm = 0.6681, lr_0 = 1.6799e-03
Validation rmse = 0.524220
Epoch 12
Loss = 5.6909e-01, PNorm = 35.5301, GNorm = 0.8588, lr_0 = 1.5571e-03
Loss = 6.1745e-01, PNorm = 35.5477, GNorm = 0.5517, lr_0 = 1.4616e-03
Loss = 5.8306e-01, PNorm = 35.5635, GNorm = 3.1100, lr_0 = 1.3720e-03
Validation rmse = 0.518625
Epoch 13
Loss = 6.4563e-01, PNorm = 35.5832, GNorm = 1.0809, lr_0 = 1.2879e-03
Loss = 5.4228e-01, PNorm = 35.6029, GNorm = 0.7280, lr_0 = 1.2090e-03
Validation rmse = 0.518564
Epoch 14
Loss = 6.3588e-01, PNorm = 35.6104, GNorm = 1.3360, lr_0 = 1.1206e-03
Loss = 5.9858e-01, PNorm = 35.6164, GNorm = 2.0836, lr_0 = 1.0519e-03
Loss = 6.4720e-01, PNorm = 35.6277, GNorm = 0.7287, lr_0 = 9.8743e-04
Validation rmse = 0.540226
Epoch 15
Loss = 5.5291e-01, PNorm = 35.6377, GNorm = 1.2337, lr_0 = 9.1525e-04
Loss = 5.8307e-01, PNorm = 35.6441, GNorm = 1.1121, lr_0 = 8.5914e-04
Validation rmse = 0.519111
Epoch 16
Loss = 4.3752e-01, PNorm = 35.6525, GNorm = 0.8296, lr_0 = 7.9634e-04
Loss = 6.5672e-01, PNorm = 35.6581, GNorm = 1.2031, lr_0 = 7.4753e-04
Loss = 5.1000e-01, PNorm = 35.6648, GNorm = 0.8656, lr_0 = 7.0170e-04
Validation rmse = 0.519220
Epoch 17
Loss = 6.2614e-01, PNorm = 35.6713, GNorm = 0.9630, lr_0 = 6.5041e-04
Loss = 5.1049e-01, PNorm = 35.6772, GNorm = 1.3107, lr_0 = 6.1054e-04
Loss = 5.6365e-01, PNorm = 35.6833, GNorm = 0.8153, lr_0 = 5.7311e-04
Loss = 6.4229e-01, PNorm = 35.6844, GNorm = 1.9104, lr_0 = 5.6591e-04
Validation rmse = 0.516363
Epoch 18
Loss = 5.0088e-01, PNorm = 35.6901, GNorm = 0.6111, lr_0 = 5.3122e-04
Loss = 5.9091e-01, PNorm = 35.6959, GNorm = 1.2679, lr_0 = 4.9866e-04
Validation rmse = 0.515984
Epoch 19
Loss = 6.2621e-01, PNorm = 35.7032, GNorm = 1.3194, lr_0 = 4.6221e-04
Loss = 5.7806e-01, PNorm = 35.7076, GNorm = 1.7369, lr_0 = 4.3387e-04
Loss = 5.7433e-01, PNorm = 35.7105, GNorm = 1.8159, lr_0 = 4.0728e-04
Validation rmse = 0.515703
Epoch 20
Loss = 5.5378e-01, PNorm = 35.7126, GNorm = 0.6427, lr_0 = 3.7751e-04
Loss = 6.3005e-01, PNorm = 35.7152, GNorm = 0.7985, lr_0 = 3.5436e-04
Validation rmse = 0.516953
Epoch 21
Loss = 4.6243e-01, PNorm = 35.7191, GNorm = 0.5429, lr_0 = 3.2846e-04
Loss = 4.8947e-01, PNorm = 35.7218, GNorm = 0.6320, lr_0 = 3.0833e-04
Loss = 5.8019e-01, PNorm = 35.7244, GNorm = 1.1695, lr_0 = 2.8943e-04
Validation rmse = 0.516262
Epoch 22
Loss = 5.2926e-01, PNorm = 35.7282, GNorm = 0.7099, lr_0 = 2.6827e-04
Loss = 6.0320e-01, PNorm = 35.7313, GNorm = 1.0914, lr_0 = 2.5183e-04
Loss = 5.1309e-01, PNorm = 35.7332, GNorm = 0.8545, lr_0 = 2.3639e-04
Loss = 7.3727e-01, PNorm = 35.7336, GNorm = 1.8260, lr_0 = 2.3342e-04
Validation rmse = 0.515791
Epoch 23
Loss = 5.5886e-01, PNorm = 35.7349, GNorm = 1.2766, lr_0 = 2.1911e-04
Loss = 5.6099e-01, PNorm = 35.7364, GNorm = 0.8937, lr_0 = 2.0568e-04
Validation rmse = 0.516043
Epoch 24
Loss = 5.6899e-01, PNorm = 35.7380, GNorm = 0.5467, lr_0 = 1.9064e-04
Loss = 5.3974e-01, PNorm = 35.7394, GNorm = 0.7761, lr_0 = 1.7896e-04
Loss = 4.9639e-01, PNorm = 35.7408, GNorm = 1.1635, lr_0 = 1.6799e-04
Validation rmse = 0.517046
Epoch 25
Loss = 4.8960e-01, PNorm = 35.7425, GNorm = 1.5361, lr_0 = 1.5571e-04
Loss = 5.5984e-01, PNorm = 35.7436, GNorm = 1.0373, lr_0 = 1.4616e-04
Loss = 5.7360e-01, PNorm = 35.7444, GNorm = 4.1299, lr_0 = 1.3720e-04
Validation rmse = 0.518108
Epoch 26
Loss = 5.6331e-01, PNorm = 35.7450, GNorm = 1.4703, lr_0 = 1.2879e-04
Loss = 5.3206e-01, PNorm = 35.7459, GNorm = 1.1990, lr_0 = 1.2090e-04
Validation rmse = 0.516391
Epoch 27
Loss = 5.4467e-01, PNorm = 35.7470, GNorm = 0.6688, lr_0 = 1.1206e-04
Loss = 5.0779e-01, PNorm = 35.7477, GNorm = 1.3426, lr_0 = 1.0519e-04
Loss = 5.6397e-01, PNorm = 35.7482, GNorm = 0.5723, lr_0 = 1.0000e-04
Validation rmse = 0.516139
Epoch 28
Loss = 5.8657e-01, PNorm = 35.7489, GNorm = 1.0502, lr_0 = 1.0000e-04
Loss = 4.9088e-01, PNorm = 35.7497, GNorm = 0.8425, lr_0 = 1.0000e-04
Validation rmse = 0.516688
Epoch 29
Loss = 5.7163e-01, PNorm = 35.7507, GNorm = 1.4614, lr_0 = 1.0000e-04
Loss = 5.6484e-01, PNorm = 35.7514, GNorm = 0.8667, lr_0 = 1.0000e-04
Loss = 4.9956e-01, PNorm = 35.7522, GNorm = 1.4137, lr_0 = 1.0000e-04
Validation rmse = 0.516776
Model 0 best validation rmse = 0.515703 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.601372
Ensemble test rmse = 0.601372
2-fold cross validation
	Seed 0 ==> test rmse = 0.532458
	Seed 1 ==> test rmse = 0.601372
Overall test rmse = 0.566915 +/- 0.034457
Elapsed time = 0:05:54
